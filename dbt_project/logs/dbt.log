[0m18:55:12.900526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163E8B60340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EA983BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EA983E20>]}


============================== 18:55:12.903515 | 46efcf3c-920a-473d-abb4-6fd3db4892c8 ==============================
[0m18:55:12.903515 [info ] [MainThread]: Running with dbt=1.9.5
[0m18:55:12.905510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init .', 'send_anonymous_usage_stats': 'True'}
[0m18:55:12.922452 [info ] [MainThread]: Setting up your profile.
[0m18:55:56.449750 [info ] [MainThread]: Profile my_dbt_project written to C:\Users\khale\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m18:55:56.451743 [debug] [MainThread]: Command `dbt init` succeeded at 18:55:56.451743 after 43.64 seconds
[0m18:55:56.451743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163E8B60340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EA9C1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EA983DC0>]}
[0m18:55:56.452740 [debug] [MainThread]: Flushing usage events
[0m18:55:57.102129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:27.507198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1F630340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A20483BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A20483E20>]}


============================== 18:57:27.510187 | cff42ec8-f761-4960-9e44-b928a0c5deac ==============================
[0m18:57:27.510187 [info ] [MainThread]: Running with dbt=1.9.5
[0m18:57:27.511183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:27.527130 [info ] [MainThread]: dbt version: 1.9.5
[0m18:57:27.528126 [info ] [MainThread]: python version: 3.10.0
[0m18:57:27.529125 [info ] [MainThread]: python path: C:\Users\khale\my_dbt_project\venv\Scripts\python.exe
[0m18:57:27.529125 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m18:57:27.585934 [info ] [MainThread]: Using profiles dir at C:\Users\khale\.dbt
[0m18:57:27.586931 [info ] [MainThread]: Using profiles.yml file at C:\Users\khale\.dbt\profiles.yml
[0m18:57:27.587932 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khale\my_dbt_project\my_dbt_project\dbt_project.yml
[0m18:57:27.588923 [info ] [MainThread]: adapter type: postgres
[0m18:57:27.588923 [info ] [MainThread]: adapter version: 1.9.0
[0m18:57:27.674828 [info ] [MainThread]: Configuration:
[0m18:57:27.675824 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:57:27.676837 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:57:27.676837 [info ] [MainThread]: Required dependencies:
[0m18:57:27.677820 [debug] [MainThread]: Executing "git --help"
[0m18:57:27.711704 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:57:27.712701 [debug] [MainThread]: STDERR: "b''"
[0m18:57:27.712701 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:57:27.713699 [info ] [MainThread]: Connection:
[0m18:57:27.713699 [info ] [MainThread]:   host: localhost
[0m18:57:27.713699 [info ] [MainThread]:   port: 5432
[0m18:57:27.714696 [info ] [MainThread]:   user: postgres
[0m18:57:27.714696 [info ] [MainThread]:   database: dbt_project_db
[0m18:57:27.715692 [info ] [MainThread]:   schema: public
[0m18:57:27.715692 [info ] [MainThread]:   connect_timeout: 10
[0m18:57:27.715692 [info ] [MainThread]:   role: None
[0m18:57:27.716688 [info ] [MainThread]:   search_path: None
[0m18:57:27.716688 [info ] [MainThread]:   keepalives_idle: 0
[0m18:57:27.716688 [info ] [MainThread]:   sslmode: None
[0m18:57:27.717685 [info ] [MainThread]:   sslcert: None
[0m18:57:27.717685 [info ] [MainThread]:   sslkey: None
[0m18:57:27.717685 [info ] [MainThread]:   sslrootcert: None
[0m18:57:27.718682 [info ] [MainThread]:   application_name: dbt
[0m18:57:27.718682 [info ] [MainThread]:   retries: 1
[0m18:57:27.719678 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:57:27.934227 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:57:27.997453 [debug] [MainThread]: Using postgres connection "debug"
[0m18:57:27.997453 [debug] [MainThread]: On debug: select 1 as id
[0m18:57:27.997453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:28.030343 [debug] [MainThread]: SQL status: SELECT 1 in 0.033 seconds
[0m18:57:28.031340 [debug] [MainThread]: On debug: Close
[0m18:57:28.031340 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:57:28.032337 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:57:28.033333 [debug] [MainThread]: Command `dbt debug` succeeded at 18:57:28.033333 after 0.59 seconds
[0m18:57:28.033333 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:57:28.034329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1F630340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1D54A1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A20618F70>]}
[0m18:57:28.034329 [debug] [MainThread]: Flushing usage events
[0m18:57:28.668202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:20:53.867191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A8310370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A9163B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A9163E50>]}


============================== 21:20:53.870181 | 10193204-7edd-4af3-b223-f903da441b71 ==============================
[0m21:20:53.870181 [info ] [MainThread]: Running with dbt=1.9.5
[0m21:20:53.871178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:53.892108 [info ] [MainThread]: dbt version: 1.9.5
[0m21:20:53.892108 [info ] [MainThread]: python version: 3.10.0
[0m21:20:53.893105 [info ] [MainThread]: python path: C:\Users\khale\my_dbt_project\venv\Scripts\python.exe
[0m21:20:53.893105 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m21:20:53.950966 [info ] [MainThread]: Using profiles dir at C:\Users\khale\.dbt
[0m21:20:53.951962 [info ] [MainThread]: Using profiles.yml file at C:\Users\khale\.dbt\profiles.yml
[0m21:20:53.951962 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khale\my_dbt_project\my_dbt_project\dbt_project.yml
[0m21:20:53.953956 [info ] [MainThread]: adapter type: postgres
[0m21:20:53.953956 [info ] [MainThread]: adapter version: 1.9.0
[0m21:20:54.040668 [info ] [MainThread]: Configuration:
[0m21:20:54.040668 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:20:54.041663 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:20:54.041663 [info ] [MainThread]: Required dependencies:
[0m21:20:54.042660 [debug] [MainThread]: Executing "git --help"
[0m21:20:54.075653 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:20:54.075653 [debug] [MainThread]: STDERR: "b''"
[0m21:20:54.075653 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:20:54.075653 [info ] [MainThread]: Connection:
[0m21:20:54.078942 [info ] [MainThread]:   host: localhost
[0m21:20:54.078942 [info ] [MainThread]:   port: 5432
[0m21:20:54.079938 [info ] [MainThread]:   user: postgres
[0m21:20:54.079938 [info ] [MainThread]:   database: dbt_project_db
[0m21:20:54.080934 [info ] [MainThread]:   schema: dwh
[0m21:20:54.080934 [info ] [MainThread]:   connect_timeout: 10
[0m21:20:54.080934 [info ] [MainThread]:   role: None
[0m21:20:54.081931 [info ] [MainThread]:   search_path: None
[0m21:20:54.081931 [info ] [MainThread]:   keepalives_idle: 0
[0m21:20:54.082928 [info ] [MainThread]:   sslmode: None
[0m21:20:54.083545 [info ] [MainThread]:   sslcert: None
[0m21:20:54.083545 [info ] [MainThread]:   sslkey: None
[0m21:20:54.083545 [info ] [MainThread]:   sslrootcert: None
[0m21:20:54.083545 [info ] [MainThread]:   application_name: dbt
[0m21:20:54.083545 [info ] [MainThread]:   retries: 1
[0m21:20:54.083545 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:20:54.292396 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:20:54.359300 [debug] [MainThread]: Using postgres connection "debug"
[0m21:20:54.359300 [debug] [MainThread]: On debug: select 1 as id
[0m21:20:54.359300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:54.393607 [debug] [MainThread]: SQL status: SELECT 1 in 0.033 seconds
[0m21:20:54.394603 [debug] [MainThread]: On debug: Close
[0m21:20:54.395600 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:20:54.395600 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:20:54.396599 [debug] [MainThread]: Command `dbt debug` succeeded at 21:20:54.396599 after 0.60 seconds
[0m21:20:54.397595 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:20:54.397595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A8310370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A8AC9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A92F66E0>]}
[0m21:20:54.398592 [debug] [MainThread]: Flushing usage events
[0m21:20:54.947529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:57.973764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025324154310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025325F83BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025325F83F70>]}


============================== 18:38:57.978780 | ce3658e7-7e80-4dc4-905e-6a5a2b41e345 ==============================
[0m18:38:57.978780 [info ] [MainThread]: Running with dbt=1.9.5
[0m18:38:57.979894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_property_type', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:58.196364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce3658e7-7e80-4dc4-905e-6a5a2b41e345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253260A4B20>]}
[0m18:38:58.243329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce3658e7-7e80-4dc4-905e-6a5a2b41e345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253258EEC50>]}
[0m18:38:58.243329 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:38:58.593566 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m18:38:58.595566 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:38:58.595566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce3658e7-7e80-4dc4-905e-6a5a2b41e345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025325F83D90>]}
[0m18:39:00.240089 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m18:39:00.241330 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m18:39:00.332837 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.dim_property_type' (models\marts\dim_property_type.sql) depends on a source named 'data_source.sales' which was not found
[0m18:39:00.334757 [debug] [MainThread]: Command `dbt run` failed at 18:39:00.333837 after 2.43 seconds
[0m18:39:00.334757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025324154310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253265D01F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253265A6440>]}
[0m18:39:00.334757 [debug] [MainThread]: Flushing usage events
[0m18:39:00.930161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:31.283529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369F4B03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A13109A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A13105B0>]}


============================== 18:48:31.287617 | dfea7172-0a38-414a-b550-5987e1240884 ==============================
[0m18:48:31.287617 [info ] [MainThread]: Running with dbt=1.9.5
[0m18:48:31.288609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_property_type', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:48:31.440626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A1404EB0>]}
[0m18:48:31.485625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369F552920>]}
[0m18:48:31.486602 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:31.700003 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m18:48:31.700003 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:48:31.700003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A149E9E0>]}
[0m18:48:32.616263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:48:32.641940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A1A99F60>]}
[0m18:48:32.707030 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m18:48:32.724019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m18:48:32.773957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A2B4D330>]}
[0m18:48:32.773957 [info ] [MainThread]: Found 1 model, 2 sources, 433 macros
[0m18:48:32.773957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A2B4D390>]}
[0m18:48:32.773957 [info ] [MainThread]: 
[0m18:48:32.773957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:32.773957 [info ] [MainThread]: 
[0m18:48:32.773957 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:32.773957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m18:48:35.004496 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m18:48:35.004496 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m18:48:35.004496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:35.160616 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.153 seconds
[0m18:48:35.161680 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m18:48:35.163589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m18:48:35.168679 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m18:48:35.168679 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m18:48:35.168679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:35.203029 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:48:35.203029 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m18:48:35.204106 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m18:48:35.215738 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m18:48:35.216826 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m18:48:35.217740 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m18:48:35.221738 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:35.221738 [debug] [MainThread]: On master: BEGIN
[0m18:48:35.221738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:35.257114 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m18:48:35.257114 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:35.257114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:35.272681 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m18:48:35.273704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A2B4CEE0>]}
[0m18:48:35.273704 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:35.274695 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:35.274695 [debug] [MainThread]: On master: BEGIN
[0m18:48:35.275700 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:48:35.275700 [debug] [MainThread]: On master: COMMIT
[0m18:48:35.276765 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:35.276765 [debug] [MainThread]: On master: COMMIT
[0m18:48:35.276765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:35.277774 [debug] [MainThread]: On master: Close
[0m18:48:35.303976 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m18:48:35.304975 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_property_type .............................. [RUN]
[0m18:48:35.305975 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_property_type'
[0m18:48:35.305975 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m18:48:35.311284 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m18:48:35.311284 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m18:48:35.347489 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m18:48:35.347489 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:48:35.347489 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m18:48:35.347489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:48:35.389353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:48:35.389353 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:48:35.390451 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  create view "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    property_type_id,
    property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
[0m18:48:35.412983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m18:48:35.418976 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:48:35.418976 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m18:48:35.420667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:35.432686 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m18:48:35.433687 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:48:35.433687 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m18:48:35.435673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:35.440672 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m18:48:35.444676 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:48:35.444676 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop view if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m18:48:35.446408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:35.448413 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m18:48:35.451419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7172-0a38-414a-b550-5987e1240884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369D7E7460>]}
[0m18:48:35.452416 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dwh.dim_property_type ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m18:48:35.453414 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m18:48:35.454415 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:35.455415 [debug] [MainThread]: On master: BEGIN
[0m18:48:35.455415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:35.494157 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m18:48:35.495155 [debug] [MainThread]: On master: COMMIT
[0m18:48:35.495155 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:35.496153 [debug] [MainThread]: On master: COMMIT
[0m18:48:35.496564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:35.496564 [debug] [MainThread]: On master: Close
[0m18:48:35.496564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:35.497570 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m18:48:35.497570 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m18:48:35.497570 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_property_type' was properly closed.
[0m18:48:35.498570 [info ] [MainThread]: 
[0m18:48:35.498570 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m18:48:35.499571 [debug] [MainThread]: Command end result
[0m18:48:35.518585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m18:48:35.520569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m18:48:35.527570 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m18:48:35.527570 [info ] [MainThread]: 
[0m18:48:35.528669 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:35.529570 [info ] [MainThread]: 
[0m18:48:35.529570 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:48:35.530874 [debug] [MainThread]: Command `dbt run` succeeded at 18:48:35.530874 after 4.31 seconds
[0m18:48:35.530874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369F4B03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369F5319C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369EC350F0>]}
[0m18:48:35.530874 [debug] [MainThread]: Flushing usage events
[0m18:48:36.236240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:26.152267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1F8D4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21730910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21730550>]}


============================== 18:58:26.152267 | 2e3cc5bb-e16b-45a2-aa75-82872391e970 ==============================
[0m18:58:26.152267 [info ] [MainThread]: Running with dbt=1.9.5
[0m18:58:26.152267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:58:26.319067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21891540>]}
[0m18:58:26.364776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1F970970>]}
[0m18:58:26.365777 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:58:26.581363 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m18:58:26.735405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:58:26.735405 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_sale_category.sql
[0m18:58:26.736406 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_property_type.sql
[0m18:58:26.932575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:58:26.944674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21E75AE0>]}
[0m18:58:27.010577 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m18:58:27.013579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m18:58:27.038073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21E76BF0>]}
[0m18:58:27.039072 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m18:58:27.040072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21E76E30>]}
[0m18:58:27.041180 [info ] [MainThread]: 
[0m18:58:27.042073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:27.042073 [info ] [MainThread]: 
[0m18:58:27.043074 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:27.047075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m18:58:27.159998 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m18:58:27.159998 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:27.159998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:27.322294 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.156 seconds
[0m18:58:27.323380 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m18:58:27.324295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m18:58:27.330405 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m18:58:27.330405 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m18:58:27.331296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:27.352040 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:58:27.352040 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m18:58:27.352040 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m18:58:27.367748 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m18:58:27.367748 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m18:58:27.367748 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m18:58:27.367748 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.367748 [debug] [MainThread]: On master: BEGIN
[0m18:58:27.367748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:27.412025 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m18:58:27.412025 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.412025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:27.419986 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m18:58:27.421087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1F4A5240>]}
[0m18:58:27.422072 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:27.422072 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.423066 [debug] [MainThread]: On master: BEGIN
[0m18:58:27.423066 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:58:27.423066 [debug] [MainThread]: On master: COMMIT
[0m18:58:27.424066 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.424066 [debug] [MainThread]: On master: COMMIT
[0m18:58:27.424066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:27.425030 [debug] [MainThread]: On master: Close
[0m18:58:27.426069 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m18:58:27.426069 [info ] [Thread-1 (]: 1 of 2 START sql table model dwh.dim_property_type ............................. [RUN]
[0m18:58:27.426069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_property_type'
[0m18:58:27.426069 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m18:58:27.426069 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m18:58:27.426069 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m18:58:27.462404 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m18:58:27.462404 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:58:27.462404 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m18:58:27.462404 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:27.509305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m18:58:27.509305 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:58:27.510396 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m18:58:27.520302 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.010 seconds
[0m18:58:27.528411 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:58:27.529386 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m18:58:27.529386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:58:27.532409 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:58:27.533406 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m18:58:27.534304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:58:27.546382 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m18:58:27.547412 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:58:27.547412 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m18:58:27.550311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:58:27.555388 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m18:58:27.558412 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m18:58:27.558412 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop view if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m18:58:27.567302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m18:58:27.569410 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m18:58:27.572302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1DC073D0>]}
[0m18:58:27.573306 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.14s]
[0m18:58:27.573306 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m18:58:27.574303 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m18:58:27.574303 [info ] [Thread-1 (]: 2 of 2 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m18:58:27.575306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m18:58:27.575306 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m18:58:27.578385 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m18:58:27.579392 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m18:58:27.582333 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m18:58:27.584314 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m18:58:27.584314 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m18:58:27.584314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:27.709801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m18:58:27.709801 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m18:58:27.709801 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m18:58:27.725424 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m18:58:27.725424 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m18:58:27.725424 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m18:58:27.725424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:58:27.725424 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m18:58:27.725424 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m18:58:27.725424 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m18:58:27.725424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:58:27.743210 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m18:58:27.745237 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m18:58:27.745237 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m18:58:27.746127 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:58:27.747215 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m18:58:27.747215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3cc5bb-e16b-45a2-aa75-82872391e970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21892170>]}
[0m18:58:27.748216 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.17s]
[0m18:58:27.749128 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m18:58:27.750128 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.751128 [debug] [MainThread]: On master: BEGIN
[0m18:58:27.751128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:27.790081 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m18:58:27.791169 [debug] [MainThread]: On master: COMMIT
[0m18:58:27.791169 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.791169 [debug] [MainThread]: On master: COMMIT
[0m18:58:27.792111 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:27.792111 [debug] [MainThread]: On master: Close
[0m18:58:27.793081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:27.793081 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m18:58:27.793081 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m18:58:27.793081 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sale_category' was properly closed.
[0m18:58:27.794084 [info ] [MainThread]: 
[0m18:58:27.795085 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m18:58:27.796083 [debug] [MainThread]: Command end result
[0m18:58:27.816083 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m18:58:27.818083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m18:58:27.824086 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m18:58:27.824086 [info ] [MainThread]: 
[0m18:58:27.825081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:27.826080 [info ] [MainThread]: 
[0m18:58:27.826080 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:58:27.828081 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:27.828081 after 1.74 seconds
[0m18:58:27.828081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1F8D4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1F9662F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C21C63CA0>]}
[0m18:58:27.829080 [debug] [MainThread]: Flushing usage events
[0m18:58:28.546962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:44.597500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184291542B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842AF7BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842AF7BEB0>]}


============================== 19:07:44.601497 | e23abb3e-1837-4df3-a95c-5cb5738ff818 ==============================
[0m19:07:44.601497 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:07:44.603497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:07:44.775007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B09F160>]}
[0m19:07:44.836238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B09F8E0>]}
[0m19:07:44.838155 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:07:45.055908 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:07:45.210396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:07:45.210396 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_sales_location.sql
[0m19:07:45.417937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:07:45.429928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B705D50>]}
[0m19:07:45.492422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:07:45.492422 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:07:45.523782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B706260>]}
[0m19:07:45.524783 [info ] [MainThread]: Found 3 models, 2 sources, 433 macros
[0m19:07:45.525796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B706290>]}
[0m19:07:45.526796 [info ] [MainThread]: 
[0m19:07:45.527782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:45.527782 [info ] [MainThread]: 
[0m19:07:45.528781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:07:45.532782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:07:45.646286 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:07:45.646286 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:07:45.646286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:45.700165 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.045 seconds
[0m19:07:45.701188 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:07:45.703165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:07:45.709164 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:07:45.709164 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:07:45.710164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:45.747054 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m19:07:45.748135 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:07:45.748135 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:07:45.754087 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m19:07:45.755053 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:07:45.756512 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:07:45.762522 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:45.763522 [debug] [MainThread]: On master: BEGIN
[0m19:07:45.763522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:45.798911 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m19:07:45.798911 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:45.799990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:07:45.807952 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:07:45.808915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018428D25A20>]}
[0m19:07:45.809997 [debug] [MainThread]: On master: ROLLBACK
[0m19:07:45.811003 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:45.811003 [debug] [MainThread]: On master: BEGIN
[0m19:07:45.811999 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:07:45.811999 [debug] [MainThread]: On master: COMMIT
[0m19:07:45.811999 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:45.813023 [debug] [MainThread]: On master: COMMIT
[0m19:07:45.813023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:45.813023 [debug] [MainThread]: On master: Close
[0m19:07:45.817913 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:07:45.818932 [info ] [Thread-1 (]: 1 of 3 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:07:45.819911 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_property_type'
[0m19:07:45.819911 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:07:45.827912 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:07:45.829915 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:07:45.862913 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:07:45.864917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:07:45.864917 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:07:45.864917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:07:45.901949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m19:07:45.901949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:07:45.901949 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:07:45.908912 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.006 seconds
[0m19:07:45.916955 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:07:45.916955 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:07:45.918006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:45.921042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:07:45.921042 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:07:45.922001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:45.935004 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:07:45.935004 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:07:45.935990 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:07:45.937699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:07:45.942793 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:07:45.945780 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:07:45.946813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:07:45.949780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:07:45.952809 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:07:45.954704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B09F580>]}
[0m19:07:45.955708 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.13s]
[0m19:07:45.956715 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:07:45.956715 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:07:45.956715 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:07:45.957704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:07:45.958704 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:07:45.960792 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:07:45.961823 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:07:45.965708 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:07:45.966764 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:07:45.967705 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:07:45.968704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:46.006804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:07:46.006804 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:07:46.007812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:07:46.015726 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m19:07:46.018942 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:07:46.018942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:07:46.018942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:46.018942 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:07:46.018942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:07:46.018942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:46.026026 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:07:46.026026 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:07:46.027017 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:07:46.028941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:07:46.031954 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:07:46.031954 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:07:46.032974 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:07:46.035022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:07:46.036941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:07:46.036941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B52A8C0>]}
[0m19:07:46.038025 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.08s]
[0m19:07:46.038944 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:07:46.038944 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:07:46.040029 [info ] [Thread-1 (]: 3 of 3 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:07:46.040941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:07:46.040941 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:07:46.043940 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:07:46.045958 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:07:46.048955 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:07:46.050970 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:07:46.050970 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:07:46.051941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:46.086619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m19:07:46.086619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:07:46.087611 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:07:46.093602 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m19:07:46.097609 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:07:46.098609 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:07:46.098609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:46.100600 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:07:46.100600 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:07:46.101597 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:07:46.102595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:07:46.104615 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:07:46.105706 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:07:46.105706 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:07:46.106679 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:07:46.107596 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:07:46.108634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23abb3e-1837-4df3-a95c-5cb5738ff818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B07ED10>]}
[0m19:07:46.109603 [info ] [Thread-1 (]: 3 of 3 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.07s]
[0m19:07:46.110597 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:07:46.112595 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:46.112595 [debug] [MainThread]: On master: BEGIN
[0m19:07:46.112595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:07:46.178667 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m19:07:46.179632 [debug] [MainThread]: On master: COMMIT
[0m19:07:46.179632 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:46.179632 [debug] [MainThread]: On master: COMMIT
[0m19:07:46.180676 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:46.180676 [debug] [MainThread]: On master: Close
[0m19:07:46.181596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:46.181596 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:07:46.181596 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:07:46.181596 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sales_location' was properly closed.
[0m19:07:46.182595 [info ] [MainThread]: 
[0m19:07:46.182595 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m19:07:46.184677 [debug] [MainThread]: Command end result
[0m19:07:46.203676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:07:46.206599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:07:46.212824 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:07:46.212824 [info ] [MainThread]: 
[0m19:07:46.212824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:46.212824 [info ] [MainThread]: 
[0m19:07:46.212824 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:07:46.212824 [debug] [MainThread]: Command `dbt run` succeeded at 19:07:46.212824 after 1.69 seconds
[0m19:07:46.212824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184291542B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842A1E98A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001842B6D41C0>]}
[0m19:07:46.212824 [debug] [MainThread]: Flushing usage events
[0m19:07:46.839824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:45.235509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF17242E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF35808B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF3580580>]}


============================== 19:33:45.239508 | a8d82c7e-20e6-41a8-b717-5bae6dbba21f ==============================
[0m19:33:45.239508 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:33:45.241508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:33:45.398339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF3672320>]}
[0m19:33:45.453489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF377C550>]}
[0m19:33:45.455445 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:33:45.674666 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:33:45.837575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:33:45.838575 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_date.sql
[0m19:33:45.838575 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_time.sql
[0m19:33:46.076076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:33:46.090089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF3CE2710>]}
[0m19:33:46.150988 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:33:46.150988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:33:46.183237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF3C6F250>]}
[0m19:33:46.183237 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m19:33:46.183237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF3C6F5E0>]}
[0m19:33:46.183237 [info ] [MainThread]: 
[0m19:33:46.183237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:46.183237 [info ] [MainThread]: 
[0m19:33:46.198134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:33:46.203616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:33:46.336712 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:33:46.337683 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:33:46.337683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:46.380600 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m19:33:46.382598 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:33:46.384599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:33:46.390930 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:33:46.390930 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:33:46.390930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:46.539754 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m19:33:46.539754 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:33:46.540719 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:33:46.549250 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m19:33:46.551252 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:33:46.552313 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:33:46.558254 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:46.558254 [debug] [MainThread]: On master: BEGIN
[0m19:33:46.558254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:46.582055 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m19:33:46.582055 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:46.582055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:33:46.603492 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m19:33:46.603492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF37B1420>]}
[0m19:33:46.603492 [debug] [MainThread]: On master: ROLLBACK
[0m19:33:46.603492 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:46.603492 [debug] [MainThread]: On master: BEGIN
[0m19:33:46.603492 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:33:46.603492 [debug] [MainThread]: On master: COMMIT
[0m19:33:46.603492 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:46.603492 [debug] [MainThread]: On master: COMMIT
[0m19:33:46.603492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:33:46.603492 [debug] [MainThread]: On master: Close
[0m19:33:46.616542 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m19:33:46.616542 [info ] [Thread-1 (]: 1 of 5 START sql table model dwh.dim_date ...................................... [RUN]
[0m19:33:46.616542 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m19:33:46.616542 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m19:33:46.616542 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m19:33:46.616542 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m19:33:46.653667 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m19:33:46.653667 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:33:46.653667 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m19:33:46.653667 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:33:46.704041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m19:33:46.704643 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:33:46.705216 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-012-01',  
        date '2030-12-31', 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m19:33:46.708762 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type date: "2016-012-01"
LINE 16:         date '2016-012-01',  
                      ^

[0m19:33:46.709287 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: ROLLBACK
[0m19:33:46.709870 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m19:33:46.817996 [debug] [Thread-1 (]: Database Error in model dim_date (models\marts\dim_date.sql)
  invalid input syntax for type date: "2016-012-01"
  LINE 16:         date '2016-012-01',  
                        ^
  compiled code at target\run\my_dbt_project\models\marts\dim_date.sql
[0m19:33:46.819996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF36735B0>]}
[0m19:33:46.820996 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dwh.dim_date ............................. [[31mERROR[0m in 0.20s]
[0m19:33:46.821996 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m19:33:46.821996 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:33:46.822998 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models\marts\dim_date.sql)
  invalid input syntax for type date: "2016-012-01"
  LINE 16:         date '2016-012-01',  
                        ^
  compiled code at target\run\my_dbt_project\models\marts\dim_date.sql.
[0m19:33:46.822998 [info ] [Thread-1 (]: 2 of 5 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:33:46.823998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m19:33:46.823998 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:33:46.827996 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:33:46.829997 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:33:46.837998 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:33:46.838999 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:33:46.840002 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:33:46.840002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:46.877997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:33:46.878997 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:33:46.878997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:33:46.886997 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.007 seconds
[0m19:33:46.895996 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:33:46.896997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:33:46.897997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:33:46.901996 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:33:46.902996 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:33:46.903996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:33:46.918997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:33:46.919997 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:33:46.919997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:33:46.921998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:33:46.927997 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:33:46.931998 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:33:46.931998 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:33:46.934997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:33:46.937998 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:33:46.938996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF12EAE60>]}
[0m19:33:46.938996 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.11s]
[0m19:33:46.939996 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:33:46.940997 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:33:46.940997 [info ] [Thread-1 (]: 3 of 5 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:33:46.941998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:33:46.941998 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:33:46.944997 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:33:46.946998 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:33:46.950996 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:33:46.951996 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:33:46.952997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:33:46.953996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:46.985928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:33:46.985928 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:33:46.985928 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:33:46.998272 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m19:33:46.999428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:33:46.999428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:33:46.999428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:33:46.999428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:33:46.999428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:33:46.999428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:33:46.999428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:33:46.999428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:33:46.999428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:33:46.999428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:33:46.999428 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:33:46.999428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:33:47.014969 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:33:47.018071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:33:47.019072 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:33:47.020061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF12EAE60>]}
[0m19:33:47.020969 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.08s]
[0m19:33:47.020969 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:33:47.021968 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:33:47.021968 [info ] [Thread-1 (]: 4 of 5 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:33:47.023048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:33:47.023048 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:33:47.026058 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:33:47.027063 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:33:47.030062 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:33:47.032123 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:33:47.032123 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:33:47.033127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:47.066524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:33:47.066524 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:33:47.066524 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:33:47.066524 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m19:33:47.066524 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:33:47.066524 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m19:33:47.066524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:33:47.083776 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:33:47.084750 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:33:47.084750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:33:47.087759 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:33:47.087759 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:33:47.087759 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:33:47.089745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:33:47.091745 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:33:47.092752 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:33:47.092752 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:33:47.095766 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:33:47.096752 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:33:47.097669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CEFA573A0>]}
[0m19:33:47.098671 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.07s]
[0m19:33:47.099667 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:33:47.099667 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m19:33:47.100667 [info ] [Thread-1 (]: 5 of 5 START sql table model dwh.dim_time ...................................... [RUN]
[0m19:33:47.100667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_time)
[0m19:33:47.101747 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m19:33:47.103751 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m19:33:47.104754 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m19:33:47.108751 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m19:33:47.109666 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:33:47.109666 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m19:33:47.110703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:47.247499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.137 seconds
[0m19:33:47.248505 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:33:47.248505 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

with time_series as (
    select generate_series(
        time '00:00',
        time '23:59',
        interval '1 minute'
    )::time as full_time
)

select 
    row_number() over () as time_id,
    extract(hour from full_time)::int as hour,
    extract(minute from full_time)::int as minute
from time_series
order by full_time
  );
  
[0m19:33:47.251505 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function generate_series(time without time zone, time without time zone, interval) does not exist
LINE 15:     select generate_series(
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:33:47.251505 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: ROLLBACK
[0m19:33:47.252504 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m19:33:47.254504 [debug] [Thread-1 (]: Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 15:     select generate_series(
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql
[0m19:33:47.254504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d82c7e-20e6-41a8-b717-5bae6dbba21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF12EAE60>]}
[0m19:33:47.255504 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dwh.dim_time ............................. [[31mERROR[0m in 0.15s]
[0m19:33:47.256505 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m19:33:47.256505 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_time' to be skipped because of status 'error'.  Reason: Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 15:     select generate_series(
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql.
[0m19:33:47.257593 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:47.258551 [debug] [MainThread]: On master: BEGIN
[0m19:33:47.258551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:47.295966 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m19:33:47.295966 [debug] [MainThread]: On master: COMMIT
[0m19:33:47.295966 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:47.297056 [debug] [MainThread]: On master: COMMIT
[0m19:33:47.297056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:33:47.297056 [debug] [MainThread]: On master: Close
[0m19:33:47.297965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:47.297965 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:33:47.298963 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:33:47.298963 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m19:33:47.298963 [info ] [MainThread]: 
[0m19:33:47.299963 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m19:33:47.301964 [debug] [MainThread]: Command end result
[0m19:33:47.319380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:33:47.322416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:33:47.328310 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:33:47.328310 [info ] [MainThread]: 
[0m19:33:47.329173 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:33:47.329173 [info ] [MainThread]: 
[0m19:33:47.330191 [error] [MainThread]:   Database Error in model dim_date (models\marts\dim_date.sql)
  invalid input syntax for type date: "2016-012-01"
  LINE 16:         date '2016-012-01',  
                        ^
  compiled code at target\run\my_dbt_project\models\marts\dim_date.sql
[0m19:33:47.331188 [info ] [MainThread]: 
[0m19:33:47.331188 [error] [MainThread]:   Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 15:     select generate_series(
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql
[0m19:33:47.332179 [info ] [MainThread]: 
[0m19:33:47.333182 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m19:33:47.334180 [debug] [MainThread]: Command `dbt run` failed at 19:33:47.334180 after 2.18 seconds
[0m19:33:47.334180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF17242E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF27BA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CF51D9DE0>]}
[0m19:33:47.335179 [debug] [MainThread]: Flushing usage events
[0m19:33:48.165120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:33.783719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BC1103A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BDF70940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BDF705B0>]}


============================== 19:36:33.787722 | 791c5d9b-335e-4db5-9bf3-dd668fbe5b5b ==============================
[0m19:36:33.787722 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:36:33.788723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:33.940874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE05FEE0>]}
[0m19:36:33.986874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE0D7430>]}
[0m19:36:33.988873 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:36:34.204924 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:36:34.359824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:34.359824 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_date.sql
[0m19:36:34.557115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:36:34.569650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE6AA800>]}
[0m19:36:34.638852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:36:34.643436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:36:34.657849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE6694E0>]}
[0m19:36:34.657849 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m19:36:34.657849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE66A950>]}
[0m19:36:34.657849 [info ] [MainThread]: 
[0m19:36:34.657849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:34.673552 [info ] [MainThread]: 
[0m19:36:34.674556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:34.680551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:36:34.792073 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:36:34.792073 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:36:34.792073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:34.847649 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m19:36:34.848768 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:36:34.850647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:36:34.855744 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:36:34.856744 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:36:34.856744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:34.879795 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m19:36:34.879795 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:36:34.879795 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:36:34.895428 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:36:34.895428 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:36:34.895428 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:36:34.895428 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:34.895428 [debug] [MainThread]: On master: BEGIN
[0m19:36:34.895428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:34.926691 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m19:36:34.926691 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:34.926691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:34.948464 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m19:36:34.950443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE49A7D0>]}
[0m19:36:34.950443 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:34.951447 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:34.951447 [debug] [MainThread]: On master: BEGIN
[0m19:36:34.952453 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:36:34.952453 [debug] [MainThread]: On master: COMMIT
[0m19:36:34.953450 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:34.953450 [debug] [MainThread]: On master: COMMIT
[0m19:36:34.954443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:36:34.954443 [debug] [MainThread]: On master: Close
[0m19:36:34.958449 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m19:36:34.959449 [info ] [Thread-1 (]: 1 of 5 START sql table model dwh.dim_date ...................................... [RUN]
[0m19:36:34.959449 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m19:36:34.960449 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m19:36:34.966480 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m19:36:34.967476 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m19:36:35.000785 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m19:36:35.001784 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:36:35.002785 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m19:36:35.002785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:35.036863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m19:36:35.036863 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:36:35.037885 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        date '2030-12-31', 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m19:36:35.059329 [debug] [Thread-1 (]: SQL status: SELECT 5144 in 0.021 seconds
[0m19:36:35.066324 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:36:35.067332 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:36:35.068313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:36:35.076522 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:36:35.076522 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:36:35.076522 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:36:35.076522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:36:35.076522 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m19:36:35.092392 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:36:35.092392 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m19:36:35.093478 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:36:35.095488 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m19:36:35.098393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BD8E8BB0>]}
[0m19:36:35.098393 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dwh.dim_date ................................. [[32mSELECT 5144[0m in 0.14s]
[0m19:36:35.099411 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m19:36:35.100394 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:36:35.100394 [info ] [Thread-1 (]: 2 of 5 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:36:35.101400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m19:36:35.101400 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:36:35.104510 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:36:35.105500 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:36:35.108395 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:36:35.110404 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:36:35.111403 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:36:35.111403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:35.149911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:36:35.151015 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:36:35.151015 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:36:35.157144 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.005 seconds
[0m19:36:35.161141 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:36:35.162138 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:36:35.163199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:36:35.165138 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:36:35.166141 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:36:35.166141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:35.169225 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:36:35.169225 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:36:35.170219 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:36:35.172138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:36:35.175226 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:36:35.176231 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:36:35.176231 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:36:35.179237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:36:35.180138 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:36:35.181138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BBD59930>]}
[0m19:36:35.182141 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.08s]
[0m19:36:35.183141 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:36:35.183141 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:36:35.184156 [info ] [Thread-1 (]: 3 of 5 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:36:35.184156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:36:35.185138 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:36:35.187138 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:36:35.188138 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:36:35.192144 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:36:35.193138 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:36:35.194145 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:36:35.194145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:35.230300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:36:35.230300 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:36:35.230300 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:36:35.230300 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m19:36:35.242962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:36:35.242962 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:36:35.242962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:36:35.242962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:36:35.242962 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:36:35.242962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:35.242962 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:36:35.242962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:36:35.242962 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:36:35.242962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:36:35.242962 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:36:35.242962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:36:35.242962 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:36:35.259482 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:36:35.260512 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:36:35.261563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BC1B0FD0>]}
[0m19:36:35.262481 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.08s]
[0m19:36:35.263490 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:36:35.263490 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:36:35.263490 [info ] [Thread-1 (]: 4 of 5 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:36:35.264480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:36:35.265481 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:36:35.268485 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:36:35.269485 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:36:35.273481 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:36:35.275036 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:36:35.275708 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:36:35.275708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:35.312709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:36:35.313711 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:36:35.313711 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:36:35.320799 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.007 seconds
[0m19:36:35.323708 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:36:35.324715 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m19:36:35.325709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:35.329710 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:36:35.329710 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:36:35.330710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:36:35.331710 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:36:35.332794 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:36:35.332794 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:36:35.334712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:36:35.336708 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:36:35.336708 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:36:35.337708 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:36:35.340723 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:36:35.341708 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:36:35.342709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE19EBF0>]}
[0m19:36:35.343709 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.08s]
[0m19:36:35.344719 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:36:35.344719 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m19:36:35.345714 [info ] [Thread-1 (]: 5 of 5 START sql table model dwh.dim_time ...................................... [RUN]
[0m19:36:35.345714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_time)
[0m19:36:35.346709 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m19:36:35.348708 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m19:36:35.349709 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m19:36:35.352708 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m19:36:35.353708 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:36:35.354712 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m19:36:35.354712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:35.395710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m19:36:35.395710 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:36:35.396709 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

with time_series as (
    select generate_series(
        time '00:00',
        time '23:59',
        interval '1 minute'
    )::time as full_time
)

select 
    row_number() over () as time_id,
    extract(hour from full_time)::int as hour,
    extract(minute from full_time)::int as minute
from time_series
order by full_time
  );
  
[0m19:36:35.397793 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function generate_series(time without time zone, time without time zone, interval) does not exist
LINE 15:     select generate_series(
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:36:35.397793 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: ROLLBACK
[0m19:36:35.398710 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m19:36:35.401711 [debug] [Thread-1 (]: Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 15:     select generate_series(
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql
[0m19:36:35.402711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '791c5d9b-335e-4db5-9bf3-dd668fbe5b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BDF50820>]}
[0m19:36:35.403711 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dwh.dim_time ............................. [[31mERROR[0m in 0.06s]
[0m19:36:35.404709 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m19:36:35.404709 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_time' to be skipped because of status 'error'.  Reason: Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 15:     select generate_series(
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql.
[0m19:36:35.406744 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:35.406744 [debug] [MainThread]: On master: BEGIN
[0m19:36:35.406744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:35.553248 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m19:36:35.553248 [debug] [MainThread]: On master: COMMIT
[0m19:36:35.553248 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:35.554319 [debug] [MainThread]: On master: COMMIT
[0m19:36:35.554319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:36:35.555211 [debug] [MainThread]: On master: Close
[0m19:36:35.555211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:35.555211 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:36:35.556211 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:36:35.556211 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m19:36:35.556211 [info ] [MainThread]: 
[0m19:36:35.557226 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m19:36:35.559233 [debug] [MainThread]: Command end result
[0m19:36:35.578328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:36:35.581292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:36:35.586300 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:36:35.587269 [info ] [MainThread]: 
[0m19:36:35.588232 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:36:35.588232 [info ] [MainThread]: 
[0m19:36:35.589280 [error] [MainThread]:   Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 15:     select generate_series(
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql
[0m19:36:35.590231 [info ] [MainThread]: 
[0m19:36:35.590231 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:36:35.591218 [debug] [MainThread]: Command `dbt run` failed at 19:36:35.591218 after 1.87 seconds
[0m19:36:35.592301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BC1103A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE6939A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE6921D0>]}
[0m19:36:35.592301 [debug] [MainThread]: Flushing usage events
[0m19:36:36.391878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:56.691077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDC990340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE7BBBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE7BBF40>]}


============================== 19:37:56.695095 | df70f3ea-f8d4-4561-b74f-3abf10b80cc4 ==============================
[0m19:37:56.695095 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:37:56.696891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:37:56.855597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE8E3610>]}
[0m19:37:56.899586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE0E25F0>]}
[0m19:37:56.901203 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:37:57.113696 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:37:57.267808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:57.268809 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_time.sql
[0m19:37:57.457827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:37:57.474547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDFF1A770>]}
[0m19:37:57.539549 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:37:57.543551 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:37:57.569911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDFEBBC40>]}
[0m19:37:57.569911 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m19:37:57.570911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDFEB91B0>]}
[0m19:37:57.571942 [info ] [MainThread]: 
[0m19:37:57.572931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:57.572931 [info ] [MainThread]: 
[0m19:37:57.573938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:57.578938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:37:57.705114 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:37:57.706114 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:37:57.706114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:57.749960 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m19:37:57.751136 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:37:57.753313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:37:57.759602 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:37:57.759602 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:37:57.760210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:57.900905 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m19:37:57.901971 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:37:57.901971 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:37:57.907925 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m19:37:57.908875 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:37:57.909877 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:37:57.914985 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:57.914985 [debug] [MainThread]: On master: BEGIN
[0m19:37:57.914985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:57.948706 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m19:37:57.949671 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:57.949671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:57.957669 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:37:57.958674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDFF18F70>]}
[0m19:37:57.958674 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:57.959816 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:57.959816 [debug] [MainThread]: On master: BEGIN
[0m19:37:57.960823 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:37:57.960823 [debug] [MainThread]: On master: COMMIT
[0m19:37:57.960823 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:57.960823 [debug] [MainThread]: On master: COMMIT
[0m19:37:57.961822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:57.961822 [debug] [MainThread]: On master: Close
[0m19:37:57.966862 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m19:37:57.966862 [info ] [Thread-1 (]: 1 of 5 START sql table model dwh.dim_date ...................................... [RUN]
[0m19:37:57.967914 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m19:37:57.967914 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m19:37:57.973942 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m19:37:57.975836 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m19:37:58.007822 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m19:37:58.008822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:37:58.009824 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m19:37:58.009824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:58.044364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m19:37:58.044364 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:37:58.045445 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        date '2030-12-31', 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m19:37:58.047562 [debug] [Thread-1 (]: SQL status: SELECT 5144 in 0.014 seconds
[0m19:37:58.063209 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:37:58.063209 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m19:37:58.063209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.063209 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:37:58.063209 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:37:58.063209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.086156 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:37:58.087139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:37:58.087139 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:37:58.089051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:37:58.094159 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m19:37:58.099071 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:37:58.099071 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m19:37:58.104057 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:37:58.106156 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m19:37:58.108060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE8E1D80>]}
[0m19:37:58.109057 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dwh.dim_date ................................. [[32mSELECT 5144[0m in 0.14s]
[0m19:37:58.110058 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m19:37:58.111059 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:37:58.111059 [info ] [Thread-1 (]: 2 of 5 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:37:58.111750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m19:37:58.111750 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:37:58.114841 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:37:58.115846 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:37:58.118842 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:37:58.119846 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:37:58.120771 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:37:58.120771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:58.159840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:37:58.159840 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:37:58.159840 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:37:58.167863 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.007 seconds
[0m19:37:58.170843 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:37:58.170843 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:37:58.171870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.174834 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:37:58.174834 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:37:58.175806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.176845 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:37:58.176845 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:37:58.177834 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:37:58.178855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:58.183840 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:37:58.184851 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:37:58.184851 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:37:58.187855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:37:58.188854 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:37:58.189845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDC10A5C0>]}
[0m19:37:58.190759 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.08s]
[0m19:37:58.191812 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:37:58.191812 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:37:58.192799 [info ] [Thread-1 (]: 3 of 5 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:37:58.193772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:37:58.193772 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:37:58.196759 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:37:58.197850 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:37:58.201841 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:37:58.202761 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:37:58.202761 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:37:58.203796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:58.241834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:37:58.241834 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:37:58.241834 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:37:58.249759 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m19:37:58.252847 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:37:58.252847 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:37:58.253841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.256851 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:37:58.256851 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:37:58.257851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:37:58.259848 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:37:58.259848 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:37:58.259848 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:37:58.261817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:58.263841 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:37:58.264839 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:37:58.264839 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:37:58.267822 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:37:58.268870 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:37:58.269842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDC558BE0>]}
[0m19:37:58.270794 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.08s]
[0m19:37:58.271759 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:37:58.271759 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:37:58.271759 [info ] [Thread-1 (]: 4 of 5 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:37:58.272759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:37:58.273758 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:37:58.275841 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:37:58.276848 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:37:58.281792 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:37:58.282753 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:37:58.283706 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:37:58.283706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:58.317111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:37:58.317111 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:37:58.317111 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:37:58.330524 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.007 seconds
[0m19:37:58.335525 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:37:58.335525 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m19:37:58.336524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.338617 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:37:58.339610 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:37:58.339610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:58.341614 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:37:58.341614 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:37:58.341614 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:37:58.343577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:58.345646 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:37:58.346561 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:37:58.346561 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:37:58.349523 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:37:58.350631 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:37:58.351610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE9ECD90>]}
[0m19:37:58.352523 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.08s]
[0m19:37:58.353523 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:37:58.353523 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m19:37:58.354524 [info ] [Thread-1 (]: 5 of 5 START sql table model dwh.dim_time ...................................... [RUN]
[0m19:37:58.354524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_time)
[0m19:37:58.355592 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m19:37:58.357612 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m19:37:58.358612 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m19:37:58.361610 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m19:37:58.363529 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:37:58.363529 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m19:37:58.363529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:58.401548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:37:58.401548 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:37:58.402537 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_time__dbt_tmp"
  
  
    as
  
  (
    


WITH time_series AS (
  SELECT generate_series(
    '00:00'::time,
    '23:59'::time,
    interval '1 minute'
  ) AS time_val
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM time_val) AS hour,
  EXTRACT(minute FROM time_val) AS minute,
  time_val
FROM time_series
  );
  
[0m19:37:58.403606 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function generate_series(time without time zone, time without time zone, interval) does not exist
LINE 16:   SELECT generate_series(
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:37:58.403606 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: ROLLBACK
[0m19:37:58.404598 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m19:37:58.407523 [debug] [Thread-1 (]: Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 16:   SELECT generate_series(
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql
[0m19:37:58.408522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df70f3ea-f8d4-4561-b74f-3abf10b80cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDC558BE0>]}
[0m19:37:58.408522 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dwh.dim_time ............................. [[31mERROR[0m in 0.05s]
[0m19:37:58.409536 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m19:37:58.410543 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_time' to be skipped because of status 'error'.  Reason: Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 16:   SELECT generate_series(
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql.
[0m19:37:58.411525 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:58.412606 [debug] [MainThread]: On master: BEGIN
[0m19:37:58.412606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:58.451538 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m19:37:58.452542 [debug] [MainThread]: On master: COMMIT
[0m19:37:58.452542 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:58.452542 [debug] [MainThread]: On master: COMMIT
[0m19:37:58.453537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:58.453537 [debug] [MainThread]: On master: Close
[0m19:37:58.454537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:58.454537 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:37:58.454537 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:37:58.454537 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m19:37:58.455610 [info ] [MainThread]: 
[0m19:37:58.455610 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m19:37:58.457622 [debug] [MainThread]: Command end result
[0m19:37:58.475649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:37:58.478536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:37:58.486529 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:37:58.486529 [info ] [MainThread]: 
[0m19:37:58.487523 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:37:58.487523 [info ] [MainThread]: 
[0m19:37:58.488524 [error] [MainThread]:   Database Error in model dim_time (models\marts\dim_time.sql)
  function generate_series(time without time zone, time without time zone, interval) does not exist
  LINE 16:   SELECT generate_series(
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\marts\dim_time.sql
[0m19:37:58.489524 [info ] [MainThread]: 
[0m19:37:58.489524 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:37:58.490524 [debug] [MainThread]: Command `dbt run` failed at 19:37:58.490524 after 1.86 seconds
[0m19:37:58.491629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDC990340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDDA29930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE03F5E40>]}
[0m19:37:58.491629 [debug] [MainThread]: Flushing usage events
[0m19:37:59.315062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:48.915844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026407D90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026409BBBBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026409BBBF40>]}


============================== 19:38:48.918864 | 14142e3b-6afe-455b-af59-db9e4aa8fb5d ==============================
[0m19:38:48.918864 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:38:48.920858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:38:49.075482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026409CE3610>]}
[0m19:38:49.124851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264094E25F0>]}
[0m19:38:49.126772 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:38:49.352132 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:38:49.513139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:38:49.513139 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_time.sql
[0m19:38:49.698939 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:38:49.714654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640A34A770>]}
[0m19:38:49.788984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:38:49.792879 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:38:49.819340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640A2EFC40>]}
[0m19:38:49.819340 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m19:38:49.820340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640A2ED1B0>]}
[0m19:38:49.821341 [info ] [MainThread]: 
[0m19:38:49.822341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:49.823340 [info ] [MainThread]: 
[0m19:38:49.823340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:38:49.829341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:38:49.954403 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:38:49.955488 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:38:49.955488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:49.982109 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.040 seconds
[0m19:38:49.982109 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:38:49.998929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:38:50.004030 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:38:50.004030 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:38:50.005009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:50.040023 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m19:38:50.040928 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:38:50.040928 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:38:50.047022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m19:38:50.048025 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:38:50.048926 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:38:50.053007 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:50.054007 [debug] [MainThread]: On master: BEGIN
[0m19:38:50.054007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:50.087475 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m19:38:50.088475 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:50.088475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:38:50.096809 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:38:50.097904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640A348F70>]}
[0m19:38:50.097904 [debug] [MainThread]: On master: ROLLBACK
[0m19:38:50.098874 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:50.098874 [debug] [MainThread]: On master: BEGIN
[0m19:38:50.098874 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:38:50.098874 [debug] [MainThread]: On master: COMMIT
[0m19:38:50.098874 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:50.098874 [debug] [MainThread]: On master: COMMIT
[0m19:38:50.098874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:38:50.098874 [debug] [MainThread]: On master: Close
[0m19:38:50.098874 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m19:38:50.098874 [info ] [Thread-1 (]: 1 of 5 START sql table model dwh.dim_date ...................................... [RUN]
[0m19:38:50.098874 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m19:38:50.098874 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m19:38:50.098874 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m19:38:50.114500 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m19:38:50.152004 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m19:38:50.154101 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:38:50.155047 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m19:38:50.155047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:38:50.191920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m19:38:50.192424 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:38:50.192424 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        date '2030-12-31', 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m19:38:50.192424 [debug] [Thread-1 (]: SQL status: SELECT 5144 in 0.013 seconds
[0m19:38:50.215243 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:38:50.215243 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m19:38:50.216245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.218243 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:38:50.219243 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:38:50.220244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:38:50.232242 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:38:50.233243 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:38:50.233243 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:38:50.234481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:38:50.242167 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m19:38:50.242167 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:38:50.242167 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m19:38:50.242167 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:38:50.250636 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m19:38:50.253531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026409CE1D80>]}
[0m19:38:50.254629 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dwh.dim_date ................................. [[32mSELECT 5144[0m in 0.15s]
[0m19:38:50.255535 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m19:38:50.255535 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:38:50.255535 [info ] [Thread-1 (]: 2 of 5 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:38:50.256534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m19:38:50.257530 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:38:50.259529 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:38:50.260530 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:38:50.263529 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:38:50.264529 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:38:50.265914 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:38:50.265914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:50.304600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:38:50.305679 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:38:50.305679 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:38:50.311600 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.006 seconds
[0m19:38:50.314684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:38:50.315617 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:38:50.315617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.318683 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:38:50.318683 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:38:50.320074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.321081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:38:50.321081 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:38:50.322080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:38:50.322999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:38:50.325939 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:38:50.326940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:38:50.326940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:38:50.329939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:38:50.330940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:38:50.330940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640750A5C0>]}
[0m19:38:50.331941 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.07s]
[0m19:38:50.332938 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:38:50.333937 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:38:50.333937 [info ] [Thread-1 (]: 3 of 5 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:38:50.334937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:38:50.334937 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:38:50.337940 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:38:50.338941 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:38:50.341939 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:38:50.342940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:38:50.343963 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:38:50.343963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:50.370567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:38:50.370567 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:38:50.370567 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:38:50.385027 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m19:38:50.385027 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:38:50.385027 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:38:50.385027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.385027 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:38:50.385027 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:38:50.385027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.400131 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:38:50.400131 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:38:50.400131 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:38:50.402067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:38:50.404125 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:38:50.405127 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:38:50.405127 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:38:50.408158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:38:50.409114 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:38:50.410115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026407958BE0>]}
[0m19:38:50.410115 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.07s]
[0m19:38:50.411119 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:38:50.412115 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:38:50.412115 [info ] [Thread-1 (]: 4 of 5 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:38:50.413115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:38:50.413115 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:38:50.416113 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:38:50.418114 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:38:50.422698 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:38:50.423710 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:38:50.423710 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:38:50.424711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:50.450568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:38:50.450568 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:38:50.450568 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:38:50.469580 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m19:38:50.469580 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:38:50.469580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m19:38:50.469580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.469580 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:38:50.469580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:38:50.469580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:38:50.469580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:38:50.469580 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:38:50.469580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:38:50.469580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:38:50.484165 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:38:50.484165 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:38:50.484165 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:38:50.484165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:38:50.484165 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:38:50.484165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026409DEDDE0>]}
[0m19:38:50.484165 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.07s]
[0m19:38:50.484165 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:38:50.484165 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m19:38:50.484165 [info ] [Thread-1 (]: 5 of 5 START sql view model dwh.dim_time ....................................... [RUN]
[0m19:38:50.484165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_time)
[0m19:38:50.484165 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m19:38:50.484165 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m19:38:50.484165 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m19:38:50.505788 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m19:38:50.516822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:38:50.517284 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m19:38:50.517284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:50.550566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:38:50.550566 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:38:50.550566 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m19:38:50.550566 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:38:50.565841 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:38:50.565841 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:38:50.566825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:38:50.568950 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m19:38:50.568950 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:38:50.568950 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m19:38:50.570843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:38:50.572917 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m19:38:50.574912 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:38:50.574912 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m19:38:50.575932 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:38:50.576912 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m19:38:50.576912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14142e3b-6afe-455b-af59-db9e4aa8fb5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026407958BE0>]}
[0m19:38:50.577921 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dwh.dim_time .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:38:50.578822 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m19:38:50.579822 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:50.580821 [debug] [MainThread]: On master: BEGIN
[0m19:38:50.580821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:50.618754 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m19:38:50.619839 [debug] [MainThread]: On master: COMMIT
[0m19:38:50.619839 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:50.619839 [debug] [MainThread]: On master: COMMIT
[0m19:38:50.620836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:38:50.620836 [debug] [MainThread]: On master: Close
[0m19:38:50.620836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:50.621752 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:38:50.621752 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:38:50.621752 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m19:38:50.622753 [info ] [MainThread]: 
[0m19:38:50.622753 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m19:38:50.624863 [debug] [MainThread]: Command end result
[0m19:38:50.642871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:38:50.644861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:38:50.652842 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:38:50.652842 [info ] [MainThread]: 
[0m19:38:50.654207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:50.654207 [info ] [MainThread]: 
[0m19:38:50.655224 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:38:50.655914 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:50.655914 after 1.81 seconds
[0m19:38:50.656919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026407D90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640A303460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026408E2A5F0>]}
[0m19:38:50.656919 [debug] [MainThread]: Flushing usage events
[0m19:38:51.383779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:58.129008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA9B0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BC7DFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BC7DFF40>]}


============================== 19:49:58.133028 | fdbc5210-6728-4a45-9b83-85ee7a53adf1 ==============================
[0m19:49:58.133028 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:49:58.134022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:58.295078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdbc5210-6728-4a45-9b83-85ee7a53adf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BC8FF610>]}
[0m19:49:58.343087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdbc5210-6728-4a45-9b83-85ee7a53adf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BC1025F0>]}
[0m19:49:58.344080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:49:58.564850 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:49:58.724899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:49:58.724899 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_status.sql
[0m19:49:58.867800 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_status (models\marts\dim_status.sql)
  expected token 'end of print statement', got '='
    line 1
      config{{materialized=table}}
[0m19:49:58.867800 [debug] [MainThread]: Command `dbt run` failed at 19:49:58.867800 after 0.81 seconds
[0m19:49:58.867800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA9B0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BCE057E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BCE056F0>]}
[0m19:49:58.867800 [debug] [MainThread]: Flushing usage events
[0m19:49:59.581314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:17.622414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9AD4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EB930910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EB930550>]}


============================== 19:50:17.638641 | acee8574-99ec-4a79-bd94-25956671aa1f ==============================
[0m19:50:17.638641 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:50:17.639087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:17.807491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EBA90340>]}
[0m19:50:17.859548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9B70970>]}
[0m19:50:17.861466 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:50:18.077692 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:50:18.219510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:50:18.220512 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_status.sql
[0m19:50:18.448945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:50:18.458265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EBEED7B0>]}
[0m19:50:18.555063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:50:18.559033 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:50:18.588997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EC044BB0>]}
[0m19:50:18.588997 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m19:50:18.589996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E91F7760>]}
[0m19:50:18.591999 [info ] [MainThread]: 
[0m19:50:18.591999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:18.592997 [info ] [MainThread]: 
[0m19:50:18.592997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:18.598997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:50:18.721846 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:50:18.721846 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:50:18.722845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:18.762843 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.040 seconds
[0m19:50:18.763935 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:50:18.765942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:50:18.770932 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:50:18.771941 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:50:18.771941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:18.920289 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m19:50:18.920289 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:50:18.920289 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:50:18.922507 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m19:50:18.922507 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:50:18.922507 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:50:18.922507 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:18.922507 [debug] [MainThread]: On master: BEGIN
[0m19:50:18.922507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:18.953757 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m19:50:18.969382 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:18.969382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:18.969382 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:50:18.969382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EBEBD1B0>]}
[0m19:50:18.969382 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:18.969382 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:18.969382 [debug] [MainThread]: On master: BEGIN
[0m19:50:18.969382 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:50:18.969382 [debug] [MainThread]: On master: COMMIT
[0m19:50:18.969382 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:18.969382 [debug] [MainThread]: On master: COMMIT
[0m19:50:18.969382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:50:18.969382 [debug] [MainThread]: On master: Close
[0m19:50:18.987113 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m19:50:18.987113 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh.dim_date ...................................... [RUN]
[0m19:50:18.988444 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m19:50:18.988444 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m19:50:18.994534 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m19:50:18.995548 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m19:50:19.028556 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m19:50:19.030479 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:50:19.030479 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m19:50:19.030479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:19.066562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m19:50:19.066562 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:50:19.066562 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        date '2030-12-31', 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m19:50:19.081560 [debug] [Thread-1 (]: SQL status: SELECT 5144 in 0.014 seconds
[0m19:50:19.090463 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:50:19.090463 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m19:50:19.091550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.093535 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:50:19.093535 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:50:19.094539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.107537 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:50:19.107537 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:50:19.107537 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:50:19.110451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:50:19.117506 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m19:50:19.121453 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:50:19.121453 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m19:50:19.126821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:50:19.128821 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m19:50:19.131818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EC0D11B0>]}
[0m19:50:19.132818 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh.dim_date ................................. [[32mSELECT 5144[0m in 0.14s]
[0m19:50:19.133820 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m19:50:19.134836 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:50:19.134836 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:50:19.135823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m19:50:19.136821 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:50:19.139858 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:50:19.140825 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:50:19.144820 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:50:19.146824 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:50:19.147908 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:50:19.147908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:19.186295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:50:19.186295 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:50:19.187307 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:50:19.195159 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.007 seconds
[0m19:50:19.198185 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:50:19.199212 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:50:19.199212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.202186 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:50:19.202186 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:50:19.203102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.204200 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:50:19.204200 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:50:19.205189 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:50:19.207103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:50:19.209210 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:50:19.210189 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:50:19.210189 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:50:19.213062 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:50:19.214108 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:50:19.214108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231ED5CBE80>]}
[0m19:50:19.215104 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.08s]
[0m19:50:19.216060 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:50:19.217062 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:50:19.217062 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:50:19.218022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:50:19.218022 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:50:19.221130 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:50:19.222024 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:50:19.226104 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:50:19.227131 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:50:19.228024 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:50:19.228024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:19.264626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:50:19.265656 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:50:19.265656 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:50:19.270708 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m19:50:19.275735 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:50:19.276734 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:50:19.276734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.279718 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:50:19.279718 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:50:19.280735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.281626 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:50:19.282625 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:50:19.282625 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:50:19.283664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:19.287718 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:50:19.287718 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:50:19.288704 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:50:19.291626 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:50:19.292713 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:50:19.293626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231ED60EE00>]}
[0m19:50:19.293626 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.07s]
[0m19:50:19.294625 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:50:19.295625 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:50:19.295625 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:50:19.296626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:50:19.296626 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:50:19.299625 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:50:19.300625 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:50:19.303624 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:50:19.304624 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:50:19.305625 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:50:19.305625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:19.343708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:50:19.343708 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:50:19.344714 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:50:19.350713 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m19:50:19.353730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:50:19.353730 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m19:50:19.354705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.358736 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:50:19.358736 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:50:19.359702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:19.361626 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:50:19.361626 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:50:19.361626 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:50:19.363724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:19.365715 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:50:19.366728 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:50:19.366728 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:50:19.368732 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:50:19.369722 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:50:19.370714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9695330>]}
[0m19:50:19.371665 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.07s]
[0m19:50:19.372625 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:50:19.372625 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m19:50:19.373625 [info ] [Thread-1 (]: 5 of 6 START sql table model dwh.dim_status .................................... [RUN]
[0m19:50:19.373625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m19:50:19.374626 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m19:50:19.417624 [debug] [Thread-1 (]: Compilation Error in model dim_status (models\marts\dim_status.sql)
  'data_source' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:50:19.417624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231ED636B30>]}
[0m19:50:19.418624 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model dwh.dim_status ........................... [[31mERROR[0m in 0.04s]
[0m19:50:19.418624 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m19:50:19.419625 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m19:50:19.420728 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_status' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_status (models\marts\dim_status.sql)
  'data_source' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:50:19.419625 [info ] [Thread-1 (]: 6 of 6 START sql view model dwh.dim_time ....................................... [RUN]
[0m19:50:19.421717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m19:50:19.421717 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m19:50:19.425722 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m19:50:19.427671 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m19:50:19.443627 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m19:50:19.445640 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:50:19.445640 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m19:50:19.445640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:19.482627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m19:50:19.482627 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:50:19.482627 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m19:50:19.485737 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:50:19.490280 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:50:19.490280 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m19:50:19.490280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:19.490280 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:50:19.490280 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:50:19.490280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:19.490280 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m19:50:19.490280 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:50:19.490280 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m19:50:19.490280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:50:19.490280 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m19:50:19.505798 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:50:19.505798 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m19:50:19.507799 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:50:19.508883 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m19:50:19.508883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acee8574-99ec-4a79-bd94-25956671aa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EC0CC6A0>]}
[0m19:50:19.509884 [info ] [Thread-1 (]: 6 of 6 OK created sql view model dwh.dim_time .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:50:19.510800 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m19:50:19.512803 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:19.512803 [debug] [MainThread]: On master: BEGIN
[0m19:50:19.512803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:19.548928 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m19:50:19.550010 [debug] [MainThread]: On master: COMMIT
[0m19:50:19.550010 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:19.550010 [debug] [MainThread]: On master: COMMIT
[0m19:50:19.550970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:50:19.550970 [debug] [MainThread]: On master: Close
[0m19:50:19.550970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:19.551929 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:50:19.551929 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:50:19.551929 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m19:50:19.552929 [info ] [MainThread]: 
[0m19:50:19.552929 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m19:50:19.555011 [debug] [MainThread]: Command end result
[0m19:50:19.573928 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:50:19.578042 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:50:19.583931 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:50:19.583931 [info ] [MainThread]: 
[0m19:50:19.584930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:50:19.584930 [info ] [MainThread]: 
[0m19:50:19.585931 [error] [MainThread]:   Compilation Error in model dim_status (models\marts\dim_status.sql)
  'data_source' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:50:19.585931 [info ] [MainThread]: 
[0m19:50:19.586929 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:50:19.587933 [debug] [MainThread]: Command `dbt run` failed at 19:50:19.587933 after 2.04 seconds
[0m19:50:19.588931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9AD4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EC0645E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EC0673D0>]}
[0m19:50:19.588931 [debug] [MainThread]: Flushing usage events
[0m19:50:20.309337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:27.013254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934E2203A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029350063C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029350063F70>]}


============================== 19:56:27.016302 | 63ef8521-59a3-4662-9b05-0aed319ecaa7 ==============================
[0m19:56:27.016302 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:56:27.018221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select status', 'send_anonymous_usage_stats': 'True'}
[0m19:56:27.171465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63ef8521-59a3-4662-9b05-0aed319ecaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935018A2C0>]}
[0m19:56:27.215372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63ef8521-59a3-4662-9b05-0aed319ecaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935018A200>]}
[0m19:56:27.215372 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:56:27.429273 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:56:27.571311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:56:27.587067 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_status.sql
[0m19:56:27.778186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:56:27.793893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63ef8521-59a3-4662-9b05-0aed319ecaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293517A0130>]}
[0m19:56:27.860862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:56:27.863904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:56:27.888961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63ef8521-59a3-4662-9b05-0aed319ecaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029351775F60>]}
[0m19:56:27.888961 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m19:56:27.889946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ef8521-59a3-4662-9b05-0aed319ecaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029351775FC0>]}
[0m19:56:27.890862 [warn ] [MainThread]: The selection criterion 'status' does not match any enabled nodes
[0m19:56:27.891912 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:56:27.892859 [debug] [MainThread]: Command end result
[0m19:56:27.944090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:56:27.944090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:56:27.960104 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:56:27.961019 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:27.961019 after 1.01 seconds
[0m19:56:27.961019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934E2203A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934D99A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934D2CA3B0>]}
[0m19:56:27.961019 [debug] [MainThread]: Flushing usage events
[0m19:56:28.653892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:36.324954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB5D942E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB7BBFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB7BBFEE0>]}


============================== 19:56:36.324954 | bc1535a6-3e9c-4a19-a105-c9c8f2d0597d ==============================
[0m19:56:36.324954 [info ] [MainThread]: Running with dbt=1.9.5
[0m19:56:36.324954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:36.498528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB7CE2320>]}
[0m19:56:36.547545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB7DEC550>]}
[0m19:56:36.548541 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:56:36.760768 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m19:56:36.911696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:36.912683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:36.917680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m19:56:36.946685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB80C9990>]}
[0m19:56:37.012671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:56:37.016704 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:56:37.039929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB811F040>]}
[0m19:56:37.040916 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m19:56:37.041921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB550A5C0>]}
[0m19:56:37.042941 [info ] [MainThread]: 
[0m19:56:37.043920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:37.043920 [info ] [MainThread]: 
[0m19:56:37.044922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:37.049923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m19:56:37.133410 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m19:56:37.133410 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m19:56:37.134411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:37.173414 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m19:56:37.174496 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m19:56:37.176413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m19:56:37.181501 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:56:37.182522 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m19:56:37.182522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:37.217482 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m19:56:37.217482 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m19:56:37.217482 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m19:56:37.224514 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m19:56:37.225519 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m19:56:37.225519 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m19:56:37.230606 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.230606 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.231610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:37.382319 [debug] [MainThread]: SQL status: BEGIN in 0.151 seconds
[0m19:56:37.382319 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.383319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:37.390320 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m19:56:37.391320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB7D4EA10>]}
[0m19:56:37.392321 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:37.392321 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.393382 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.393382 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:56:37.393382 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.393382 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.393382 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.393382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:56:37.393382 [debug] [MainThread]: On master: Close
[0m19:56:37.393382 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m19:56:37.393382 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh.dim_date ...................................... [RUN]
[0m19:56:37.393382 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m19:56:37.393382 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m19:56:37.410207 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m19:56:37.412064 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m19:56:37.447952 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m19:56:37.448983 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:56:37.449881 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m19:56:37.449881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:37.483962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m19:56:37.484980 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:56:37.484980 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        date '2030-12-31', 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m19:56:37.500611 [debug] [Thread-1 (]: SQL status: SELECT 5144 in 0.015 seconds
[0m19:56:37.509622 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:56:37.510617 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m19:56:37.510617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.551623 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:56:37.551623 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:56:37.553109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:56:37.565199 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:56:37.566210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:56:37.566210 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m19:56:37.568117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:56:37.573207 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m19:56:37.576203 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m19:56:37.577163 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m19:56:37.581117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:56:37.583116 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m19:56:37.586115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB8616E90>]}
[0m19:56:37.587118 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh.dim_date ................................. [[32mSELECT 5144[0m in 0.19s]
[0m19:56:37.588155 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m19:56:37.588155 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m19:56:37.589118 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh.dim_property_type ............................. [RUN]
[0m19:56:37.590163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m19:56:37.590163 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m19:56:37.592224 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m19:56:37.593207 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m19:56:37.597231 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m19:56:37.598116 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:56:37.599114 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m19:56:37.600116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:37.630330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:56:37.630330 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:56:37.630330 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m19:56:37.645514 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.007 seconds
[0m19:56:37.645514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:56:37.645514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m19:56:37.645514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.645514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:56:37.645514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m19:56:37.645514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.645514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:56:37.645514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:56:37.645514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m19:56:37.645514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:56:37.663861 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m19:56:37.663861 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m19:56:37.664875 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m19:56:37.667859 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:56:37.668893 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m19:56:37.668893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB87225C0>]}
[0m19:56:37.669784 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.08s]
[0m19:56:37.670837 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m19:56:37.671779 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m19:56:37.671779 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m19:56:37.672777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m19:56:37.672777 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m19:56:37.675885 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m19:56:37.676860 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m19:56:37.679855 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m19:56:37.681784 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:56:37.681784 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m19:56:37.681784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:37.717775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m19:56:37.718789 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:56:37.718789 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m19:56:37.725202 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m19:56:37.728210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:56:37.729211 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m19:56:37.731013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:56:37.733018 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:56:37.733018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m19:56:37.734018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.736018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:56:37.736018 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:56:37.736018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m19:56:37.738020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:56:37.740018 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m19:56:37.741018 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m19:56:37.741018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m19:56:37.744019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:56:37.745018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m19:56:37.746094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB81ABCA0>]}
[0m19:56:37.747019 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.07s]
[0m19:56:37.748020 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m19:56:37.748020 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m19:56:37.749022 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m19:56:37.749022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m19:56:37.750021 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m19:56:37.752021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m19:56:37.753021 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m19:56:37.756802 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m19:56:37.760655 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:56:37.761656 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m19:56:37.762100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:37.904720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m19:56:37.904720 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:56:37.905724 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m19:56:37.911758 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m19:56:37.914828 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:56:37.915809 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m19:56:37.915809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.918807 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:56:37.918807 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m19:56:37.919720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.920804 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:56:37.921723 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:56:37.921723 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m19:56:37.923466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:56:37.925605 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m19:56:37.926600 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m19:56:37.926600 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m19:56:37.928964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:56:37.930046 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m19:56:37.931054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB81ABCA0>]}
[0m19:56:37.931963 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.18s]
[0m19:56:37.932962 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m19:56:37.932962 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m19:56:37.933964 [info ] [Thread-1 (]: 5 of 6 START sql table model dwh.dim_status .................................... [RUN]
[0m19:56:37.933964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m19:56:37.934962 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m19:56:37.938040 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m19:56:37.939967 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m19:56:37.943056 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m19:56:37.944974 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m19:56:37.944974 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m19:56:37.945993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:37.983830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m19:56:37.983830 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m19:56:37.983830 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads" -- هنا استخدمنا الـ macro الصحيح بعد تعريف الـ source
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m19:56:38.015824 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.031 seconds
[0m19:56:38.018753 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m19:56:38.019821 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m19:56:38.020759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:56:38.021748 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m19:56:38.022741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m19:56:38.022741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m19:56:38.024785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:56:38.028742 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m19:56:38.029741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m19:56:38.029741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m19:56:38.030740 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:56:38.031745 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m19:56:38.032744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB8725600>]}
[0m19:56:38.033741 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dwh.dim_status ............................... [[32mSELECT 48[0m in 0.10s]
[0m19:56:38.034743 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m19:56:38.034743 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m19:56:38.035744 [info ] [Thread-1 (]: 6 of 6 START sql view model dwh.dim_time ....................................... [RUN]
[0m19:56:38.036740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m19:56:38.036740 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m19:56:38.039753 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m19:56:38.040746 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m19:56:38.049013 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m19:56:38.049013 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:56:38.060699 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m19:56:38.060699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:38.100430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m19:56:38.100430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:56:38.100430 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m19:56:38.105401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:56:38.108409 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:56:38.108409 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m19:56:38.109409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:38.112409 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:56:38.112409 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:56:38.113409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:38.114409 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m19:56:38.115409 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:56:38.115409 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m19:56:38.117461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:56:38.119409 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m19:56:38.121409 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m19:56:38.122409 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m19:56:38.123496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:56:38.124410 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m19:56:38.125425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1535a6-3e9c-4a19-a105-c9c8f2d0597d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB86CD6C0>]}
[0m19:56:38.126408 [info ] [Thread-1 (]: 6 of 6 OK created sql view model dwh.dim_time .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:56:38.127408 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m19:56:38.128409 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:38.129489 [debug] [MainThread]: On master: BEGIN
[0m19:56:38.129489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:38.162085 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m19:56:38.162085 [debug] [MainThread]: On master: COMMIT
[0m19:56:38.162085 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:38.162085 [debug] [MainThread]: On master: COMMIT
[0m19:56:38.162085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:56:38.162085 [debug] [MainThread]: On master: Close
[0m19:56:38.162085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:38.162085 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m19:56:38.162085 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m19:56:38.162085 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m19:56:38.162085 [info ] [MainThread]: 
[0m19:56:38.162085 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m19:56:38.162085 [debug] [MainThread]: Command end result
[0m19:56:38.179960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m19:56:38.179960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m19:56:38.196562 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m19:56:38.196562 [info ] [MainThread]: 
[0m19:56:38.196562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:38.196562 [info ] [MainThread]: 
[0m19:56:38.196562 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:56:38.196562 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:38.196562 after 1.94 seconds
[0m19:56:38.196562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB5D942E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB817D3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6E2B220>]}
[0m19:56:38.196562 [debug] [MainThread]: Flushing usage events
[0m19:56:38.913035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:35.147016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B600A0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B60EF7BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B60EF7F70>]}


============================== 22:14:35.147016 | b241a02a-42da-4a95-87d2-e123dc3aa1c1 ==============================
[0m22:14:35.147016 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:14:35.147016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:14:35.316236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B60FFEA40>]}
[0m22:14:35.376327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6086DD50>]}
[0m22:14:35.378489 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:14:35.612267 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:14:35.777660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:14:35.777660 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_status.sql
[0m22:14:35.778649 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_date.sql
[0m22:14:35.976275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:14:35.991279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B62640130>]}
[0m22:14:36.059276 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:14:36.062273 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:14:36.097274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B625E98D0>]}
[0m22:14:36.098271 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m22:14:36.098271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B625EBFD0>]}
[0m22:14:36.100381 [info ] [MainThread]: 
[0m22:14:36.100381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:14:36.101327 [info ] [MainThread]: 
[0m22:14:36.102315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:36.106364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:14:36.237998 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:14:36.237998 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:14:36.238997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:36.283942 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.045 seconds
[0m22:14:36.284905 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:14:36.286906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:14:36.293352 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:14:36.293352 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:14:36.293352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:36.324604 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m22:14:36.324604 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:14:36.324604 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:14:36.324604 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m22:14:36.324604 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:14:36.324604 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:14:36.340258 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:36.340258 [debug] [MainThread]: On master: BEGIN
[0m22:14:36.340258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:36.382535 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m22:14:36.382535 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:36.382535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:36.393536 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m22:14:36.394608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B614C7640>]}
[0m22:14:36.395610 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:36.395610 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:36.396626 [debug] [MainThread]: On master: BEGIN
[0m22:14:36.396626 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:14:36.397631 [debug] [MainThread]: On master: COMMIT
[0m22:14:36.397631 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:36.398715 [debug] [MainThread]: On master: COMMIT
[0m22:14:36.398849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:36.398849 [debug] [MainThread]: On master: Close
[0m22:14:36.404918 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m22:14:36.405852 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh.dim_date ...................................... [RUN]
[0m22:14:36.406921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_date'
[0m22:14:36.406921 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m22:14:36.412851 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m22:14:36.414856 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m22:14:36.448308 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m22:14:36.450315 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m22:14:36.450315 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m22:14:36.451309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:14:36.488331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m22:14:36.489310 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m22:14:36.489310 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m22:14:36.502391 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.013 seconds
[0m22:14:36.511310 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m22:14:36.511310 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m22:14:36.512371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:36.515310 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m22:14:36.515310 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m22:14:36.516388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:36.529309 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m22:14:36.529309 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m22:14:36.529309 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m22:14:36.532312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:14:36.537310 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m22:14:36.540309 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m22:14:36.540309 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m22:14:36.546355 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:14:36.548310 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m22:14:36.551352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B5DFBB130>]}
[0m22:14:36.552312 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh.dim_date ................................. [[32mSELECT 3105[0m in 0.14s]
[0m22:14:36.553309 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m22:14:36.554307 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m22:14:36.554307 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh.dim_property_type ............................. [RUN]
[0m22:14:36.555309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_property_type)
[0m22:14:36.555309 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m22:14:36.558309 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m22:14:36.559310 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m22:14:36.563309 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m22:14:36.566310 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m22:14:36.567315 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m22:14:36.568327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:36.600204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m22:14:36.600204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m22:14:36.600204 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type AS property_type_name
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m22:14:36.600204 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.005 seconds
[0m22:14:36.616746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m22:14:36.616746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m22:14:36.616746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:36.616746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m22:14:36.616746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m22:14:36.616746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:36.616746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m22:14:36.616746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m22:14:36.616746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m22:14:36.616746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:14:36.616746 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m22:14:36.616746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m22:14:36.631707 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m22:14:36.634689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:14:36.635690 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m22:14:36.636690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B62C1B8E0>]}
[0m22:14:36.637686 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh.dim_property_type ........................ [[32mSELECT 14[0m in 0.08s]
[0m22:14:36.638687 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m22:14:36.638687 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m22:14:36.639686 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh.dim_sale_category ............................. [RUN]
[0m22:14:36.640702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m22:14:36.640702 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m22:14:36.643690 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m22:14:36.644691 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m22:14:36.648756 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m22:14:36.650681 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m22:14:36.650681 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m22:14:36.651682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:36.796781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m22:14:36.796781 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m22:14:36.796781 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m22:14:36.803495 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m22:14:36.806589 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m22:14:36.807579 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m22:14:36.807579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:36.811584 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m22:14:36.811584 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m22:14:36.812575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:36.814494 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m22:14:36.814494 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m22:14:36.814494 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m22:14:36.818000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:36.820005 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m22:14:36.821008 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m22:14:36.821008 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m22:14:36.824056 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:14:36.826005 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m22:14:36.826005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B62C34EB0>]}
[0m22:14:36.827006 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh.dim_sale_category ........................ [[32mSELECT 6[0m in 0.19s]
[0m22:14:36.828005 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m22:14:36.829010 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m22:14:36.829010 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh.dim_sales_location ............................ [RUN]
[0m22:14:36.830013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m22:14:36.830013 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m22:14:36.834092 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m22:14:36.836047 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m22:14:36.839097 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m22:14:36.840118 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m22:14:36.841013 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m22:14:36.841013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:36.883516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m22:14:36.883516 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m22:14:36.883516 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m22:14:36.883516 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m22:14:36.883516 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m22:14:36.883516 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m22:14:36.898588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:36.901591 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m22:14:36.901591 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m22:14:36.902635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:36.903591 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m22:14:36.904589 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m22:14:36.904589 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m22:14:36.906046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:14:36.908141 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m22:14:36.909164 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m22:14:36.909164 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m22:14:36.912060 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:14:36.913137 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m22:14:36.914163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B60858D00>]}
[0m22:14:36.915052 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh.dim_sales_location ....................... [[32mSELECT 31[0m in 0.08s]
[0m22:14:36.916060 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m22:14:36.916060 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m22:14:36.917059 [info ] [Thread-1 (]: 5 of 6 START sql table model dwh.dim_status .................................... [RUN]
[0m22:14:36.918058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m22:14:36.918058 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m22:14:36.921174 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m22:14:36.922147 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m22:14:36.925165 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m22:14:36.927054 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m22:14:36.927054 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m22:14:36.927054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:36.966617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m22:14:36.966617 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m22:14:36.966617 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m22:14:37.004558 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.032 seconds
[0m22:14:37.009647 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m22:14:37.009647 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m22:14:37.010642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:37.012649 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m22:14:37.013653 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m22:14:37.014556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:37.015556 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m22:14:37.016556 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m22:14:37.016556 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m22:14:37.019734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:37.021645 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m22:14:37.022646 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m22:14:37.022646 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m22:14:37.026646 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:14:37.027679 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m22:14:37.027679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B5EC97B50>]}
[0m22:14:37.028645 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dwh.dim_status ............................... [[32mSELECT 48[0m in 0.11s]
[0m22:14:37.029557 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m22:14:37.030556 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m22:14:37.030556 [info ] [Thread-1 (]: 6 of 6 START sql view model dwh.dim_time ....................................... [RUN]
[0m22:14:37.031556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m22:14:37.032565 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m22:14:37.034625 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m22:14:37.036564 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m22:14:37.053644 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m22:14:37.055557 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m22:14:37.055557 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m22:14:37.055557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:37.098557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m22:14:37.099557 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m22:14:37.100561 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m22:14:37.108576 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:14:37.111558 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m22:14:37.112557 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m22:14:37.113560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:37.116567 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m22:14:37.116567 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m22:14:37.117585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:37.119642 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m22:14:37.119642 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m22:14:37.119642 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m22:14:37.122559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:14:37.126559 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m22:14:37.128559 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m22:14:37.129558 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m22:14:37.130560 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:14:37.132560 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m22:14:37.133560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b241a02a-42da-4a95-87d2-e123dc3aa1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B62CB36D0>]}
[0m22:14:37.133560 [info ] [Thread-1 (]: 6 of 6 OK created sql view model dwh.dim_time .................................. [[32mCREATE VIEW[0m in 0.10s]
[0m22:14:37.135556 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m22:14:37.136557 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:37.137557 [debug] [MainThread]: On master: BEGIN
[0m22:14:37.137557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:37.179589 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m22:14:37.179589 [debug] [MainThread]: On master: COMMIT
[0m22:14:37.179589 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:37.180641 [debug] [MainThread]: On master: COMMIT
[0m22:14:37.180641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:37.181557 [debug] [MainThread]: On master: Close
[0m22:14:37.181557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:37.181557 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:14:37.182556 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:14:37.182556 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_time' was properly closed.
[0m22:14:37.183556 [info ] [MainThread]: 
[0m22:14:37.183556 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m22:14:37.185640 [debug] [MainThread]: Command end result
[0m22:14:37.203656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:14:37.206644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:14:37.212635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:14:37.213606 [info ] [MainThread]: 
[0m22:14:37.214567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:14:37.215558 [info ] [MainThread]: 
[0m22:14:37.215558 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:14:37.217569 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:37.217569 after 2.14 seconds
[0m22:14:37.218575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B600A0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6146CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6146EC80>]}
[0m22:14:37.219642 [debug] [MainThread]: Flushing usage events
[0m22:14:38.771269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:50.078971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B400370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0D233BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0D233FA0>]}


============================== 22:21:50.083056 | 8cd192f8-7610-4e2b-bd2c-814ac2191f20 ==============================
[0m22:21:50.083056 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:21:50.084365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_method_of_contact', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:50.234018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cd192f8-7610-4e2b-bd2c-814ac2191f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0D3562C0>]}
[0m22:21:50.280974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cd192f8-7610-4e2b-bd2c-814ac2191f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0D356200>]}
[0m22:21:50.280974 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:21:50.517754 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:21:50.675014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:21:50.675014 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_method_of_contact.sql
[0m22:21:50.821069 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  expected token 'end of print statement', got '='
    line 1
      config{{materialized='table'}}
[0m22:21:50.822973 [debug] [MainThread]: Command `dbt run` failed at 22:21:50.822973 after 0.81 seconds
[0m22:21:50.822973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B400370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0D859720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0D859630>]}
[0m22:21:50.824053 [debug] [MainThread]: Flushing usage events
[0m22:21:51.535169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:15.281547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AD860400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AE6F0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AE6F0850>]}


============================== 22:22:15.281547 | 9ea92d3b-7e19-48b1-a9bd-3c9601f23003 ==============================
[0m22:22:15.281547 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:22:15.281547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_method_of_contact', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:15.455871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AE7C5810>]}
[0m22:22:15.508825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AD902B00>]}
[0m22:22:15.508825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:22:15.739655 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:22:15.891464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:22:15.892464 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_method_of_contact.sql
[0m22:22:16.082851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:22:16.098384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AEE300D0>]}
[0m22:22:16.179183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:22:16.183116 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:22:16.203160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AEB01FC0>]}
[0m22:22:16.203160 [info ] [MainThread]: Found 7 models, 2 sources, 433 macros
[0m22:22:16.203160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AEB01FF0>]}
[0m22:22:16.203160 [info ] [MainThread]: 
[0m22:22:16.203160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:16.203160 [info ] [MainThread]: 
[0m22:22:16.218786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:16.218786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:22:16.345334 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:22:16.346319 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:22:16.346319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:16.379073 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m22:22:16.379073 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:22:16.394698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:22:16.394698 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:22:16.394698 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:22:16.394698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:16.426646 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m22:22:16.426646 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:22:16.426646 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:22:16.442261 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m22:22:16.442261 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:22:16.442261 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:22:16.442261 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:16.442261 [debug] [MainThread]: On master: BEGIN
[0m22:22:16.442261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:16.489128 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m22:22:16.490114 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:16.490346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:16.499238 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m22:22:16.500236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AECF01C0>]}
[0m22:22:16.500236 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:16.501274 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:16.501274 [debug] [MainThread]: On master: BEGIN
[0m22:22:16.502240 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:22:16.502240 [debug] [MainThread]: On master: COMMIT
[0m22:22:16.502240 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:16.503319 [debug] [MainThread]: On master: COMMIT
[0m22:22:16.503319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:16.504333 [debug] [MainThread]: On master: Close
[0m22:22:16.507808 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m22:22:16.507808 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_method_of_contact ......................... [RUN]
[0m22:22:16.507808 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_method_of_contact'
[0m22:22:16.507808 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m22:22:16.507808 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m22:22:16.507808 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m22:22:16.542959 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m22:22:16.542959 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:22:16.542959 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m22:22:16.542959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:16.591844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m22:22:16.591844 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:22:16.591844 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_name) as method_id,
method_name 
from(
    select distinct method_name
    from "dbt_project_db"."data_source"."leads"
    WHERE method_name is not NULL
)
  );
  
[0m22:22:16.591844 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "method_name" does not exist
LINE 17:     select distinct method_name
                             ^

[0m22:22:16.591844 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: ROLLBACK
[0m22:22:16.591844 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m22:22:16.591844 [debug] [Thread-1 (]: Database Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  column "method_name" does not exist
  LINE 17:     select distinct method_name
                               ^
  compiled code at target\run\my_dbt_project\models\marts\dim_method_of_contact.sql
[0m22:22:16.591844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ea92d3b-7e19-48b1-a9bd-3c9601f23003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AE6A0160>]}
[0m22:22:16.591844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_method_of_contact ................ [[31mERROR[0m in 0.08s]
[0m22:22:16.591844 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m22:22:16.591844 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_method_of_contact' to be skipped because of status 'error'.  Reason: Database Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  column "method_name" does not exist
  LINE 17:     select distinct method_name
                               ^
  compiled code at target\run\my_dbt_project\models\marts\dim_method_of_contact.sql.
[0m22:22:16.591844 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:16.607470 [debug] [MainThread]: On master: BEGIN
[0m22:22:16.607470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:16.647889 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m22:22:16.649003 [debug] [MainThread]: On master: COMMIT
[0m22:22:16.649003 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:16.649003 [debug] [MainThread]: On master: COMMIT
[0m22:22:16.649974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:16.649974 [debug] [MainThread]: On master: Close
[0m22:22:16.649974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:16.650889 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:22:16.650889 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:22:16.650889 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_method_of_contact' was properly closed.
[0m22:22:16.651888 [info ] [MainThread]: 
[0m22:22:16.651888 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m22:22:16.652900 [debug] [MainThread]: Command end result
[0m22:22:16.676448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:22:16.676448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:22:16.693169 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:22:16.693169 [info ] [MainThread]: 
[0m22:22:16.693169 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:22:16.693169 [info ] [MainThread]: 
[0m22:22:16.693169 [error] [MainThread]:   Database Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  column "method_name" does not exist
  LINE 17:     select distinct method_name
                               ^
  compiled code at target\run\my_dbt_project\models\marts\dim_method_of_contact.sql
[0m22:22:16.693169 [info ] [MainThread]: 
[0m22:22:16.693169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:22:16.693169 [debug] [MainThread]: Command `dbt run` failed at 22:22:16.693169 after 1.48 seconds
[0m22:22:16.693169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AD860400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AD8F72E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AE6F7970>]}
[0m22:22:16.693169 [debug] [MainThread]: Flushing usage events
[0m22:22:17.288046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:56.612587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183438803A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183456B3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183456B3FD0>]}


============================== 22:22:56.612587 | f0deaea1-0ce7-4901-974f-b71e944a8f44 ==============================
[0m22:22:56.612587 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:22:56.612587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_method_of_contact', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:22:56.794834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183457D8EB0>]}
[0m22:22:56.844101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018343922920>]}
[0m22:22:56.846131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:22:57.079868 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:22:57.251173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:57.252167 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_method_of_contact.sql
[0m22:22:57.458879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:22:57.473952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018345E1C100>]}
[0m22:22:57.545873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:22:57.549887 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:22:57.581867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018345E1C820>]}
[0m22:22:57.582870 [info ] [MainThread]: Found 7 models, 2 sources, 433 macros
[0m22:22:57.583867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018345E1C880>]}
[0m22:22:57.585870 [info ] [MainThread]: 
[0m22:22:57.585870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:57.586868 [info ] [MainThread]: 
[0m22:22:57.587868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:57.588869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:22:57.722179 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:22:57.722179 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:22:57.722179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:57.875891 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.153 seconds
[0m22:22:57.876925 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:22:57.882222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:22:57.887228 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:22:57.888229 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:22:57.888229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:57.916279 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m22:22:57.916279 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:22:57.916279 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:22:57.931925 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m22:22:57.931925 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:22:57.931925 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:22:57.931925 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:57.931925 [debug] [MainThread]: On master: BEGIN
[0m22:22:57.931925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:57.963137 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m22:22:57.963137 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:57.963137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:57.988946 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m22:22:57.990919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018341A6A0B0>]}
[0m22:22:57.991980 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:57.991980 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:57.992952 [debug] [MainThread]: On master: BEGIN
[0m22:22:57.992952 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:22:57.993964 [debug] [MainThread]: On master: COMMIT
[0m22:22:57.993964 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:57.993964 [debug] [MainThread]: On master: COMMIT
[0m22:22:57.995000 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:57.995000 [debug] [MainThread]: On master: Close
[0m22:22:58.001921 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m22:22:58.001921 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_method_of_contact ......................... [RUN]
[0m22:22:58.002973 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_method_of_contact'
[0m22:22:58.003961 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m22:22:58.011919 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m22:22:58.013922 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m22:22:58.049036 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m22:22:58.051021 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:22:58.051021 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m22:22:58.052019 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:58.208461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m22:22:58.208461 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:22:58.208461 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_name) as method_id,
method_name 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m22:22:58.208461 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "method_name" does not exist
LINE 15: method_name 
         ^

[0m22:22:58.208461 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: ROLLBACK
[0m22:22:58.208461 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m22:22:58.208461 [debug] [Thread-1 (]: Database Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  column "method_name" does not exist
  LINE 15: method_name 
           ^
  compiled code at target\run\my_dbt_project\models\marts\dim_method_of_contact.sql
[0m22:22:58.208461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0deaea1-0ce7-4901-974f-b71e944a8f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183434CD930>]}
[0m22:22:58.208461 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_method_of_contact ................ [[31mERROR[0m in 0.21s]
[0m22:22:58.224173 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m22:22:58.224928 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_method_of_contact' to be skipped because of status 'error'.  Reason: Database Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  column "method_name" does not exist
  LINE 15: method_name 
           ^
  compiled code at target\run\my_dbt_project\models\marts\dim_method_of_contact.sql.
[0m22:22:58.226936 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:58.226936 [debug] [MainThread]: On master: BEGIN
[0m22:22:58.226936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:58.265896 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m22:22:58.266994 [debug] [MainThread]: On master: COMMIT
[0m22:22:58.266994 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:58.266994 [debug] [MainThread]: On master: COMMIT
[0m22:22:58.267993 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:58.267993 [debug] [MainThread]: On master: Close
[0m22:22:58.268910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:58.268910 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:22:58.268910 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:22:58.269910 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_method_of_contact' was properly closed.
[0m22:22:58.269910 [info ] [MainThread]: 
[0m22:22:58.270910 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m22:22:58.271911 [debug] [MainThread]: Command end result
[0m22:22:58.291917 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:22:58.296927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:22:58.303048 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:22:58.303912 [info ] [MainThread]: 
[0m22:22:58.303912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:22:58.304910 [info ] [MainThread]: 
[0m22:22:58.305911 [error] [MainThread]:   Database Error in model dim_method_of_contact (models\marts\dim_method_of_contact.sql)
  column "method_name" does not exist
  LINE 15: method_name 
           ^
  compiled code at target\run\my_dbt_project\models\marts\dim_method_of_contact.sql
[0m22:22:58.306910 [info ] [MainThread]: 
[0m22:22:58.306910 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:22:58.308911 [debug] [MainThread]: Command `dbt run` failed at 22:22:58.308911 after 1.76 seconds
[0m22:22:58.308911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183438803A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018345094130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834500A650>]}
[0m22:22:58.309910 [debug] [MainThread]: Flushing usage events
[0m22:22:59.041959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:35.871170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD35DB42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD36C13B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD36C13F70>]}


============================== 22:23:35.875248 | 633124f8-e9e8-4e35-97a2-a17b64b0936b ==============================
[0m22:23:35.875248 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:23:35.877173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_method_of_contact', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:36.039169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD36D3AB30>]}
[0m22:23:36.087172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD35E51630>]}
[0m22:23:36.089170 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:23:36.327614 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:23:36.496145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:23:36.497183 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_method_of_contact.sql
[0m22:23:36.706734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:23:36.725227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3738C0D0>]}
[0m22:23:36.792265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:23:36.795185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:23:36.828130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD37185990>]}
[0m22:23:36.829129 [info ] [MainThread]: Found 7 models, 2 sources, 433 macros
[0m22:23:36.829129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD37187EB0>]}
[0m22:23:36.831224 [info ] [MainThread]: 
[0m22:23:36.832150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:36.832150 [info ] [MainThread]: 
[0m22:23:36.833132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:23:36.834173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:23:36.960755 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:23:36.960755 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:23:36.961756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:37.004757 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m22:23:37.005756 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:23:37.007059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:23:37.007059 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:23:37.007059 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:23:37.007059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:37.051965 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m22:23:37.051965 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:23:37.051965 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:23:37.051965 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m22:23:37.051965 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:23:37.051965 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:23:37.070802 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:37.070802 [debug] [MainThread]: On master: BEGIN
[0m22:23:37.070802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:37.222263 [debug] [MainThread]: SQL status: BEGIN in 0.151 seconds
[0m22:23:37.223369 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:37.224281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:23:37.233372 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m22:23:37.234413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3716EF80>]}
[0m22:23:37.234413 [debug] [MainThread]: On master: ROLLBACK
[0m22:23:37.235326 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:37.236339 [debug] [MainThread]: On master: BEGIN
[0m22:23:37.236339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:23:37.237323 [debug] [MainThread]: On master: COMMIT
[0m22:23:37.237323 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:37.237323 [debug] [MainThread]: On master: COMMIT
[0m22:23:37.238323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:23:37.238323 [debug] [MainThread]: On master: Close
[0m22:23:37.244960 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m22:23:37.244960 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_method_of_contact ......................... [RUN]
[0m22:23:37.246967 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_method_of_contact'
[0m22:23:37.246967 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m22:23:37.254968 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.256047 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m22:23:37.289969 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.291068 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.291969 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m22:23:37.291969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:37.332562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m22:23:37.333639 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.333639 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m22:23:37.352833 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.023 seconds
[0m22:23:37.352833 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.352833 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m22:23:37.352833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:37.368477 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m22:23:37.368477 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.368477 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m22:23:37.368477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:23:37.384159 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m22:23:37.384159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m22:23:37.384159 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m22:23:37.384159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:23:37.384159 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m22:23:37.384159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '633124f8-e9e8-4e35-97a2-a17b64b0936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD339173A0>]}
[0m22:23:37.384159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_method_of_contact .................... [[32mSELECT 77[0m in 0.14s]
[0m22:23:37.399735 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m22:23:37.400891 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:37.401881 [debug] [MainThread]: On master: BEGIN
[0m22:23:37.401881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:37.443975 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m22:23:37.444909 [debug] [MainThread]: On master: COMMIT
[0m22:23:37.444909 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:37.444909 [debug] [MainThread]: On master: COMMIT
[0m22:23:37.445961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:23:37.445961 [debug] [MainThread]: On master: Close
[0m22:23:37.446907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:37.446907 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:23:37.446907 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:23:37.447877 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_method_of_contact' was properly closed.
[0m22:23:37.447877 [info ] [MainThread]: 
[0m22:23:37.447877 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m22:23:37.449876 [debug] [MainThread]: Command end result
[0m22:23:37.469903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:23:37.472876 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:23:37.475345 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:23:37.475345 [info ] [MainThread]: 
[0m22:23:37.475345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:37.475345 [info ] [MainThread]: 
[0m22:23:37.475345 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:23:37.485074 [debug] [MainThread]: Command `dbt run` succeeded at 22:23:37.485074 after 1.68 seconds
[0m22:23:37.486121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD35DB42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD349A6E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD339173A0>]}
[0m22:23:37.486121 [debug] [MainThread]: Flushing usage events
[0m22:23:38.068993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:28:08.916730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CE0903A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CFEC3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CFEC3F70>]}


============================== 22:28:08.920806 | 5e79f124-3b97-416b-b246-adbc7816a593 ==============================
[0m22:28:08.920806 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:28:08.922729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_campiagn', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:09.081727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e79f124-3b97-416b-b246-adbc7816a593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CFFEA2C0>]}
[0m22:28:09.128729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e79f124-3b97-416b-b246-adbc7816a593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CFFEA200>]}
[0m22:28:09.129727 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:28:09.364111 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:28:09.527819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:09.528814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:09.533837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:28:09.563808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e79f124-3b97-416b-b246-adbc7816a593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D04AC100>]}
[0m22:28:09.634711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:28:09.637844 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:28:09.668806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e79f124-3b97-416b-b246-adbc7816a593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D04AE710>]}
[0m22:28:09.668806 [info ] [MainThread]: Found 7 models, 2 sources, 433 macros
[0m22:28:09.669797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e79f124-3b97-416b-b246-adbc7816a593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D02E6B60>]}
[0m22:28:09.670829 [warn ] [MainThread]: The selection criterion 'dim_campiagn' does not match any enabled nodes
[0m22:28:09.671813 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:28:09.673878 [debug] [MainThread]: Command end result
[0m22:28:09.690900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:28:09.690900 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:28:09.690900 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:28:09.690900 [debug] [MainThread]: Command `dbt run` succeeded at 22:28:09.690900 after 0.85 seconds
[0m22:28:09.690900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CE0903A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CF128FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288CE112920>]}
[0m22:28:09.690900 [debug] [MainThread]: Flushing usage events
[0m22:28:10.430714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:00.167340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6DC0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8BF3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8BF3F70>]}


============================== 22:30:00.171391 | 120470f8-ed94-4d04-ace7-7adf1560c0f2 ==============================
[0m22:30:00.171391 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:30:00.173282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_campiagn', 'send_anonymous_usage_stats': 'True'}
[0m22:30:00.347278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '120470f8-ed94-4d04-ace7-7adf1560c0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8D17EE0>]}
[0m22:30:00.393277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '120470f8-ed94-4d04-ace7-7adf1560c0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8D83430>]}
[0m22:30:00.395286 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:00.614062 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:30:00.755057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:00.756085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:00.761072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:30:00.791054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '120470f8-ed94-4d04-ace7-7adf1560c0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C91DC130>]}
[0m22:30:00.848191 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:30:00.863944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:30:00.896358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '120470f8-ed94-4d04-ace7-7adf1560c0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C91DE350>]}
[0m22:30:00.896358 [info ] [MainThread]: Found 7 models, 2 sources, 433 macros
[0m22:30:00.896358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120470f8-ed94-4d04-ace7-7adf1560c0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C9016AD0>]}
[0m22:30:00.896358 [warn ] [MainThread]: The selection criterion 'dim_campiagn' does not match any enabled nodes
[0m22:30:00.896358 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:30:00.896358 [debug] [MainThread]: Command end result
[0m22:30:00.924204 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:30:00.927214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:30:00.931213 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:30:00.932200 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:00.932200 after 0.83 seconds
[0m22:30:00.933224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6DC0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C91B78E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8D141C0>]}
[0m22:30:00.934216 [debug] [MainThread]: Flushing usage events
[0m22:30:01.629019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:03.422774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522FEC42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015230D23B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015230D23F40>]}


============================== 22:32:03.426772 | 7f29e469-cdf0-49b2-9745-9e8d8ffa7e55 ==============================
[0m22:32:03.426772 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:32:03.428773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_campiagn', 'send_anonymous_usage_stats': 'True'}
[0m22:32:03.609787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f29e469-cdf0-49b2-9745-9e8d8ffa7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015230E26C20>]}
[0m22:32:03.661955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f29e469-cdf0-49b2-9745-9e8d8ffa7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015230E4A110>]}
[0m22:32:03.663941 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:32:03.905753 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:32:04.073545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:32:04.074545 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_campaign.sql
[0m22:32:04.310466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:32:04.326463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f29e469-cdf0-49b2-9745-9e8d8ffa7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001523149C0D0>]}
[0m22:32:04.409866 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:32:04.413814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:32:04.450782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f29e469-cdf0-49b2-9745-9e8d8ffa7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001523149D270>]}
[0m22:32:04.451782 [info ] [MainThread]: Found 8 models, 2 sources, 433 macros
[0m22:32:04.452829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f29e469-cdf0-49b2-9745-9e8d8ffa7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001523149D480>]}
[0m22:32:04.453797 [warn ] [MainThread]: The selection criterion 'dim_campiagn' does not match any enabled nodes
[0m22:32:04.454510 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:32:04.455766 [debug] [MainThread]: Command end result
[0m22:32:04.523855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:32:04.525864 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:32:04.528866 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:32:04.530859 [debug] [MainThread]: Command `dbt run` succeeded at 22:32:04.530859 after 1.18 seconds
[0m22:32:04.530859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522FEC42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152314E8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152314E82B0>]}
[0m22:32:04.531876 [debug] [MainThread]: Flushing usage events
[0m22:32:05.239282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:33:20.671976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E18803D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E36B3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E36B3DC0>]}


============================== 22:33:20.675953 | 8bd91684-4462-451e-a167-37c141901576 ==============================
[0m22:33:20.675953 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:33:20.677953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_campaign', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:33:20.866091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E37D8EB0>]}
[0m22:33:20.923092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E36BCC70>]}
[0m22:33:20.924092 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:33:21.169059 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:33:21.363252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:21.363252 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_campaign.sql
[0m22:33:21.590970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:33:21.603966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E3C9CB20>]}
[0m22:33:21.676968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:33:21.682056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:33:21.718064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E4DFDC60>]}
[0m22:33:21.718968 [info ] [MainThread]: Found 8 models, 2 sources, 433 macros
[0m22:33:21.719969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E4DFC340>]}
[0m22:33:21.720970 [info ] [MainThread]: 
[0m22:33:21.721970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:33:21.722968 [info ] [MainThread]: 
[0m22:33:21.723967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:33:21.725003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:33:21.861966 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:33:21.862968 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:33:21.863967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:22.009433 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.145 seconds
[0m22:33:22.011422 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:33:22.017423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:33:22.023455 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:33:22.023455 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:33:22.023455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:22.059429 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m22:33:22.059429 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:33:22.059429 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:33:22.065429 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m22:33:22.066458 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:33:22.067459 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:33:22.072452 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:22.073463 [debug] [MainThread]: On master: BEGIN
[0m22:33:22.074432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:22.210539 [debug] [MainThread]: SQL status: BEGIN in 0.136 seconds
[0m22:33:22.210539 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:22.211546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:33:22.220035 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m22:33:22.221131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E3A9D750>]}
[0m22:33:22.221131 [debug] [MainThread]: On master: ROLLBACK
[0m22:33:22.222167 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:22.222167 [debug] [MainThread]: On master: BEGIN
[0m22:33:22.223150 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:33:22.224134 [debug] [MainThread]: On master: COMMIT
[0m22:33:22.224134 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:22.224134 [debug] [MainThread]: On master: COMMIT
[0m22:33:22.225135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:22.225135 [debug] [MainThread]: On master: Close
[0m22:33:22.231219 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m22:33:22.231219 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_campaign .................................. [RUN]
[0m22:33:22.233226 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m22:33:22.233388 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m22:33:22.233388 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m22:33:22.233388 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m22:33:22.282274 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m22:33:22.286276 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m22:33:22.287278 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m22:33:22.288274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:33:22.429737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m22:33:22.430738 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m22:33:22.430738 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m22:33:22.456737 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.026 seconds
[0m22:33:22.465736 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m22:33:22.466736 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m22:33:22.467861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:33:22.478831 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m22:33:22.479828 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m22:33:22.479828 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m22:33:22.482847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:33:22.488736 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m22:33:22.491736 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m22:33:22.491736 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m22:33:22.492736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:33:22.494736 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m22:33:22.497738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd91684-4462-451e-a167-37c141901576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261DFBD7490>]}
[0m22:33:22.498737 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_campaign ............................. [[32mSELECT 1481[0m in 0.26s]
[0m22:33:22.499102 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m22:33:22.499102 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:22.499102 [debug] [MainThread]: On master: BEGIN
[0m22:33:22.499102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:22.534969 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m22:33:22.534969 [debug] [MainThread]: On master: COMMIT
[0m22:33:22.534969 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:22.534969 [debug] [MainThread]: On master: COMMIT
[0m22:33:22.534969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:22.534969 [debug] [MainThread]: On master: Close
[0m22:33:22.534969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:22.534969 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:33:22.534969 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:33:22.534969 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_campaign' was properly closed.
[0m22:33:22.534969 [info ] [MainThread]: 
[0m22:33:22.534969 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:33:22.534969 [debug] [MainThread]: Command end result
[0m22:33:22.565901 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:33:22.570828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:33:22.576907 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:33:22.577856 [info ] [MainThread]: 
[0m22:33:22.578904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:33:22.578904 [info ] [MainThread]: 
[0m22:33:22.579816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:33:22.580857 [debug] [MainThread]: Command `dbt run` succeeded at 22:33:22.580857 after 1.99 seconds
[0m22:33:22.581895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E18803D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E3C241F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E3868910>]}
[0m22:33:22.581895 [debug] [MainThread]: Flushing usage events
[0m22:33:23.283773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:35:13.767870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023031970370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230327E3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230327E3F70>]}


============================== 22:35:13.767870 | e4f622f3-d327-4e1c-a5fd-fa064e7f3acb ==============================
[0m22:35:13.767870 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:35:13.767870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_lead_type', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:35:13.936433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032907EE0>]}
[0m22:35:13.982432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032977430>]}
[0m22:35:13.983918 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:35:14.205978 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:35:14.379414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:35:14.379414 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_lead_type.sql
[0m22:35:14.588780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:35:14.601882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032F60130>]}
[0m22:35:14.673856 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:35:14.676812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:35:14.706850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303011A680>]}
[0m22:35:14.707893 [info ] [MainThread]: Found 9 models, 2 sources, 433 macros
[0m22:35:14.708839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303011A5C0>]}
[0m22:35:14.709898 [info ] [MainThread]: 
[0m22:35:14.710894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:14.711815 [info ] [MainThread]: 
[0m22:35:14.712811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:14.713815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:35:14.838830 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:35:14.838830 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:35:14.838830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:14.883843 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.045 seconds
[0m22:35:14.884893 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:35:14.890827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:35:14.894899 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:35:14.895935 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:35:14.895935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:14.929710 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m22:35:14.929710 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:35:14.929710 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:35:14.945178 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m22:35:14.945178 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:35:14.945178 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:35:14.945178 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:14.945178 [debug] [MainThread]: On master: BEGIN
[0m22:35:14.945178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:14.993533 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m22:35:14.993533 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:14.994621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:15.002531 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m22:35:15.003623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002302EB8A0E0>]}
[0m22:35:15.003623 [debug] [MainThread]: On master: ROLLBACK
[0m22:35:15.004627 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:15.004627 [debug] [MainThread]: On master: BEGIN
[0m22:35:15.005591 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:35:15.005591 [debug] [MainThread]: On master: COMMIT
[0m22:35:15.006634 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:15.006634 [debug] [MainThread]: On master: COMMIT
[0m22:35:15.007575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:35:15.007575 [debug] [MainThread]: On master: Close
[0m22:35:15.013534 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m22:35:15.013534 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_lead_type ................................. [RUN]
[0m22:35:15.014621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_lead_type'
[0m22:35:15.015625 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m22:35:15.022619 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m22:35:15.023561 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m22:35:15.064615 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m22:35:15.066532 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m22:35:15.066532 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m22:35:15.067548 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:35:15.102532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m22:35:15.103612 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m22:35:15.103612 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m22:35:15.124531 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.020 seconds
[0m22:35:15.133621 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m22:35:15.134618 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m22:35:15.135533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:35:15.148533 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m22:35:15.148533 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m22:35:15.148533 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m22:35:15.150595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:35:15.157531 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m22:35:15.160619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m22:35:15.161647 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m22:35:15.162533 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:35:15.163619 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m22:35:15.166549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f622f3-d327-4e1c-a5fd-fa064e7f3acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002302F4D7430>]}
[0m22:35:15.167534 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_lead_type ............................ [[32mSELECT 10[0m in 0.15s]
[0m22:35:15.168532 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m22:35:15.170572 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:15.170572 [debug] [MainThread]: On master: BEGIN
[0m22:35:15.170572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:15.209550 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m22:35:15.210552 [debug] [MainThread]: On master: COMMIT
[0m22:35:15.210552 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:15.211417 [debug] [MainThread]: On master: COMMIT
[0m22:35:15.211417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:35:15.211417 [debug] [MainThread]: On master: Close
[0m22:35:15.211417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:15.211417 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:35:15.211417 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:35:15.211417 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_lead_type' was properly closed.
[0m22:35:15.211417 [info ] [MainThread]: 
[0m22:35:15.211417 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m22:35:15.211417 [debug] [MainThread]: Command end result
[0m22:35:15.237679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:35:15.239757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:35:15.246689 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:35:15.247683 [info ] [MainThread]: 
[0m22:35:15.248713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:15.249678 [info ] [MainThread]: 
[0m22:35:15.250320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:35:15.251419 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:15.251419 after 1.55 seconds
[0m22:35:15.251419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023031970370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032D3FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032D3FB80>]}
[0m22:35:15.252430 [debug] [MainThread]: Flushing usage events
[0m22:35:15.960997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:14.221907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C1FB03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C2E13BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C2E13DC0>]}


============================== 22:36:14.226957 | af4da458-4c2f-4deb-b0ae-ed92e773a09a ==============================
[0m22:36:14.226957 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:36:14.229908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_lead_source', 'send_anonymous_usage_stats': 'True'}
[0m22:36:14.409829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af4da458-4c2f-4deb-b0ae-ed92e773a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C2F38EB0>]}
[0m22:36:14.455829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af4da458-4c2f-4deb-b0ae-ed92e773a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C2E18C70>]}
[0m22:36:14.457860 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:36:14.677632 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:36:14.862621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:14.863252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:14.869540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:36:14.901511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af4da458-4c2f-4deb-b0ae-ed92e773a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C34003A0>]}
[0m22:36:14.971325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:36:14.975335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:36:15.006321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af4da458-4c2f-4deb-b0ae-ed92e773a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C3403580>]}
[0m22:36:15.007321 [info ] [MainThread]: Found 9 models, 2 sources, 433 macros
[0m22:36:15.008321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af4da458-4c2f-4deb-b0ae-ed92e773a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C3401270>]}
[0m22:36:15.008321 [warn ] [MainThread]: The selection criterion 'dim_lead_source' does not match any enabled nodes
[0m22:36:15.010357 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:36:15.012420 [debug] [MainThread]: Command end result
[0m22:36:15.033407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:36:15.036322 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:36:15.040326 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:36:15.041322 [debug] [MainThread]: Command `dbt run` succeeded at 22:36:15.040326 after 0.90 seconds
[0m22:36:15.041322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C1FB03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C2031030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C3443B50>]}
[0m22:36:15.041322 [debug] [MainThread]: Flushing usage events
[0m22:36:15.646481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:44.707675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C2403D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D0A3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D0A3DC0>]}


============================== 22:36:44.710776 | 691e6545-0f8c-41df-b4d0-8344b01c0bd6 ==============================
[0m22:36:44.710776 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:36:44.712677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_lead_source', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:36:44.859956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D1C4EB0>]}
[0m22:36:44.918760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D0A8C70>]}
[0m22:36:44.919771 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:36:45.146692 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:36:45.287592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:36:45.288593 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\dim_lead_source.sql
[0m22:36:45.508817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m22:36:45.524547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D820130>]}
[0m22:36:45.611584 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:36:45.615202 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:36:45.646208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D822AD0>]}
[0m22:36:45.647179 [info ] [MainThread]: Found 10 models, 2 sources, 433 macros
[0m22:36:45.648183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024A9EA5F0>]}
[0m22:36:45.649261 [info ] [MainThread]: 
[0m22:36:45.650180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:45.650180 [info ] [MainThread]: 
[0m22:36:45.651193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:45.653179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m22:36:45.791659 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m22:36:45.791659 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m22:36:45.791659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:45.838701 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m22:36:45.839700 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m22:36:45.844714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m22:36:45.849712 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:36:45.849712 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m22:36:45.850712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:45.883572 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m22:36:45.883572 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m22:36:45.883572 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m22:36:45.883572 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m22:36:45.883572 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m22:36:45.883572 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m22:36:45.899197 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:45.899197 [debug] [MainThread]: On master: BEGIN
[0m22:36:45.899197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:45.940208 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m22:36:45.940208 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:45.941217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:36:45.949208 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m22:36:45.950290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D822110>]}
[0m22:36:45.951298 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:45.951298 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:45.952308 [debug] [MainThread]: On master: BEGIN
[0m22:36:45.953208 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:36:45.953208 [debug] [MainThread]: On master: COMMIT
[0m22:36:45.953208 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:45.954300 [debug] [MainThread]: On master: COMMIT
[0m22:36:45.954300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:36:45.955254 [debug] [MainThread]: On master: Close
[0m22:36:45.961215 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m22:36:45.962304 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_lead_source ............................... [RUN]
[0m22:36:45.963244 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_lead_source'
[0m22:36:45.963244 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m22:36:45.969297 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m22:36:45.971210 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m22:36:46.005111 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m22:36:46.007027 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m22:36:46.008020 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m22:36:46.008020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:46.045913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m22:36:46.045913 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m22:36:46.046964 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m22:36:46.067965 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.021 seconds
[0m22:36:46.076876 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m22:36:46.076876 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m22:36:46.077970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:36:46.098877 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m22:36:46.099876 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m22:36:46.100877 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m22:36:46.102877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:36:46.111876 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m22:36:46.116878 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m22:36:46.116878 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m22:36:46.117876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:36:46.120876 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m22:36:46.124876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '691e6545-0f8c-41df-b4d0-8344b01c0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020249DA7490>]}
[0m22:36:46.125877 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_lead_source .......................... [[32mSELECT 95[0m in 0.16s]
[0m22:36:46.126877 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m22:36:46.128876 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:46.129903 [debug] [MainThread]: On master: BEGIN
[0m22:36:46.129903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:46.167966 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m22:36:46.167966 [debug] [MainThread]: On master: COMMIT
[0m22:36:46.168954 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:46.168954 [debug] [MainThread]: On master: COMMIT
[0m22:36:46.168954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:36:46.169971 [debug] [MainThread]: On master: Close
[0m22:36:46.169971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:46.169971 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m22:36:46.170879 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m22:36:46.170879 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_lead_source' was properly closed.
[0m22:36:46.170879 [info ] [MainThread]: 
[0m22:36:46.171926 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:36:46.172877 [debug] [MainThread]: Command end result
[0m22:36:46.191147 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m22:36:46.194149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m22:36:46.200453 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m22:36:46.201182 [info ] [MainThread]: 
[0m22:36:46.201182 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:36:46.201182 [info ] [MainThread]: 
[0m22:36:46.201182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:36:46.201182 [debug] [MainThread]: Command `dbt run` succeeded at 22:36:46.201182 after 1.57 seconds
[0m22:36:46.201182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C2403D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D61EFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C2C0250>]}
[0m22:36:46.201182 [debug] [MainThread]: Flushing usage events
[0m22:36:46.876116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:58.201133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F05C0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F1423BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F1423F70>]}


============================== 22:59:58.204193 | 4fa2c584-9d87-4a65-826e-0c811d51ae4a ==============================
[0m22:59:58.204193 [info ] [MainThread]: Running with dbt=1.9.5
[0m22:59:58.206100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:59:58.367896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fa2c584-9d87-4a65-826e-0c811d51ae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F1547EE0>]}
[0m22:59:58.419325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fa2c584-9d87-4a65-826e-0c811d51ae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F15B7430>]}
[0m22:59:58.421492 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:59:58.643724 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m22:59:58.815674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:59:58.815674 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\fact_sales.sql
[0m22:59:58.973322 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_sales' (models\marts\fact_sales.sql) depends on a node named 'dim_property' which was not found
[0m22:59:58.974239 [debug] [MainThread]: Command `dbt run` failed at 22:59:58.974239 after 0.85 seconds
[0m22:59:58.975274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F05C0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F1403D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F1B41F60>]}
[0m22:59:58.975274 [debug] [MainThread]: Flushing usage events
[0m22:59:59.685853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:36.828775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348FD34310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023490B93BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023490B93F40>]}


============================== 23:00:36.832778 | 7dc9eb4b-224a-4a3f-8859-b68c4d037df5 ==============================
[0m23:00:36.832778 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:00:36.834739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m23:00:37.002739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dc9eb4b-224a-4a3f-8859-b68c4d037df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023490CB7100>]}
[0m23:00:37.061867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dc9eb4b-224a-4a3f-8859-b68c4d037df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234904FEC50>]}
[0m23:00:37.061867 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:37.281105 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:00:37.434104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:00:37.434104 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\fact_sales.sql
[0m23:00:37.585031 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_sales' (models\marts\fact_sales.sql) depends on a node named 'dim_location' which was not found
[0m23:00:37.586948 [debug] [MainThread]: Command `dbt run` failed at 23:00:37.586948 after 0.83 seconds
[0m23:00:37.586948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348FD34310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349053BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234912B1F60>]}
[0m23:00:37.587947 [debug] [MainThread]: Flushing usage events
[0m23:00:38.174032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:31.498568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA2C00340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA4A33B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA4A33FD0>]}


============================== 23:03:31.503568 | bdc98760-5b35-4e2f-83a1-831073a0aaa6 ==============================
[0m23:03:31.503568 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:03:31.504568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:03:31.670784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA4B5ADA0>]}
[0m23:03:31.709955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA4A66590>]}
[0m23:03:31.709955 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:03:31.952451 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:03:32.110650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:03:32.110650 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\fact_sales.sql
[0m23:03:32.325824 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:03:32.339863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA6180640>]}
[0m23:03:32.410830 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:03:32.414927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:03:32.446821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA61803D0>]}
[0m23:03:32.447823 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:03:32.448883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA6182BC0>]}
[0m23:03:32.449973 [info ] [MainThread]: 
[0m23:03:32.451296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:32.452305 [info ] [MainThread]: 
[0m23:03:32.453358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:03:32.454461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:03:32.582860 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:03:32.582860 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:03:32.583860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:32.627234 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m23:03:32.627234 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:03:32.627234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:03:32.627234 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:03:32.627234 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:03:32.627234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:32.678234 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m23:03:32.678234 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:03:32.679317 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:03:32.685239 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:03:32.686328 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:03:32.687281 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:03:32.693246 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:32.694242 [debug] [MainThread]: On master: BEGIN
[0m23:03:32.694242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:32.731647 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:03:32.732681 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:32.732681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:03:32.741732 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:03:32.742768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA4FD0910>]}
[0m23:03:32.743735 [debug] [MainThread]: On master: ROLLBACK
[0m23:03:32.743735 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:32.744649 [debug] [MainThread]: On master: BEGIN
[0m23:03:32.744649 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:03:32.745713 [debug] [MainThread]: On master: COMMIT
[0m23:03:32.745713 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:32.746729 [debug] [MainThread]: On master: COMMIT
[0m23:03:32.747417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:32.747417 [debug] [MainThread]: On master: Close
[0m23:03:32.752426 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:03:32.753436 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_sales .................................... [RUN]
[0m23:03:32.754433 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.fact_sales'
[0m23:03:32.754433 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:03:32.761512 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:03:32.763460 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:03:32.797519 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:03:32.799522 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:03:32.800450 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:03:32.800450 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:03:32.954722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m23:03:32.955723 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:03:32.955723 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
   
    s.id AS sale_id,
    s.lead_id, -- This will also act as FK to fact_leads.lead_id

    -- Foreign Keys to Date Dimension
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- Foreign Keys to other Dimensions (using natural keys for join, then getting surrogate key)
    -- dim_property
    dp.property_id AS property_id, -- This is the surrogate key from dim_property
    -- dim_sale_category
    dsc.category_id AS sale_category_id,
    -- dim_location
    dl.location_id AS location_id,

    -- Degenerate Dimensions (Attributes directly on Fact table)
    s.area_id,    -- As per your schema, these are directly on fact_sales
    s.compound_id, -- As per your schema, these are directly on fact_sales

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2) as agreed
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys
-- Note: We are joining directly to the source table here, assuming your dim models
-- will generate the surrogate keys based on the natural keys.

-- dim_property
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dp
    ON s.property_type = dp.property_type -- Assuming property_type in source maps to property_type in dim_property

-- dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.category_name

-- dim_location (Assuming dim_location has location_name derived from unit_location)
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dl
    ON s.unit_location = dl.location_name -- This join needs careful standardization of unit_location in staging/dim_location

WHERE s.id IS NOT NULL
  );
  
[0m23:03:32.958723 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dp.property_type does not exist
LINE 53:     ON s.property_type = dp.property_type -- Assuming proper...
                                  ^
HINT:  Perhaps you meant to reference the column "s.property_type".

[0m23:03:32.959725 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:03:32.960722 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:03:32.964722 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dp.property_type does not exist
  LINE 53:     ON s.property_type = dp.property_type -- Assuming proper...
                                    ^
  HINT:  Perhaps you meant to reference the column "s.property_type".
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:03:32.967762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc98760-5b35-4e2f-83a1-831073a0aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA27C8BE0>]}
[0m23:03:32.968802 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.fact_sales ........................... [[31mERROR[0m in 0.21s]
[0m23:03:32.969779 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:03:32.970380 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dp.property_type does not exist
  LINE 53:     ON s.property_type = dp.property_type -- Assuming proper...
                                    ^
  HINT:  Perhaps you meant to reference the column "s.property_type".
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:03:32.971625 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:32.971625 [debug] [MainThread]: On master: BEGIN
[0m23:03:32.972719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:33.014134 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m23:03:33.014134 [debug] [MainThread]: On master: COMMIT
[0m23:03:33.015050 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:33.015050 [debug] [MainThread]: On master: COMMIT
[0m23:03:33.016102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:33.016102 [debug] [MainThread]: On master: Close
[0m23:03:33.016102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:33.016102 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:03:33.017168 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:03:33.017168 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:03:33.018132 [info ] [MainThread]: 
[0m23:03:33.019051 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m23:03:33.020055 [debug] [MainThread]: Command end result
[0m23:03:33.040055 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:03:33.042066 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:03:33.051059 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:03:33.051059 [info ] [MainThread]: 
[0m23:03:33.052106 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:03:33.052106 [info ] [MainThread]: 
[0m23:03:33.053400 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dp.property_type does not exist
  LINE 53:     ON s.property_type = dp.property_type -- Assuming proper...
                                    ^
  HINT:  Perhaps you meant to reference the column "s.property_type".
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:03:33.054068 [info ] [MainThread]: 
[0m23:03:33.054946 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:03:33.055476 [debug] [MainThread]: Command `dbt run` failed at 23:03:33.055476 after 1.63 seconds
[0m23:03:33.056559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA2C00340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA4A303A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA3C99930>]}
[0m23:03:33.056559 [debug] [MainThread]: Flushing usage events
[0m23:03:33.782420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:19.706892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029481D60370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029482CF0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029482CF0580>]}


============================== 23:04:19.711984 | 4090be20-9c36-48cf-8806-42f8b62342ee ==============================
[0m23:04:19.711984 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:04:19.712969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:04:19.893044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029482DCEA40>]}
[0m23:04:19.942042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948252DD50>]}
[0m23:04:19.944062 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:04:20.164452 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:04:20.346848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:04:20.347845 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_property_type.sql
[0m23:04:20.577500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:04:20.591589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948344FE50>]}
[0m23:04:20.668710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:04:20.673218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:04:20.708413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948344CCA0>]}
[0m23:04:20.708413 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:04:20.709403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948324C9A0>]}
[0m23:04:20.711408 [info ] [MainThread]: 
[0m23:04:20.712407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:20.713411 [info ] [MainThread]: 
[0m23:04:20.714416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:20.719423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:04:20.868420 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:04:20.869428 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:04:20.869428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:20.919531 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m23:04:20.920620 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:04:20.922533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:04:20.929532 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:04:20.929532 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:04:20.930535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:21.085115 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m23:04:21.086205 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:04:21.086205 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:04:21.087398 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:04:21.087398 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:04:21.087398 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:04:21.096401 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:21.096401 [debug] [MainThread]: On master: BEGIN
[0m23:04:21.096401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:21.129647 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:04:21.129647 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:21.129647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:04:21.154602 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:04:21.155680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029483296AA0>]}
[0m23:04:21.156687 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:21.156687 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:21.157699 [debug] [MainThread]: On master: BEGIN
[0m23:04:21.157699 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:04:21.158694 [debug] [MainThread]: On master: COMMIT
[0m23:04:21.158694 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:21.158694 [debug] [MainThread]: On master: COMMIT
[0m23:04:21.159602 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:21.159602 [debug] [MainThread]: On master: Close
[0m23:04:21.166603 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:04:21.166603 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:04:21.167604 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:04:21.167604 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:04:21.174692 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:04:21.175700 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:04:21.211604 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:04:21.213607 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:04:21.215605 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:04:21.215605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:21.255809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:04:21.255809 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:04:21.255809 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:04:21.297205 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.040 seconds
[0m23:04:21.306204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:04:21.307204 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:04:21.308205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.311204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:04:21.311204 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:04:21.312204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.326297 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:04:21.327283 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:04:21.327283 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:04:21.329205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:21.336205 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:04:21.339207 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:04:21.340207 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:04:21.345247 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:04:21.349203 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:04:21.352213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029482E62A70>]}
[0m23:04:21.353205 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.18s]
[0m23:04:21.354206 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:04:21.355207 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:04:21.355207 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:04:21.356205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:04:21.356205 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:04:21.359207 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:04:21.360208 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:04:21.365208 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:04:21.366207 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:04:21.367208 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:04:21.367208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.410917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:04:21.410917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:04:21.411936 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:04:21.423817 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.012 seconds
[0m23:04:21.426937 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:04:21.426937 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:04:21.427910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:21.433902 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:04:21.433902 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:04:21.434909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.435857 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:04:21.436860 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:04:21.436860 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:04:21.439945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:04:21.442898 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:04:21.442898 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:04:21.443906 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:04:21.449818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m23:04:21.451906 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:04:21.451906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029483294730>]}
[0m23:04:21.452921 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.10s]
[0m23:04:21.453820 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:04:21.454818 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:04:21.454818 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:04:21.455831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:04:21.456906 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:04:21.459906 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:04:21.460903 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:04:21.466911 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:04:21.467912 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:04:21.468916 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:04:21.468916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.511819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:04:21.511819 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:04:21.512859 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:04:21.536912 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.024 seconds
[0m23:04:21.539897 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:04:21.540898 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:04:21.541818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.544821 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:04:21.544821 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:04:21.545818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.546850 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:04:21.546850 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:04:21.546850 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:04:21.546850 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:21.546850 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:04:21.546850 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:04:21.546850 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:04:21.546850 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:04:21.562475 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:04:21.563684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294849758D0>]}
[0m23:04:21.564129 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.11s]
[0m23:04:21.564129 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:04:21.564129 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:04:21.564129 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:04:21.564129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:04:21.564129 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:04:21.564129 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:04:21.564129 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:04:21.564129 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:04:21.580037 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:04:21.580037 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:04:21.581128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.622838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:04:21.622838 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:04:21.622838 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:04:21.645746 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.022 seconds
[0m23:04:21.648829 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:04:21.648829 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:04:21.649852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:21.652785 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:04:21.652785 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:04:21.653815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:21.654745 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:04:21.655745 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:04:21.655745 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:04:21.658751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:21.660859 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:04:21.660859 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:04:21.661836 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:04:21.664851 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:04:21.665842 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:04:21.666778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948095BB50>]}
[0m23:04:21.667749 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.10s]
[0m23:04:21.668765 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:04:21.669797 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:04:21.669797 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:04:21.670768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:04:21.671746 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:04:21.673824 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.675836 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:04:21.679839 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.680746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.681749 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:04:21.681749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.723823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:04:21.723823 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.724855 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:04:21.745746 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.021 seconds
[0m23:04:21.749841 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.749841 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:04:21.750746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.752850 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.753831 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:04:21.754746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.755830 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:04:21.755830 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.755830 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:04:21.758871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:21.761830 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:04:21.762748 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:04:21.762748 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:04:21.766790 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:04:21.767835 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:04:21.768835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948095BB50>]}
[0m23:04:21.769746 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m23:04:21.770745 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:04:21.770745 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:04:21.771784 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:04:21.772746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:04:21.772746 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:04:21.775852 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:04:21.776836 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:04:21.780832 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:04:21.781840 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:04:21.782797 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:04:21.782797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.825872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:04:21.826828 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:04:21.826828 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:04:21.835778 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.008 seconds
[0m23:04:21.838840 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:04:21.838840 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:04:21.839825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:21.842832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:04:21.842832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:04:21.843836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:21.845746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:04:21.845746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:04:21.845746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:04:21.847844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:21.850852 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:04:21.850852 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:04:21.851832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:04:21.854831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:04:21.855844 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:04:21.855844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029484992410>]}
[0m23:04:21.856835 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m23:04:21.857782 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:04:21.858748 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:04:21.858748 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:04:21.859749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:04:21.859749 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:04:21.863829 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:04:21.864853 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:04:21.868871 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:04:21.869863 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:04:21.869863 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:04:21.870748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.909833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:04:21.909833 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:04:21.910824 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS sale_category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
) AS distinct_categories
  );
  
[0m23:04:21.918856 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m23:04:21.921852 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:04:21.922839 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:04:21.922839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:21.926747 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:04:21.926747 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:04:21.927831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:21.929756 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:04:21.929756 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:04:21.930745 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:04:21.932853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:21.934865 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:04:21.935871 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:04:21.935871 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:04:21.938833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:04:21.939859 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:04:21.940836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948095BB50>]}
[0m23:04:21.940836 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:04:21.942747 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:04:21.942747 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:04:21.942747 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:04:21.943779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:04:21.944787 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:04:21.948290 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:04:21.950294 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:04:21.953306 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:04:21.954244 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:04:21.955201 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:04:21.955201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:21.979638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:04:21.979638 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:04:21.979638 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location AS unit_location_name
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
) AS distinct_locations
  );
  
[0m23:04:22.004543 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.009 seconds
[0m23:04:22.007576 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:04:22.007576 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:04:22.008609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:22.011571 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:04:22.011571 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:04:22.013487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:22.015585 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:04:22.016526 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:04:22.016526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:04:22.018537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:22.020591 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:04:22.021570 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:04:22.021570 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:04:22.024485 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:04:22.025570 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:04:22.026570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294849392D0>]}
[0m23:04:22.027497 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.08s]
[0m23:04:22.028487 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:04:22.028487 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:04:22.029486 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:04:22.030486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:04:22.030486 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:04:22.033575 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:04:22.034592 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:04:22.038566 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:04:22.039541 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:04:22.039541 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:04:22.040487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:22.082486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:04:22.083486 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:04:22.083486 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:04:22.103569 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.019 seconds
[0m23:04:22.107602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:04:22.108486 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:04:22.108486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:22.111520 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:04:22.112487 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:04:22.113487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:22.114517 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:04:22.115518 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:04:22.115518 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:04:22.118488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:04:22.120578 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:04:22.121575 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:04:22.121575 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:04:22.124486 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:04:22.125577 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:04:22.126578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294849E0A30>]}
[0m23:04:22.127508 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.10s]
[0m23:04:22.128486 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:04:22.128486 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:04:22.129487 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:04:22.130486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:04:22.130486 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:04:22.132581 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:04:22.133581 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:04:22.152574 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:04:22.153589 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:04:22.154526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:04:22.154526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:22.195486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:04:22.195486 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:04:22.196571 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:04:22.202485 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:04:22.205580 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:04:22.205580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:04:22.206532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:22.209565 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:04:22.209565 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:04:22.209565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:04:22.211593 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:04:22.211593 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:04:22.212486 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:04:22.215584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:04:22.218576 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:04:22.220489 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:04:22.220489 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:04:22.222565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:04:22.223564 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:04:22.224575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948095BB50>]}
[0m23:04:22.224575 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:04:22.225489 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:04:22.226496 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:04:22.226496 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:04:22.227486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:04:22.228487 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:04:22.232488 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:04:22.233584 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:04:22.237568 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:04:22.238574 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:04:22.238574 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:04:22.239538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:22.278313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:04:22.279230 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:04:22.280231 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
   
    s.id AS sale_id,
    s.lead_id, -- This will also act as FK to fact_leads.lead_id

    -- Foreign Keys to Date Dimension
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- Foreign Keys to other Dimensions (using natural keys for join, then getting surrogate key)
    -- dim_property
    dp.property_id AS property_id, -- This is the surrogate key from dim_property
    -- dim_sale_category
    dsc.category_id AS sale_category_id,
    -- dim_location
    dl.location_id AS location_id,

    -- Degenerate Dimensions (Attributes directly on Fact table)
    s.area_id,    -- As per your schema, these are directly on fact_sales
    s.compound_id, -- As per your schema, these are directly on fact_sales

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2) as agreed
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys
-- Note: We are joining directly to the source table here, assuming your dim models
-- will generate the surrogate keys based on the natural keys.

-- dim_property
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dp
    ON s.property_type = dp.property_type -- Assuming property_type in source maps to property_type in dim_property

-- dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.category_name

-- dim_location (Assuming dim_location has location_name derived from unit_location)
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dl
    ON s.unit_location = dl.location_name -- This join needs careful standardization of unit_location in staging/dim_location

WHERE s.id IS NOT NULL
  );
  
[0m23:04:22.283252 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dsc.category_name does not exist
LINE 57:     ON s.sale_category = dsc.category_name
                                  ^

[0m23:04:22.283252 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:04:22.284317 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:04:22.288230 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_name does not exist
  LINE 57:     ON s.sale_category = dsc.category_name
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:04:22.289345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4090be20-9c36-48cf-8806-42f8b62342ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294848F0790>]}
[0m23:04:22.289345 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model dwh.fact_sales ......................... [[31mERROR[0m in 0.06s]
[0m23:04:22.290310 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:04:22.291230 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_name does not exist
  LINE 57:     ON s.sale_category = dsc.category_name
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:04:22.293420 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:22.293420 [debug] [MainThread]: On master: BEGIN
[0m23:04:22.293420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:22.335763 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m23:04:22.335763 [debug] [MainThread]: On master: COMMIT
[0m23:04:22.336869 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:22.336869 [debug] [MainThread]: On master: COMMIT
[0m23:04:22.337851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:22.337851 [debug] [MainThread]: On master: Close
[0m23:04:22.338763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:22.338763 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:04:22.338763 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:04:22.339775 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:04:22.339775 [info ] [MainThread]: 
[0m23:04:22.340803 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m23:04:22.342892 [debug] [MainThread]: Command end result
[0m23:04:22.366770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:04:22.369762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:04:22.376769 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:04:22.377764 [info ] [MainThread]: 
[0m23:04:22.378774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:04:22.378774 [info ] [MainThread]: 
[0m23:04:22.379766 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_name does not exist
  LINE 57:     ON s.sale_category = dsc.category_name
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:04:22.380763 [info ] [MainThread]: 
[0m23:04:22.381763 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:04:22.383767 [debug] [MainThread]: Command `dbt run` failed at 23:04:22.383767 after 2.75 seconds
[0m23:04:22.383767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029481D60370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294832724A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294849E08E0>]}
[0m23:04:22.384765 [debug] [MainThread]: Flushing usage events
[0m23:04:23.123635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:20.032782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492A7B03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492C5E3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492C5E3DC0>]}


============================== 23:11:20.036863 | 1974f49d-513c-4f3f-8f59-f6f78a52786e ==============================
[0m23:11:20.036863 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:11:20.038821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_sales', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:11:20.213279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492C708EB0>]}
[0m23:11:20.260561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492C5E8C70>]}
[0m23:11:20.262481 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:11:20.489820 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:11:20.657724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:11:20.657724 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_sale_category.sql
[0m23:11:20.658725 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_sales_location.sql
[0m23:11:20.865841 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:11:20.865841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492DD30B50>]}
[0m23:11:20.951594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:11:20.955600 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:11:20.987491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492DD32140>]}
[0m23:11:20.987491 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:11:20.988524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492CB60D30>]}
[0m23:11:20.989490 [info ] [MainThread]: 
[0m23:11:20.990570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:20.991488 [info ] [MainThread]: 
[0m23:11:20.992506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:20.993528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:11:21.116487 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:11:21.116487 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:11:21.117487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:21.163489 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m23:11:21.164599 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:11:21.169918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:11:21.176953 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:11:21.177948 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:11:21.178948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:21.215256 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:11:21.215256 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:11:21.215256 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:11:21.215256 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:11:21.215256 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:11:21.215256 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:11:21.231069 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:21.231069 [debug] [MainThread]: On master: BEGIN
[0m23:11:21.232155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:21.268078 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m23:11:21.268078 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:21.269068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:21.278158 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:11:21.279156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249289A6050>]}
[0m23:11:21.279156 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:21.280161 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:21.280161 [debug] [MainThread]: On master: BEGIN
[0m23:11:21.281177 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:11:21.281177 [debug] [MainThread]: On master: COMMIT
[0m23:11:21.281177 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:21.282095 [debug] [MainThread]: On master: COMMIT
[0m23:11:21.282095 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:21.282095 [debug] [MainThread]: On master: Close
[0m23:11:21.288071 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:11:21.289152 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_sales .................................... [RUN]
[0m23:11:21.290071 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.fact_sales'
[0m23:11:21.290071 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:11:21.298163 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:11:21.300069 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:11:21.332920 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:11:21.334819 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:11:21.334819 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:11:21.334819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:21.372936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:11:21.373892 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:11:21.373892 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
   
    s.id AS sale_id,
    s.lead_id, -- This will also act as FK to fact_leads.lead_id

    -- Foreign Keys to Date Dimension
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- Foreign Keys to other Dimensions (using natural keys for join, then getting surrogate key)
    -- dim_property
    dp.property_id AS property_id, -- This is the surrogate key from dim_property
    -- dim_sale_category
    dsc.category_id AS sale_category_id,
    -- dim_location
    dl.location_id AS location_id,

    -- Degenerate Dimensions (Attributes directly on Fact table)
    s.area_id,    -- As per your schema, these are directly on fact_sales
    s.compound_id, -- As per your schema, these are directly on fact_sales

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2) as agreed
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys
-- Note: We are joining directly to the source table here, assuming your dim models
-- will generate the surrogate keys based on the natural keys.

-- dim_property
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dp
    ON s.property_type = dp.property_type -- Assuming property_type in source maps to property_type in dim_property

-- dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.category_name

-- dim_location (Assuming dim_location has location_name derived from unit_location)
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dl
    ON s.unit_location = dl.location_name -- This join needs careful standardization of unit_location in staging/dim_location

WHERE s.id IS NOT NULL
  );
  
[0m23:11:21.374923 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dsc.category_name does not exist
LINE 57:     ON s.sale_category = dsc.category_name
                                  ^

[0m23:11:21.375928 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:11:21.375928 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:11:21.380813 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_name does not exist
  LINE 57:     ON s.sale_category = dsc.category_name
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:11:21.383914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1974f49d-513c-4f3f-8f59-f6f78a52786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492A3F9930>]}
[0m23:11:21.384906 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.fact_sales ........................... [[31mERROR[0m in 0.09s]
[0m23:11:21.384906 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:11:21.385871 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_name does not exist
  LINE 57:     ON s.sale_category = dsc.category_name
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:11:21.387816 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:21.387816 [debug] [MainThread]: On master: BEGIN
[0m23:11:21.388816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:21.422568 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m23:11:21.422568 [debug] [MainThread]: On master: COMMIT
[0m23:11:21.422568 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:21.422568 [debug] [MainThread]: On master: COMMIT
[0m23:11:21.422568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:21.422568 [debug] [MainThread]: On master: Close
[0m23:11:21.422568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:21.422568 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:11:21.422568 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:11:21.422568 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:11:21.422568 [info ] [MainThread]: 
[0m23:11:21.422568 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m23:11:21.422568 [debug] [MainThread]: Command end result
[0m23:11:21.458375 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:11:21.461372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:11:21.466366 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:11:21.467383 [info ] [MainThread]: 
[0m23:11:21.468417 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:11:21.469478 [info ] [MainThread]: 
[0m23:11:21.470369 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_name does not exist
  LINE 57:     ON s.sale_category = dsc.category_name
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:11:21.470369 [info ] [MainThread]: 
[0m23:11:21.471369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:11:21.473450 [debug] [MainThread]: Command `dbt run` failed at 23:11:21.473450 after 1.51 seconds
[0m23:11:21.474445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492A7B03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492CB840A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492CA2DA50>]}
[0m23:11:21.474445 [debug] [MainThread]: Flushing usage events
[0m23:11:22.193328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:05.121181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A44700370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45557BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45557F70>]}


============================== 23:13:05.128271 | edaf97b6-6322-47f3-b378-1bfeace0871c ==============================
[0m23:13:05.128271 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:13:05.131182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:13:05.302597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A4565EA40>]}
[0m23:13:05.350928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A44ECDD50>]}
[0m23:13:05.352845 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:13:05.568905 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:13:05.751786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:05.751786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:05.768215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:13:05.799267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45B49090>]}
[0m23:13:05.868269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:13:05.872267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:13:05.904913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45ADF700>]}
[0m23:13:05.904913 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:13:05.905987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45ADF3A0>]}
[0m23:13:05.907862 [info ] [MainThread]: 
[0m23:13:05.908861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:05.908861 [info ] [MainThread]: 
[0m23:13:05.909860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:13:05.912105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:13:06.004990 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:13:06.006076 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:13:06.006076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:06.051089 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.045 seconds
[0m23:13:06.052068 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:13:06.054990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:13:06.060113 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:13:06.060113 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:13:06.061038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:06.101203 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m23:13:06.101203 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:13:06.101203 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:13:06.116700 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:13:06.116700 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:13:06.116700 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:13:06.116700 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:06.116700 [debug] [MainThread]: On master: BEGIN
[0m23:13:06.116700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:06.169558 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:13:06.170658 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:06.170658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:13:06.179810 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:13:06.180903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A456F3970>]}
[0m23:13:06.180903 [debug] [MainThread]: On master: ROLLBACK
[0m23:13:06.181900 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:06.181900 [debug] [MainThread]: On master: BEGIN
[0m23:13:06.182920 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:13:06.182920 [debug] [MainThread]: On master: COMMIT
[0m23:13:06.183893 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:06.183893 [debug] [MainThread]: On master: COMMIT
[0m23:13:06.183893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:13:06.184855 [debug] [MainThread]: On master: Close
[0m23:13:06.190494 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:13:06.191485 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:13:06.192480 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:13:06.192480 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:13:06.199587 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:13:06.200569 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:13:06.276559 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:13:06.277562 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:13:06.278482 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:13:06.278482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:06.317032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:13:06.318011 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:13:06.318011 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:13:06.348006 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.029 seconds
[0m23:13:06.357082 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:13:06.357082 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:13:06.358307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.360314 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:13:06.360314 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:13:06.361954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:06.375960 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:13:06.375960 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:13:06.376960 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:13:06.380436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:13:06.385441 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:13:06.388441 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:13:06.389441 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:13:06.392938 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:13:06.392938 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:13:06.392938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45FA17E0>]}
[0m23:13:06.392938 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.20s]
[0m23:13:06.392938 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:13:06.392938 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:13:06.392938 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:13:06.392938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:13:06.392938 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:13:06.392938 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:13:06.392938 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:13:06.413784 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:13:06.415707 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:13:06.415707 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:13:06.415707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:06.457098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:13:06.458181 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:13:06.458181 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:13:06.471096 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.012 seconds
[0m23:13:06.476104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:13:06.476104 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:13:06.477138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:06.480211 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:13:06.480211 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:13:06.481460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.482467 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:13:06.483467 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:13:06.483467 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:13:06.487213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:13:06.489295 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:13:06.490257 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:13:06.490257 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:13:06.496180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:13:06.497214 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:13:06.498258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A460B3910>]}
[0m23:13:06.499180 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.11s]
[0m23:13:06.500181 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:13:06.500181 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:13:06.501180 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:13:06.502194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:13:06.502194 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:13:06.505260 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:13:06.506258 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:13:06.510292 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:13:06.511290 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:13:06.512185 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:13:06.512185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:06.549648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:13:06.549648 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:13:06.549648 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:13:06.577082 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.022 seconds
[0m23:13:06.580114 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:13:06.581157 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:13:06.582076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.584168 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:13:06.584168 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:13:06.585176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.588161 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:13:06.588161 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:13:06.589187 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:13:06.590114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:13:06.593081 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:13:06.594163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:13:06.594163 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:13:06.597083 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:13:06.598171 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:13:06.599177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A460C0100>]}
[0m23:13:06.600092 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:13:06.601082 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:13:06.602082 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:13:06.602082 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:13:06.603086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:13:06.604170 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:13:06.606168 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:13:06.607182 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:13:06.613185 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:13:06.615143 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:13:06.616095 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:13:06.616095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:06.649199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:13:06.649199 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:13:06.649199 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:13:06.678421 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.022 seconds
[0m23:13:06.681511 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:13:06.681511 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:13:06.682509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.684502 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:13:06.685528 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:13:06.686422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.688502 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:13:06.688502 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:13:06.688502 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:13:06.692422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:13:06.694508 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:13:06.695518 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:13:06.695518 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:13:06.698420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:13:06.699514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:13:06.700539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A456825F0>]}
[0m23:13:06.701420 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.10s]
[0m23:13:06.702421 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:13:06.703420 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:13:06.703420 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:13:06.704433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:13:06.704433 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:13:06.708529 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.709422 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:13:06.713496 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.714487 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.714487 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:13:06.715509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:06.859788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m23:13:06.860783 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.860783 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:13:06.880691 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.019 seconds
[0m23:13:06.883668 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.883668 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:13:06.885007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.887020 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.887020 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:13:06.888020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:06.890115 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:13:06.891113 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.891113 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:13:06.894605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:13:06.896610 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:13:06.897610 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:13:06.897610 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:13:06.901611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:13:06.902610 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:13:06.902610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A460EEE90>]}
[0m23:13:06.903611 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.20s]
[0m23:13:06.904730 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:13:06.905613 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:13:06.905613 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:13:06.906611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:13:06.907611 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:13:06.910695 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:13:06.912621 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:13:06.915695 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:13:06.916693 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:13:06.917620 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:13:06.917620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:06.960263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:13:06.961250 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:13:06.962298 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:13:06.969872 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.008 seconds
[0m23:13:06.974969 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:13:06.974969 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:13:06.975878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:06.978958 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:13:06.978958 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:13:06.979957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:06.981877 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:13:06.981877 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:13:06.981877 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:13:06.983879 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:13:06.986957 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:13:06.986957 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:13:06.987964 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:13:06.990672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:13:06.991775 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:13:06.993128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A46104AC0>]}
[0m23:13:06.994142 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.09s]
[0m23:13:06.995129 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:13:06.995129 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:13:06.996128 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:13:06.997129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:13:06.997129 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:13:07.000211 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:13:07.001138 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:13:07.005220 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:13:07.006136 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:13:07.006136 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:13:07.007220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:07.044332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:13:07.044332 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:13:07.044332 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:13:07.044332 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:13:07.044332 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:13:07.044332 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:13:07.059942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:07.061741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:13:07.061741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:13:07.061741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:07.061741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:13:07.061741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:13:07.061741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:13:07.061741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:13:07.061741 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:13:07.061741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:13:07.061741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:13:07.077614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:13:07.077614 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:13:07.077614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A461905E0>]}
[0m23:13:07.077614 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:13:07.077614 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:13:07.077614 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:13:07.077614 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:13:07.077614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:13:07.077614 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:13:07.077614 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:13:07.077614 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:13:07.094456 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:13:07.096455 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:13:07.097466 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:13:07.098578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:07.141455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:13:07.142456 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:13:07.142456 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:13:07.153541 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.010 seconds
[0m23:13:07.157457 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:13:07.157457 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:13:07.158455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:07.161460 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:13:07.162455 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:13:07.163455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:07.165498 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:13:07.165498 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:13:07.165498 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:13:07.168496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:13:07.171543 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:13:07.172538 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:13:07.172538 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:13:07.176501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:13:07.177591 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:13:07.178503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A461905E0>]}
[0m23:13:07.179540 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.10s]
[0m23:13:07.180503 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:13:07.181503 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:13:07.182502 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:13:07.183503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:13:07.183503 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:13:07.186501 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:13:07.188502 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:13:07.194812 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:13:07.194987 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:13:07.194987 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:13:07.194987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:07.238969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:13:07.240067 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:13:07.240067 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:13:07.261968 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.022 seconds
[0m23:13:07.264981 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:13:07.265981 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:13:07.266970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:07.268982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:13:07.268982 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:13:07.269975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:13:07.271968 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:13:07.271968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:13:07.271968 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:13:07.273970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:13:07.276990 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:13:07.276990 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:13:07.276990 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:13:07.279969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:13:07.280969 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:13:07.281990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45B7BA60>]}
[0m23:13:07.282972 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.10s]
[0m23:13:07.283969 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:13:07.283969 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:13:07.284970 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:13:07.284970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:13:07.285969 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:13:07.286969 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:13:07.288972 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:13:07.303982 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:13:07.305982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:13:07.305982 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:13:07.306973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:07.344756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:13:07.344756 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:13:07.344756 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:13:07.344756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:13:07.344756 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:13:07.344756 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:13:07.344756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:07.362320 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:13:07.362320 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:13:07.363237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:13:07.364340 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:13:07.365273 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:13:07.365273 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:13:07.367328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:13:07.369327 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:13:07.371330 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:13:07.371330 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:13:07.373303 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:13:07.374323 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:13:07.375328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A461DDF60>]}
[0m23:13:07.376292 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:13:07.377296 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:13:07.378293 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:13:07.378293 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:13:07.379295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:13:07.379295 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:13:07.383381 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:13:07.384376 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:13:07.388400 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:13:07.389384 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:13:07.389384 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:13:07.390374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:07.428435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m23:13:07.428435 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:13:07.428435 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
   
    s.id AS sale_id,
    s.lead_id, -- This will also act as FK to fact_leads.lead_id

    -- Foreign Keys to Date Dimension
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- Foreign Keys to other Dimensions (using natural keys for join, then getting surrogate key)
    -- dim_property
    dp.property_id AS property_id, -- This is the surrogate key from dim_property
    -- dim_sale_category
    dsc.category_id AS sale_category_id,
    -- dim_location
    dl.location_id AS location_id,

    -- Degenerate Dimensions (Attributes directly on Fact table)
    s.area_id,    -- As per your schema, these are directly on fact_sales
    s.compound_id, -- As per your schema, these are directly on fact_sales

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2) as agreed
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys
-- Note: We are joining directly to the source table here, assuming your dim models
-- will generate the surrogate keys based on the natural keys.

-- dim_property
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dp
    ON s.property_type = dp.property_type -- Assuming property_type in source maps to property_type in dim_property

-- dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.category_name

-- dim_location (Assuming dim_location has location_name derived from unit_location)
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dl
    ON s.unit_location = dl.location_name -- This join needs careful standardization of unit_location in staging/dim_location

WHERE s.id IS NOT NULL
  );
  
[0m23:13:07.428435 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dl.location_name does not exist
LINE 61:     ON s.unit_location = dl.location_name -- This join needs...
                                  ^

[0m23:13:07.428435 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:13:07.428435 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:13:07.428435 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dl.location_name does not exist
  LINE 61:     ON s.unit_location = dl.location_name -- This join needs...
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:13:07.428435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edaf97b6-6322-47f3-b378-1bfeace0871c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A461905E0>]}
[0m23:13:07.443045 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model dwh.fact_sales ......................... [[31mERROR[0m in 0.05s]
[0m23:13:07.445047 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:13:07.445047 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dl.location_name does not exist
  LINE 61:     ON s.unit_location = dl.location_name -- This join needs...
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:13:07.447047 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:07.447047 [debug] [MainThread]: On master: BEGIN
[0m23:13:07.447047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:07.603113 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m23:13:07.603113 [debug] [MainThread]: On master: COMMIT
[0m23:13:07.604166 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:07.604166 [debug] [MainThread]: On master: COMMIT
[0m23:13:07.605201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:13:07.605201 [debug] [MainThread]: On master: Close
[0m23:13:07.606186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:07.606186 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:13:07.606186 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:13:07.607085 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:13:07.607085 [info ] [MainThread]: 
[0m23:13:07.608096 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m23:13:07.611167 [debug] [MainThread]: Command end result
[0m23:13:07.634200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:13:07.637126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:13:07.644082 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:13:07.645083 [info ] [MainThread]: 
[0m23:13:07.646082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:13:07.646082 [info ] [MainThread]: 
[0m23:13:07.647570 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dl.location_name does not exist
  LINE 61:     ON s.unit_location = dl.location_name -- This join needs...
                                    ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:13:07.648575 [info ] [MainThread]: 
[0m23:13:07.648575 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:13:07.650675 [debug] [MainThread]: Command `dbt run` failed at 23:13:07.650675 after 2.60 seconds
[0m23:13:07.650675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A44700370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45B2DF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A45B97CA0>]}
[0m23:13:07.650675 [debug] [MainThread]: Flushing usage events
[0m23:13:08.520194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:00.101968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F709070370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70AE97BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70AE97F70>]}


============================== 23:14:00.101968 | 3f52e929-9307-447d-946a-1cf5d704ed19 ==============================
[0m23:14:00.101968 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:14:00.101968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:14:00.263070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70AF9EA40>]}
[0m23:14:00.309053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70A80DD50>]}
[0m23:14:00.311018 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:14:00.553364 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:14:00.712286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:00.713287 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:14:00.915152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:14:00.927255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B623E50>]}
[0m23:14:00.997243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:14:01.001151 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:14:01.033148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B620580>]}
[0m23:14:01.034149 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:14:01.035153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B420E80>]}
[0m23:14:01.036151 [info ] [MainThread]: 
[0m23:14:01.037151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:14:01.038149 [info ] [MainThread]: 
[0m23:14:01.039151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:01.042566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:14:01.172552 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:14:01.173543 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:14:01.173543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:01.220463 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.047 seconds
[0m23:14:01.222466 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:14:01.225463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:14:01.230462 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:14:01.230462 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:14:01.231462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:01.274463 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m23:14:01.275544 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:14:01.275544 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:14:01.281463 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:14:01.282466 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:14:01.283558 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:14:01.289559 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:01.289559 [debug] [MainThread]: On master: BEGIN
[0m23:14:01.289559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:01.322669 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m23:14:01.322669 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:01.322669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:01.338147 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:14:01.338147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7087C2F50>]}
[0m23:14:01.338147 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:01.338147 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:01.338147 [debug] [MainThread]: On master: BEGIN
[0m23:14:01.338147 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:14:01.338147 [debug] [MainThread]: On master: COMMIT
[0m23:14:01.338147 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:01.338147 [debug] [MainThread]: On master: COMMIT
[0m23:14:01.338147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:01.338147 [debug] [MainThread]: On master: Close
[0m23:14:01.355903 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:14:01.355903 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:14:01.356905 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:14:01.357985 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:14:01.364991 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:14:01.365993 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:14:01.399990 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:14:01.401902 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:14:01.402910 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:14:01.402910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:14:01.560834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m23:14:01.560834 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:14:01.560834 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:14:01.585736 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.024 seconds
[0m23:14:01.593741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:14:01.594742 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:14:01.595522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:01.597612 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:14:01.598644 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:14:01.599562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:01.604778 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:14:01.604778 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:14:01.604778 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:14:01.604778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:14:01.620405 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:14:01.620405 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:14:01.620405 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:14:01.620405 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:14:01.620405 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:14:01.620405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B02C850>]}
[0m23:14:01.636030 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.26s]
[0m23:14:01.636030 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:14:01.636030 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:14:01.636030 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:14:01.636030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:14:01.636030 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:14:01.636030 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:14:01.636030 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:14:01.636030 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:14:01.636030 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:14:01.636030 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:14:01.636030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:01.681327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:14:01.681327 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:14:01.681327 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:14:01.698003 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.011 seconds
[0m23:14:01.698003 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:14:01.698003 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:14:01.698003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:01.698003 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:14:01.698003 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:14:01.712412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:01.714429 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:14:01.714429 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:14:01.714429 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:14:01.717408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:14:01.719408 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:14:01.719408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:14:01.720408 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:14:01.724412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:14:01.725414 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:14:01.726408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B466710>]}
[0m23:14:01.727408 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.09s]
[0m23:14:01.728425 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:14:01.729272 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:14:01.729347 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:14:01.730347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:14:01.731367 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:14:01.733363 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:14:01.735348 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:14:01.738360 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:14:01.739359 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:14:01.740347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:14:01.740347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:01.779483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:14:01.779483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:14:01.780483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:14:01.798070 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.023 seconds
[0m23:14:01.798070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:14:01.798070 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:14:01.798070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:01.798070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:14:01.798070 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:14:01.812443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:01.813456 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:14:01.814444 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:14:01.814444 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:14:01.817552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:14:01.820439 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:14:01.821439 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:14:01.821439 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:14:01.824590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:14:01.825439 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:14:01.826439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70AF9EAA0>]}
[0m23:14:01.827440 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:14:01.828446 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:14:01.829291 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:14:01.829291 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:14:01.830294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:14:01.831292 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:14:01.834291 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:14:01.835295 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:14:01.839291 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:14:01.840291 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:14:01.841299 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:14:01.841299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:01.881230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:14:01.881230 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:14:01.881230 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:14:01.897980 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.021 seconds
[0m23:14:01.897980 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:14:01.897980 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:14:01.897980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:01.914716 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:14:01.914716 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:14:01.915714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:01.917719 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:14:01.917719 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:14:01.917719 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:14:01.920724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:14:01.922701 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:14:01.922701 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:14:01.923701 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:14:01.925720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:14:01.926701 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:14:01.927701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F708C3BB50>]}
[0m23:14:01.928701 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.10s]
[0m23:14:01.929702 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:14:01.930702 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:14:01.931703 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:14:01.931703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:14:01.932701 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:14:01.935714 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:14:01.936705 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:14:01.940713 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:14:01.941720 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:14:01.941720 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:14:01.942705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:01.983940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:14:01.983940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:14:01.983940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:14:02.006939 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.022 seconds
[0m23:14:02.010939 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:14:02.010939 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:14:02.011940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.015943 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:14:02.015943 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:14:02.016940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.018939 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:14:02.018939 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:14:02.018939 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:14:02.021940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:14:02.024947 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:14:02.025942 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:14:02.025942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:14:02.028939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:14:02.030941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:14:02.031941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70AF9EAA0>]}
[0m23:14:02.031941 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m23:14:02.032941 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:14:02.033942 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:14:02.033942 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:14:02.034942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:14:02.035941 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:14:02.039960 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:14:02.040939 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:14:02.044953 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:14:02.046940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:14:02.046940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:14:02.047940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:02.088939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:14:02.088939 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:14:02.088939 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:14:02.096948 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.007 seconds
[0m23:14:02.099941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:14:02.099941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:14:02.100941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.103941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:14:02.104941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:14:02.105941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:02.106941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:14:02.107941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:14:02.107941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:14:02.109959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:14:02.113941 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:14:02.113941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:14:02.114956 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:14:02.118066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:14:02.119941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:14:02.119941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70CB7E050>]}
[0m23:14:02.120942 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m23:14:02.121941 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:14:02.122940 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:14:02.122940 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:14:02.123940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:14:02.124952 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:14:02.128028 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:14:02.128967 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:14:02.132031 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:14:02.133966 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:14:02.133966 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:14:02.133966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:02.173976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:14:02.173976 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:14:02.174941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category AS category_name
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:14:02.182940 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:14:02.185939 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:14:02.185939 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:14:02.186982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.189940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:14:02.189940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:14:02.191940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:02.192939 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:14:02.193940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:14:02.193940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:14:02.195943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:14:02.197942 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:14:02.198943 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:14:02.198943 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:14:02.202025 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:14:02.202940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:14:02.203939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70CB3D240>]}
[0m23:14:02.203939 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:14:02.205942 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:14:02.205942 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:14:02.206945 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:14:02.206945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:14:02.207942 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:14:02.211029 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:14:02.212032 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:14:02.216026 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:14:02.217032 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:14:02.217941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:14:02.217941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:02.355056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m23:14:02.355056 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:14:02.355056 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:14:02.372013 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.007 seconds
[0m23:14:02.375005 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:14:02.376042 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:14:02.377021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.379026 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:14:02.379026 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:14:02.380559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:02.381652 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:14:02.381652 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:14:02.382643 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:14:02.385451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:14:02.387426 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:14:02.388503 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:14:02.388503 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:14:02.391539 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:14:02.393511 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:14:02.393511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70CAE5C90>]}
[0m23:14:02.394461 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.19s]
[0m23:14:02.395430 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:14:02.396434 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:14:02.396434 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:14:02.397445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:14:02.398428 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:14:02.400515 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:14:02.401503 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:14:02.407432 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:14:02.409433 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:14:02.409433 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:14:02.410427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:02.452329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:14:02.453400 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:14:02.453400 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:14:02.472984 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.019 seconds
[0m23:14:02.477084 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:14:02.478070 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:14:02.478070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.481089 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:14:02.481089 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:14:02.482082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:02.483984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:14:02.483984 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:14:02.483984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:14:02.485985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:14:02.488085 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:14:02.489077 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:14:02.489077 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:14:02.491985 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:14:02.493078 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:14:02.493078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70CB76860>]}
[0m23:14:02.493986 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.10s]
[0m23:14:02.496000 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:14:02.496000 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:14:02.497020 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:14:02.497020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:14:02.497020 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:14:02.497020 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:14:02.497020 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:14:02.515678 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:14:02.515678 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:14:02.515678 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:14:02.515678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:02.567292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m23:14:02.567292 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:14:02.567292 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:14:02.572292 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:14:02.577291 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:14:02.577291 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:14:02.578293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.581292 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:14:02.581292 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:14:02.582292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:02.584292 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:14:02.584292 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:14:02.584292 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:14:02.587293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:14:02.590292 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:14:02.592293 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:14:02.593292 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:14:02.595293 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:14:02.598293 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:14:02.599293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B46D570>]}
[0m23:14:02.600293 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.10s]
[0m23:14:02.601292 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:14:02.602293 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:14:02.603292 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:14:02.604292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:14:02.604292 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:14:02.610294 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:14:02.613293 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:14:02.621381 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:14:02.621381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:14:02.621381 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:14:02.621381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:02.664665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m23:14:02.664665 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:14:02.664665 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_id AS property_id, -- Note: This is now property_id from your dim_property_type model

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.category_name -- Join on the natural key 'category_name' (aliased from sale_category)

-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:14:02.664665 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dpt.property_id does not exist
LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
             ^

[0m23:14:02.664665 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:14:02.664665 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:14:02.681129 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:14:02.682129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f52e929-9307-447d-946a-1cf5d704ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70B464CA0>]}
[0m23:14:02.683129 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model dwh.fact_sales ......................... [[31mERROR[0m in 0.08s]
[0m23:14:02.684129 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:14:02.684129 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:14:02.686129 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:02.686129 [debug] [MainThread]: On master: BEGIN
[0m23:14:02.687132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:02.727383 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m23:14:02.728448 [debug] [MainThread]: On master: COMMIT
[0m23:14:02.728448 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:02.729440 [debug] [MainThread]: On master: COMMIT
[0m23:14:02.729440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:02.730440 [debug] [MainThread]: On master: Close
[0m23:14:02.730440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:02.731442 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:14:02.731442 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:14:02.731442 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:14:02.732441 [info ] [MainThread]: 
[0m23:14:02.732441 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m23:14:02.735441 [debug] [MainThread]: Command end result
[0m23:14:02.760442 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:14:02.762441 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:14:02.769453 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:14:02.770443 [info ] [MainThread]: 
[0m23:14:02.770443 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:14:02.771441 [info ] [MainThread]: 
[0m23:14:02.771441 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:14:02.772919 [info ] [MainThread]: 
[0m23:14:02.772919 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:14:02.772919 [debug] [MainThread]: Command `dbt run` failed at 23:14:02.772919 after 2.74 seconds
[0m23:14:02.772919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F709070370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70A80DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70CB74940>]}
[0m23:14:02.772919 [debug] [MainThread]: Flushing usage events
[0m23:14:03.528367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:18.629016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF60C603A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF62A8BBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF62A8BF70>]}


============================== 23:18:18.633103 | bae713da-57e3-48cd-af0e-9d49bf86e19d ==============================
[0m23:18:18.633103 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:18:18.634108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:18:18.800893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF62BB3EE0>]}
[0m23:18:18.848853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF62C27430>]}
[0m23:18:18.850852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:18:19.087933 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:18:19.250108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:18:19.250108 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:18:19.250108 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\dim_sale_category.sql
[0m23:18:19.459763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:18:19.465983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF63210AF0>]}
[0m23:18:19.542792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:18:19.547753 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:18:19.573833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF63210850>]}
[0m23:18:19.574752 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:18:19.574752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF63010D30>]}
[0m23:18:19.576751 [info ] [MainThread]: 
[0m23:18:19.577753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:19.578755 [info ] [MainThread]: 
[0m23:18:19.578755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:19.584772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:18:19.694965 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:18:19.694965 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:18:19.710592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:19.756872 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m23:18:19.758707 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:18:19.760937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:18:19.767067 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:18:19.768180 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:18:19.768700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:19.808805 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m23:18:19.808805 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:18:19.809865 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:18:19.815775 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:18:19.816797 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:18:19.816797 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:18:19.823775 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:19.823775 [debug] [MainThread]: On master: BEGIN
[0m23:18:19.824775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:19.856603 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m23:18:19.856603 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:19.856603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:19.872201 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:18:19.872201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF63214D60>]}
[0m23:18:19.872201 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:19.872201 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:19.872201 [debug] [MainThread]: On master: BEGIN
[0m23:18:19.872201 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:18:19.872201 [debug] [MainThread]: On master: COMMIT
[0m23:18:19.879234 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:19.879234 [debug] [MainThread]: On master: COMMIT
[0m23:18:19.879234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:19.879234 [debug] [MainThread]: On master: Close
[0m23:18:19.879234 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:18:19.879234 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:18:19.879234 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:18:19.879234 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:18:19.894889 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:18:19.896371 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:18:19.930791 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:18:19.931792 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:18:19.932801 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:18:19.932801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:18:19.969915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m23:18:19.969915 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:18:19.970894 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:18:19.996848 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.026 seconds
[0m23:18:19.998095 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:18:19.998095 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:18:19.998095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:19.998095 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:18:19.998095 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:18:19.998095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:20.013814 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:18:20.013814 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:18:20.013814 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:18:20.013814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.029428 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:18:20.029428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:18:20.029428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:18:20.029428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:18:20.029428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:18:20.044972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF62AA04C0>]}
[0m23:18:20.044972 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.15s]
[0m23:18:20.044972 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:18:20.044972 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:18:20.044972 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:18:20.044972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:18:20.044972 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:18:20.044972 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:18:20.044972 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:18:20.044972 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:18:20.044972 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:18:20.044972 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:18:20.044972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.101081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:18:20.101081 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:18:20.101081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:18:20.111755 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.010 seconds
[0m23:18:20.117764 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:18:20.117764 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:18:20.118827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.120758 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:18:20.120758 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:18:20.121755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.123853 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:18:20.123853 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:18:20.124849 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:18:20.126563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.129672 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:18:20.129672 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:18:20.130655 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:18:20.134577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:18:20.135648 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:18:20.136667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF608AD930>]}
[0m23:18:20.137588 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.09s]
[0m23:18:20.138575 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:18:20.139569 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:18:20.139569 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:18:20.140569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:18:20.141571 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:18:20.143678 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:18:20.145569 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:18:20.148657 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:18:20.149657 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:18:20.150573 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:18:20.150573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.190935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:18:20.192005 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:18:20.192005 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:18:20.214995 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.023 seconds
[0m23:18:20.218915 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:18:20.218915 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:18:20.220592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.222597 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:18:20.223597 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:18:20.224379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.225384 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:18:20.225384 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:18:20.226388 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:18:20.227403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:18:20.231474 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:18:20.231474 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:18:20.232475 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:18:20.235441 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:18:20.236385 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:18:20.237384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF6479CF70>]}
[0m23:18:20.238384 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:18:20.239386 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:18:20.239386 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:18:20.240393 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:18:20.241412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:18:20.241412 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:18:20.244395 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:18:20.245405 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:18:20.249394 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:18:20.252397 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:18:20.253394 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:18:20.253394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.280424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:18:20.280424 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:18:20.280424 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:18:20.314860 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.022 seconds
[0m23:18:20.317968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:18:20.318946 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:18:20.319861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.321954 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:18:20.321954 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:18:20.322951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.323860 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:18:20.324858 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:18:20.324858 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:18:20.327878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.329943 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:18:20.330968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:18:20.330968 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:18:20.333862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:18:20.334943 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:18:20.335862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF608AD930>]}
[0m23:18:20.335862 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.10s]
[0m23:18:20.337866 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:18:20.337866 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:18:20.337866 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:18:20.338933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:18:20.339896 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:18:20.343966 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.345397 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:18:20.345738 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.345738 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.345738 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:18:20.345738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.379882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:18:20.379882 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.379882 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:18:20.415402 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.022 seconds
[0m23:18:20.418406 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.418406 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:18:20.419614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.421619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.421619 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:18:20.422837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.424949 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:18:20.424949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.425958 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:18:20.428885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.430979 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:18:20.430979 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:18:20.431937 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:18:20.434855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:18:20.435960 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:18:20.435960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF6479CF70>]}
[0m23:18:20.436853 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m23:18:20.437868 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:18:20.438852 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:18:20.438852 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:18:20.439852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:18:20.439852 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:18:20.442949 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:18:20.443932 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:18:20.447938 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:18:20.448858 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:18:20.449851 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:18:20.449851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.490716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:18:20.491716 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:18:20.491716 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:18:20.500522 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.008 seconds
[0m23:18:20.503495 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:18:20.503495 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:18:20.504502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.507496 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:18:20.507496 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:18:20.508496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.510561 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:18:20.511496 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:18:20.512497 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:18:20.515164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.517169 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:18:20.518169 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:18:20.518169 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:18:20.520875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:18:20.521953 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:18:20.522994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF608AD930>]}
[0m23:18:20.523875 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m23:18:20.524874 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:18:20.524874 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:18:20.525889 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:18:20.526876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:18:20.526876 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:18:20.529740 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:18:20.531736 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:18:20.534766 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:18:20.535757 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:18:20.535757 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:18:20.536739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.577454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:18:20.578454 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:18:20.579470 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:18:20.587661 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m23:18:20.590661 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:18:20.590661 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:18:20.591706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.594661 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:18:20.595663 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:18:20.596661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:20.597751 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:18:20.598700 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:18:20.598700 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:18:20.600715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.602661 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:18:20.603660 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:18:20.603660 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:18:20.606412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:18:20.607457 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:18:20.608441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF647A9810>]}
[0m23:18:20.609364 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:18:20.610364 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:18:20.610364 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:18:20.611366 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:18:20.612380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:18:20.612380 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:18:20.616451 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:18:20.617465 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:18:20.620451 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:18:20.621453 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:18:20.622390 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:18:20.622390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.664366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:18:20.665401 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:18:20.665401 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:18:20.672366 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m23:18:20.675457 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:18:20.675457 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:18:20.676454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.679444 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:18:20.679444 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:18:20.680474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:20.682363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:18:20.682363 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:18:20.682363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:18:20.684366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.687451 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:18:20.688383 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:18:20.688383 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:18:20.691374 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:18:20.692451 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:18:20.693430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF608AD930>]}
[0m23:18:20.694365 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.08s]
[0m23:18:20.695364 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:18:20.695364 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:18:20.696365 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:18:20.697374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:18:20.697374 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:18:20.700363 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:18:20.701364 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:18:20.706367 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:18:20.707375 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:18:20.707375 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:18:20.708369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.746653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m23:18:20.746653 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:18:20.746653 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:18:20.762247 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.021 seconds
[0m23:18:20.782641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:18:20.782641 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:18:20.783738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:20.786731 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:18:20.787684 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:18:20.788651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:20.790641 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:18:20.790641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:18:20.790641 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:18:20.792686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:18:20.795536 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:18:20.796536 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:18:20.796536 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:18:20.800575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:18:20.801580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:18:20.802549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF608AD930>]}
[0m23:18:20.803533 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.11s]
[0m23:18:20.804533 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:18:20.805534 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:18:20.805534 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:18:20.806602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:18:20.807536 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:18:20.809533 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:18:20.810533 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:18:20.811762 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:18:20.827753 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:18:20.828748 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:18:20.828748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.869747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:18:20.869747 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:18:20.870824 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:18:20.875747 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:18:20.878862 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:18:20.878862 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:18:20.879747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.882853 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:18:20.883831 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:18:20.883831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:20.885831 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:18:20.885831 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:18:20.885831 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:18:20.887782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:20.889828 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:18:20.892748 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:18:20.892748 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:18:20.894763 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:18:20.895746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:18:20.896746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF608AD930>]}
[0m23:18:20.896746 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:18:20.897746 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:18:20.898747 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:18:20.899748 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:18:20.900748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:18:20.900748 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:18:20.904746 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:18:20.906747 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:18:20.910747 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:18:20.912751 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:18:20.913747 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:18:20.914848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:20.952747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:18:20.953843 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:18:20.953843 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_id AS property_id, -- Note: This is now property_id from your dim_property_type model

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
    
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:18:20.955791 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dpt.property_id does not exist
LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
             ^

[0m23:18:20.955791 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:18:20.956757 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:18:20.960747 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:18:20.962746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae713da-57e3-48cd-af0e-9d49bf86e19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64846C20>]}
[0m23:18:20.963785 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model dwh.fact_sales ......................... [[31mERROR[0m in 0.06s]
[0m23:18:20.965747 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:18:20.965747 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:18:20.967775 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:20.967775 [debug] [MainThread]: On master: BEGIN
[0m23:18:20.968750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:20.996701 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:18:20.996701 [debug] [MainThread]: On master: COMMIT
[0m23:18:20.996701 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:20.996701 [debug] [MainThread]: On master: COMMIT
[0m23:18:20.996701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:20.996701 [debug] [MainThread]: On master: Close
[0m23:18:20.996701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:21.011792 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:18:21.011792 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:18:21.011792 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:18:21.012788 [info ] [MainThread]: 
[0m23:18:21.013798 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m23:18:21.015788 [debug] [MainThread]: Command end result
[0m23:18:21.036181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:18:21.038170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:18:21.046150 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:18:21.046150 [info ] [MainThread]: 
[0m23:18:21.046150 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:18:21.046150 [info ] [MainThread]: 
[0m23:18:21.046150 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_id, -- Note: This is now pro...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:18:21.046150 [info ] [MainThread]: 
[0m23:18:21.046150 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:18:21.046150 [debug] [MainThread]: Command `dbt run` failed at 23:18:21.046150 after 2.50 seconds
[0m23:18:21.046150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF60C603A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF630316C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64766FB0>]}
[0m23:18:21.046150 [debug] [MainThread]: Flushing usage events
[0m23:18:22.060739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:56.999663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2F8F03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31750940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC317505B0>]}


============================== 23:20:56.999663 | 788c8193-9dd3-44fc-bccb-5300fa1bbb81 ==============================
[0m23:20:56.999663 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:20:56.999663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:57.163904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31843EE0>]}
[0m23:20:57.218321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC318B3430>]}
[0m23:20:57.219585 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:20:57.443516 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:20:57.614917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:57.614917 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:20:57.801237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:20:57.816766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31EA3E50>]}
[0m23:20:57.899731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:20:57.903657 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:20:57.935653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31EA03A0>]}
[0m23:20:57.936653 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:20:57.937656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31CA0550>]}
[0m23:20:57.939655 [info ] [MainThread]: 
[0m23:20:57.939655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:57.940656 [info ] [MainThread]: 
[0m23:20:57.941652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:57.946735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:20:58.087782 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:20:58.087782 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:20:58.088782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:58.144281 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.055 seconds
[0m23:20:58.145366 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:20:58.147281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:20:58.153369 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:20:58.153369 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:20:58.153369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:58.190284 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m23:20:58.190284 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:20:58.191398 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:20:58.197805 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:20:58.198810 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:20:58.199814 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:20:58.205719 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:58.205719 [debug] [MainThread]: On master: BEGIN
[0m23:20:58.206719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:58.244778 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:20:58.244778 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:58.244778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:20:58.253760 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:20:58.254800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31EA8C70>]}
[0m23:20:58.254800 [debug] [MainThread]: On master: ROLLBACK
[0m23:20:58.255814 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:58.255814 [debug] [MainThread]: On master: BEGIN
[0m23:20:58.256805 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:20:58.256805 [debug] [MainThread]: On master: COMMIT
[0m23:20:58.257827 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:58.257989 [debug] [MainThread]: On master: COMMIT
[0m23:20:58.257989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:20:58.257989 [debug] [MainThread]: On master: Close
[0m23:20:58.257989 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:20:58.257989 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:20:58.257989 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:20:58.257989 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:20:58.257989 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:20:58.273619 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:20:58.308167 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:20:58.310098 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:20:58.310098 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:20:58.310098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:20:58.347121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m23:20:58.347121 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:20:58.348080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:20:58.372162 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.024 seconds
[0m23:20:58.381080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:20:58.381080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:20:58.382080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.385080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:20:58.385080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:20:58.386126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:58.399080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:20:58.399080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:20:58.400081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:20:58.402121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:20:58.408080 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:20:58.411080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:20:58.412081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:20:58.417082 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:20:58.420175 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:20:58.423081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC317304C0>]}
[0m23:20:58.424081 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.16s]
[0m23:20:58.425082 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:20:58.425082 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:20:58.426083 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:20:58.427081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:20:58.427081 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:20:58.430170 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:20:58.431177 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:20:58.436084 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:20:58.438100 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:20:58.439083 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:20:58.439083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:58.479082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:20:58.479082 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:20:58.479082 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:20:58.491100 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.011 seconds
[0m23:20:58.494080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:20:58.495080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:20:58.495080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.499080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:20:58.499080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:20:58.500117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.501080 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:20:58.502097 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:20:58.502097 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:20:58.505115 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:20:58.508080 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:20:58.509081 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:20:58.509081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:20:58.514080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:20:58.515082 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:20:58.516175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2F539930>]}
[0m23:20:58.517081 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.09s]
[0m23:20:58.518084 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:20:58.518084 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:20:58.519091 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:20:58.520081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:20:58.520081 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:20:58.523172 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:20:58.525093 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:20:58.529168 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:20:58.530171 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:20:58.531083 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:20:58.531083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:58.569082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:20:58.570081 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:20:58.570081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:20:58.588477 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.024 seconds
[0m23:20:58.588477 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:20:58.588477 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:20:58.588477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.588477 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:20:58.603257 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:20:58.604257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:58.605362 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:20:58.606361 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:20:58.606361 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:20:58.609380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:20:58.612253 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:20:58.613253 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:20:58.613253 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:20:58.616341 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:20:58.617254 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:20:58.618254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33399900>]}
[0m23:20:58.619256 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:20:58.619948 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:20:58.620989 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:20:58.621960 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:20:58.622949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:20:58.622949 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:20:58.625950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:20:58.626950 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:20:58.629948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:20:58.630948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:20:58.631952 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:20:58.631952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:58.671967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:20:58.671967 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:20:58.673044 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:20:58.694044 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.021 seconds
[0m23:20:58.697948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:20:58.697948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:20:58.698994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.700948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:20:58.700948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:20:58.701949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.703951 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:20:58.705050 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:20:58.705050 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:20:58.708056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:20:58.709948 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:20:58.710948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:20:58.710948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:20:58.714044 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:20:58.714949 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:20:58.715949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2F539930>]}
[0m23:20:58.716948 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.09s]
[0m23:20:58.717950 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:20:58.717950 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:20:58.718954 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:20:58.719949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:20:58.719949 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:20:58.722948 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.723949 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:20:58.728948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.729970 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.729970 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:20:58.730950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:58.770949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:20:58.771949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.772958 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:20:58.792050 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.019 seconds
[0m23:20:58.795948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.795948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:20:58.796949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.799948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.799948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:20:58.800951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.801949 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:20:58.802948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.802948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:20:58.806083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:20:58.808949 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:20:58.808949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:20:58.809948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:20:58.812993 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:20:58.814948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:20:58.814948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2F539930>]}
[0m23:20:58.815950 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.09s]
[0m23:20:58.816949 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:20:58.817951 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:20:58.817951 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:20:58.818968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:20:58.818968 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:20:58.820067 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:20:58.820067 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:20:58.820067 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:20:58.820067 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:20:58.820067 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:20:58.820067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:58.854589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:20:58.854589 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:20:58.854589 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:20:58.877832 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.009 seconds
[0m23:20:58.880832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:20:58.880832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:20:58.881871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.884832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:20:58.885832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:20:58.886836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:58.888832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:20:58.889834 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:20:58.890832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:20:58.892849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:20:58.894832 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:20:58.895832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:20:58.895832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:20:58.898934 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:20:58.900832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:20:58.900832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC333BEAD0>]}
[0m23:20:58.901832 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m23:20:58.902846 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:20:58.903835 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:20:58.903835 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:20:58.904833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:20:58.905832 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:20:58.907832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:20:58.908832 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:20:58.912832 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:20:58.913832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:20:58.914842 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:20:58.914842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:58.955819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m23:20:58.955819 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:20:58.955819 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:20:58.955819 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:20:58.971149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:20:58.971149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:20:58.971149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:58.971149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:20:58.971149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:20:58.971149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:58.971149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:20:58.971149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:20:58.971149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:20:58.971149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:20:58.987602 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:20:58.987602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:20:58.988638 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:20:58.991604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:20:58.993599 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:20:58.993599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31CA2AA0>]}
[0m23:20:58.994600 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.09s]
[0m23:20:58.996601 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:20:58.996601 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:20:58.997602 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:20:58.998601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:20:58.998601 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:20:59.003601 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:20:59.005607 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:20:59.009599 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:20:59.011600 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:20:59.011600 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:20:59.012599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:59.162955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m23:20:59.162955 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:20:59.162955 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:20:59.171190 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.008 seconds
[0m23:20:59.174276 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:20:59.175286 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:20:59.176192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:59.178279 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:20:59.178279 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:20:59.179277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:59.181192 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:20:59.181192 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:20:59.182301 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:20:59.184191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:20:59.186279 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:20:59.186279 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:20:59.187191 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:20:59.190230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:20:59.191191 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:20:59.192191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31CA2AA0>]}
[0m23:20:59.193190 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.19s]
[0m23:20:59.194196 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:20:59.195191 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:20:59.195191 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:20:59.196208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:20:59.197191 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:20:59.199276 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:20:59.200320 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:20:59.204310 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:20:59.205268 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:20:59.206192 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:20:59.206192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:59.360901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m23:20:59.360901 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:20:59.360901 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:20:59.383823 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.019 seconds
[0m23:20:59.388021 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:20:59.388021 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:20:59.388021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:59.388021 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:20:59.388021 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:20:59.388021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:59.388021 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:20:59.388021 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:20:59.388021 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:20:59.388021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:20:59.388021 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:20:59.388021 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:20:59.388021 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:20:59.403910 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:20:59.405989 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:20:59.405989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33404BE0>]}
[0m23:20:59.406912 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.21s]
[0m23:20:59.407978 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:20:59.408910 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:20:59.408910 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:20:59.409911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:20:59.409911 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:20:59.411911 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:20:59.412986 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:20:59.431018 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:20:59.431917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:20:59.432913 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:20:59.432913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:59.475992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:20:59.477000 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:20:59.477000 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:20:59.481995 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:20:59.486947 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:20:59.486947 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:20:59.488083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:59.491067 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:20:59.491067 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:20:59.492038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:20:59.493038 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:20:59.494025 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:20:59.494025 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:20:59.497034 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:20:59.500049 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:20:59.502027 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:20:59.502027 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:20:59.504195 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:20:59.504195 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:20:59.504195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2F539930>]}
[0m23:20:59.504195 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:20:59.504195 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:20:59.504195 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:20:59.504195 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:20:59.504195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:20:59.504195 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:20:59.504195 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:20:59.504195 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:20:59.504195 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:20:59.504195 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:20:59.519835 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:20:59.519835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:59.661860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m23:20:59.661860 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:20:59.662872 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:20:59.664862 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dpt.property_id does not exist
LINE 24:     dpt.property_id AS property_type_id, 
             ^

[0m23:20:59.664862 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:20:59.665924 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:20:59.669865 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_type_id, 
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:20:59.670860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788c8193-9dd3-44fc-bccb-5300fa1bbb81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC333C0460>]}
[0m23:20:59.671943 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model dwh.fact_sales ......................... [[31mERROR[0m in 0.17s]
[0m23:20:59.672569 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:20:59.673581 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_type_id, 
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:20:59.674575 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:59.675658 [debug] [MainThread]: On master: BEGIN
[0m23:20:59.675658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:59.716076 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m23:20:59.717113 [debug] [MainThread]: On master: COMMIT
[0m23:20:59.717113 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:59.717113 [debug] [MainThread]: On master: COMMIT
[0m23:20:59.718168 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:20:59.718168 [debug] [MainThread]: On master: Close
[0m23:20:59.719071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:59.719071 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:20:59.719071 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:20:59.720079 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:20:59.720079 [info ] [MainThread]: 
[0m23:20:59.721078 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m23:20:59.724069 [debug] [MainThread]: Command end result
[0m23:20:59.738415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:20:59.738415 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:20:59.756375 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:20:59.757254 [info ] [MainThread]: 
[0m23:20:59.757254 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:20:59.757254 [info ] [MainThread]: 
[0m23:20:59.757254 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dpt.property_id does not exist
  LINE 24:     dpt.property_id AS property_type_id, 
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:20:59.757254 [info ] [MainThread]: 
[0m23:20:59.757254 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:20:59.757254 [debug] [MainThread]: Command `dbt run` failed at 23:20:59.757254 after 2.83 seconds
[0m23:20:59.757254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2F8F03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31E5E4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33404850>]}
[0m23:20:59.757254 [debug] [MainThread]: Flushing usage events
[0m23:21:00.728389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:22.251796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C37603A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C558BBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C558BF70>]}


============================== 23:21:22.255789 | ed55342a-a69c-41a8-baf8-d7a1f80fc63b ==============================
[0m23:21:22.255789 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:21:22.257790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:22.423869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C56AFEE0>]}
[0m23:21:22.469876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C571F430>]}
[0m23:21:22.471825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:21:22.678732 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:21:22.856764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:22.857771 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:21:23.058142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:21:23.071226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C5D13E50>]}
[0m23:21:23.142135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:21:23.145134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:21:23.176131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C5D103A0>]}
[0m23:21:23.177131 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:21:23.178132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C5B10550>]}
[0m23:21:23.179228 [info ] [MainThread]: 
[0m23:21:23.180219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:23.181156 [info ] [MainThread]: 
[0m23:21:23.181156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:23.187230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:21:23.311615 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:21:23.311615 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:21:23.311615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:23.355951 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m23:21:23.356963 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:21:23.359980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:21:23.365051 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:21:23.365051 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:21:23.366059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:23.403617 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m23:21:23.403617 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:21:23.404721 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:21:23.411285 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:21:23.412370 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:21:23.413288 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:21:23.419289 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:23.420289 [debug] [MainThread]: On master: BEGIN
[0m23:21:23.420289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:23.457853 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:21:23.457853 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:23.457853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:21:23.466511 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:21:23.467618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C5CD9AE0>]}
[0m23:21:23.468619 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:23.469512 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:23.469512 [debug] [MainThread]: On master: BEGIN
[0m23:21:23.470512 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:21:23.470512 [debug] [MainThread]: On master: COMMIT
[0m23:21:23.471608 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:23.471608 [debug] [MainThread]: On master: COMMIT
[0m23:21:23.472512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:21:23.472512 [debug] [MainThread]: On master: Close
[0m23:21:23.477671 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:21:23.477671 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:21:23.477671 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:21:23.477671 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:21:23.477671 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:21:23.477671 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:21:23.524423 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:21:23.524423 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:21:23.524423 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:21:23.524423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:21:23.568958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:21:23.568958 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:21:23.568958 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:21:23.597982 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.028 seconds
[0m23:21:23.611893 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:21:23.612976 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:21:23.614890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:23.617888 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:21:23.617888 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:21:23.618889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:23.633971 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:21:23.634977 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:21:23.634977 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:21:23.637912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:21:23.643980 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:21:23.647968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:21:23.647968 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:21:23.652925 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:21:23.656890 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:21:23.658998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C55A2380>]}
[0m23:21:23.659890 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.18s]
[0m23:21:23.661889 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:21:23.661889 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:21:23.662897 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:21:23.663895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:21:23.663895 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:21:23.666891 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:21:23.668007 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:21:23.672971 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:21:23.673980 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:21:23.673980 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:21:23.674922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:23.717239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:21:23.718223 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:21:23.718223 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:21:23.727640 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.012 seconds
[0m23:21:23.727640 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:21:23.727640 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:21:23.727640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:23.738244 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:21:23.738244 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:21:23.740245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:23.741330 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:21:23.741330 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:21:23.742334 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:21:23.746348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:21:23.748245 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:21:23.749245 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:21:23.749245 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:21:23.754246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:21:23.755156 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:21:23.756160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C33A9930>]}
[0m23:21:23.757170 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.09s]
[0m23:21:23.758157 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:21:23.759171 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:21:23.759171 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:21:23.760161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:21:23.760161 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:21:23.763156 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:21:23.764156 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:21:23.768156 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:21:23.769156 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:21:23.770426 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:21:23.771230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:23.813383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:21:23.813383 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:21:23.814383 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:21:23.836472 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.022 seconds
[0m23:21:23.840381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:21:23.840381 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:21:23.841384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:23.843382 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:21:23.844382 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:21:23.844382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:23.846381 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:21:23.846381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:21:23.847382 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:21:23.849510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:21:23.853382 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:21:23.854381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:21:23.854381 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:21:23.857477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:21:23.859382 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:21:23.859382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C7279900>]}
[0m23:21:23.860382 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:21:23.861386 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:21:23.862384 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:21:23.862384 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:21:23.863403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:21:23.864475 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:21:23.867484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:21:23.868479 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:21:23.872424 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:21:23.874384 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:21:23.875411 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:21:23.875411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.020766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m23:21:24.020766 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:21:24.021827 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:21:24.043749 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.021 seconds
[0m23:21:24.046745 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:21:24.046745 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:21:24.047748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:24.050749 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:21:24.050749 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:21:24.051746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:24.052746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:21:24.053782 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:21:24.053782 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:21:24.056747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:21:24.058747 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:21:24.059839 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:21:24.059839 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:21:24.062747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:21:24.063825 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:21:24.064839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C33A9930>]}
[0m23:21:24.065749 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.20s]
[0m23:21:24.066765 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:21:24.066765 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:21:24.067819 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:21:24.068750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:21:24.068750 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:21:24.071851 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.072831 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:21:24.077835 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.078770 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.078770 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:21:24.079746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.122293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:21:24.122645 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.122645 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:21:24.147202 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.023 seconds
[0m23:21:24.150200 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.151203 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:21:24.152112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:24.155166 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.156112 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:21:24.157111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:24.159112 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:21:24.159112 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.160113 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:21:24.163111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:21:24.166130 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:21:24.166130 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:21:24.167196 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:21:24.170112 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:21:24.171112 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:21:24.172216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C33A9930>]}
[0m23:21:24.173112 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m23:21:24.174119 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:21:24.175112 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:21:24.175112 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:21:24.176111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:21:24.176111 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:21:24.179161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:21:24.180196 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:21:24.184219 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:21:24.185116 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:21:24.185116 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:21:24.185116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.223641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:21:24.223641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:21:24.223641 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:21:24.223641 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.006 seconds
[0m23:21:24.223641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:21:24.238951 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:21:24.239932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.243018 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:21:24.243018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:21:24.244031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.245930 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:21:24.245930 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:21:24.247026 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:21:24.248932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:21:24.251041 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:21:24.252028 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:21:24.252028 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:21:24.255933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:21:24.258019 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:21:24.258019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C729A440>]}
[0m23:21:24.258934 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m23:21:24.259934 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:21:24.260931 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:21:24.260931 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:21:24.261930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:21:24.262933 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:21:24.265021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:21:24.266935 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:21:24.270037 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:21:24.271014 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:21:24.271972 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:21:24.271972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.307830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:21:24.307830 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:21:24.307830 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:21:24.321516 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:21:24.323104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:21:24.323104 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:21:24.323104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:24.323104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:21:24.323104 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:21:24.323104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.323104 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:21:24.323104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:21:24.323104 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:21:24.323104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:21:24.340255 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:21:24.340255 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:21:24.341255 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:21:24.344298 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:21:24.345303 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:21:24.345303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C723D360>]}
[0m23:21:24.346303 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:21:24.347363 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:21:24.348304 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:21:24.348304 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:21:24.349306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:21:24.350303 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:21:24.353302 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:21:24.355303 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:21:24.358302 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:21:24.359302 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:21:24.360303 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:21:24.360303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.390917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:21:24.390917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:21:24.390917 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:21:24.406356 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.008 seconds
[0m23:21:24.406356 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:21:24.406356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:21:24.406356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.406356 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:21:24.406356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:21:24.406356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.422501 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:21:24.422501 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:21:24.423415 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:21:24.425415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:21:24.428417 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:21:24.429432 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:21:24.430436 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:21:24.434430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:21:24.436415 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:21:24.437430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C723D360>]}
[0m23:21:24.438416 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.09s]
[0m23:21:24.439414 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:21:24.440414 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:21:24.440414 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:21:24.442421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:21:24.442421 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:21:24.445416 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:21:24.447417 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:21:24.450416 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:21:24.451417 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:21:24.452427 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:21:24.452427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.499461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m23:21:24.500088 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:21:24.500088 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:21:24.523896 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.024 seconds
[0m23:21:24.527812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:21:24.528812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:21:24.529813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.531812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:21:24.531812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:21:24.532813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.533812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:21:24.534813 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:21:24.534813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:21:24.537909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:21:24.540891 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:21:24.541924 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:21:24.541924 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:21:24.544906 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:21:24.545814 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:21:24.546812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C72E0A00>]}
[0m23:21:24.547815 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.11s]
[0m23:21:24.548815 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:21:24.548815 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:21:24.549814 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:21:24.550814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:21:24.550814 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:21:24.552902 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:21:24.553891 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:21:24.569846 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:21:24.573816 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:21:24.574814 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:21:24.575906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.616812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:21:24.616812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:21:24.617813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:21:24.623825 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:21:24.626813 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:21:24.626813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:21:24.627829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.629812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:21:24.629812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:21:24.630813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:21:24.631812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:21:24.632812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:21:24.632812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:21:24.634902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:21:24.638812 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:21:24.640812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:21:24.640812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:21:24.642886 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:21:24.643813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:21:24.643813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C33A9930>]}
[0m23:21:24.644813 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:21:24.646816 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:21:24.646816 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:21:24.647822 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:21:24.648825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:21:24.648825 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:21:24.651927 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:21:24.652904 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:21:24.656924 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:21:24.657896 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:21:24.657896 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:21:24.658934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:24.801608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m23:21:24.802608 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:21:24.802608 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:21:24.804743 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dsc.category_id does not exist
LINE 35:     dsc.category_id AS sale_category_id, -- Note: This is no...
             ^

[0m23:21:24.804743 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m23:21:24.804743 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:21:24.804743 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_id does not exist
  LINE 35:     dsc.category_id AS sale_category_id, -- Note: This is no...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:21:24.804743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed55342a-a69c-41a8-baf8-d7a1f80fc63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C5B50EE0>]}
[0m23:21:24.804743 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model dwh.fact_sales ......................... [[31mERROR[0m in 0.16s]
[0m23:21:24.804743 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:21:24.804743 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_id does not exist
  LINE 35:     dsc.category_id AS sale_category_id, -- Note: This is no...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql.
[0m23:21:24.804743 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:24.804743 [debug] [MainThread]: On master: BEGIN
[0m23:21:24.804743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:24.959978 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m23:21:24.959978 [debug] [MainThread]: On master: COMMIT
[0m23:21:24.959978 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:24.961076 [debug] [MainThread]: On master: COMMIT
[0m23:21:24.961076 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:21:24.961979 [debug] [MainThread]: On master: Close
[0m23:21:24.961979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:24.962978 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:21:24.962978 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:21:24.962978 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:21:24.963978 [info ] [MainThread]: 
[0m23:21:24.963978 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m23:21:24.966975 [debug] [MainThread]: Command end result
[0m23:21:24.987976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:21:24.991975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:21:24.998975 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:21:24.998975 [info ] [MainThread]: 
[0m23:21:24.999975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:21:25.001038 [info ] [MainThread]: 
[0m23:21:25.001038 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  column dsc.category_id does not exist
  LINE 35:     dsc.category_id AS sale_category_id, -- Note: This is no...
               ^
  compiled code at target\run\my_dbt_project\models\marts\fact_sales.sql
[0m23:21:25.001977 [info ] [MainThread]: 
[0m23:21:25.003045 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:21:25.003977 [debug] [MainThread]: Command `dbt run` failed at 23:21:25.003977 after 2.83 seconds
[0m23:21:25.003977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C37603A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C5CD24A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272C72E0790>]}
[0m23:21:25.004979 [debug] [MainThread]: Flushing usage events
[0m23:21:25.881695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:59.041721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24BDA03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24DC00940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24DC005B0>]}


============================== 23:21:59.045842 | 616aab7a-fe9f-483e-941d-d9d1d21643b6 ==============================
[0m23:21:59.045842 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:21:59.047721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:59.212269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24DCF3EE0>]}
[0m23:21:59.261185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24DD63430>]}
[0m23:21:59.262186 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:21:59.488259 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:21:59.662514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:59.662514 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:21:59.865816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:21:59.872041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E353E50>]}
[0m23:21:59.950040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:21:59.953960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:21:59.984958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E3503A0>]}
[0m23:21:59.985970 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:21:59.986994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E150550>]}
[0m23:21:59.989044 [info ] [MainThread]: 
[0m23:21:59.989961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:59.989961 [info ] [MainThread]: 
[0m23:21:59.990959 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:59.995996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:22:00.120955 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:22:00.120955 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:22:00.121866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:00.166944 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.045 seconds
[0m23:22:00.167864 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:22:00.170890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:22:00.175956 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:22:00.175956 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:22:00.176941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:00.212849 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:22:00.213927 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:22:00.213927 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:22:00.221865 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:22:00.222870 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:22:00.223881 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:22:00.229974 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:00.229974 [debug] [MainThread]: On master: BEGIN
[0m23:22:00.229974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:00.267227 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:22:00.267227 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:00.268310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:22:00.273471 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:22:00.273471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E358C70>]}
[0m23:22:00.273471 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:00.273471 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:00.273471 [debug] [MainThread]: On master: BEGIN
[0m23:22:00.273471 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:22:00.273471 [debug] [MainThread]: On master: COMMIT
[0m23:22:00.273471 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:00.273471 [debug] [MainThread]: On master: COMMIT
[0m23:22:00.273471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:22:00.273471 [debug] [MainThread]: On master: Close
[0m23:22:00.273471 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:22:00.273471 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:22:00.273471 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:22:00.289137 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:22:00.289137 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:22:00.289137 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:22:00.331226 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:22:00.332227 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:22:00.333230 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:22:00.333230 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:22:00.484965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m23:22:00.484965 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:22:00.486038 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:22:00.511790 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.026 seconds
[0m23:22:00.521715 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:22:00.521715 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:22:00.522711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:00.525713 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:22:00.525713 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:22:00.526982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:00.538434 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:22:00.538434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:22:00.538434 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:22:00.538434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:22:00.538434 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:22:00.538434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:22:00.538434 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:22:00.554063 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:22:00.554063 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:22:00.554063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24DBE04C0>]}
[0m23:22:00.554063 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.28s]
[0m23:22:00.554063 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:22:00.554063 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:22:00.554063 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:22:00.554063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:22:00.554063 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:22:00.554063 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:22:00.554063 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:22:00.573387 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:22:00.577498 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:22:00.578468 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:22:00.578468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:00.619179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:22:00.619179 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:22:00.620238 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:22:00.630257 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.010 seconds
[0m23:22:00.633139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:22:00.634139 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:22:00.635205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:00.638139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:22:00.638139 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:22:00.639198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:00.641174 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:22:00.641174 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:22:00.642164 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:22:00.644175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:22:00.646163 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:22:00.647163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:22:00.647163 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:22:00.650197 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:22:00.651164 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:22:00.652164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24B9E9930>]}
[0m23:22:00.653165 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.10s]
[0m23:22:00.654243 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:22:00.655167 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:22:00.655167 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:22:00.656170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:22:00.657167 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:22:00.660258 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:22:00.661254 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:22:00.665291 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:22:00.666165 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:22:00.667167 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:22:00.667167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:00.707784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:22:00.708783 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:22:00.709782 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:22:00.731754 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.022 seconds
[0m23:22:00.734851 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:22:00.735850 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:22:00.736714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:00.738730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:22:00.738730 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:22:00.739730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:00.741819 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:22:00.742815 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:22:00.742815 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:22:00.745884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:22:00.748730 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:22:00.749730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:22:00.749730 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:22:00.752811 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:22:00.753730 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:22:00.754730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24F84D900>]}
[0m23:22:00.755733 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:22:00.756731 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:22:00.757731 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:22:00.757731 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:22:00.758730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:22:00.759826 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:22:00.762821 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:22:00.763819 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:22:00.767815 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:22:00.768732 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:22:00.768732 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:22:00.769768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:00.812528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:22:00.813527 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:22:00.813527 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:22:00.835624 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.022 seconds
[0m23:22:00.838526 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:22:00.839526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:22:00.840580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:00.843526 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:22:00.843526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:22:00.844528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:00.846611 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:22:00.847610 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:22:00.847610 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:22:00.850664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:22:00.853527 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:22:00.853527 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:22:00.853527 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:22:00.857629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:22:00.858526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:22:00.859527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24B9E9930>]}
[0m23:22:00.860566 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.10s]
[0m23:22:00.861530 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:22:00.861530 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:22:00.862530 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:22:00.863528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:22:00.863528 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:22:00.866527 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.867528 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:22:00.872537 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.874532 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.875527 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:22:00.875527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:00.917009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:22:00.917009 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.918095 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:22:00.939010 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.020 seconds
[0m23:22:00.942094 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.943112 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:22:00.944009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:00.946095 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.946095 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:22:00.947111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:00.949102 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:22:00.949102 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.950098 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:22:00.951010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:00.953125 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:22:00.954130 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:22:00.954130 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:22:00.957010 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:22:00.958132 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:22:00.958132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24B9E9930>]}
[0m23:22:00.958132 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.09s]
[0m23:22:00.958132 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:22:00.958132 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:22:00.958132 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:22:00.958132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:22:00.958132 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:22:00.958132 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:22:00.958132 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:22:00.958132 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:22:00.958132 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:22:00.958132 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:22:00.958132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:01.014127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:22:01.014127 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:22:01.015232 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:22:01.022128 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.006 seconds
[0m23:22:01.025212 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:22:01.026213 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:22:01.027127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:01.031211 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:22:01.031211 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:22:01.033128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:22:01.035209 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:22:01.036218 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:22:01.036218 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:22:01.038128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:22:01.042129 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:22:01.043236 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:22:01.043236 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:22:01.047129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:22:01.048211 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:22:01.049211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24F86C040>]}
[0m23:22:01.050166 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.09s]
[0m23:22:01.051130 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:22:01.051130 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:22:01.052196 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:22:01.053127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:22:01.054127 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:22:01.058126 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:22:01.059127 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:22:01.063126 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:22:01.064127 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:22:01.065145 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:22:01.065145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:01.107137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:22:01.109127 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:22:01.109127 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:22:01.117127 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:22:01.120217 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:22:01.120217 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:22:01.121239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:01.123213 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:22:01.124128 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:22:01.125127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:01.126127 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:22:01.126127 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:22:01.127165 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:22:01.129127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:22:01.132129 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:22:01.132129 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:22:01.133128 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:22:01.136165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:22:01.137130 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:22:01.138217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E3504C0>]}
[0m23:22:01.139129 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.09s]
[0m23:22:01.140356 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:22:01.140356 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:22:01.141454 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:22:01.142357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:22:01.142357 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:22:01.146356 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:22:01.147356 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:22:01.150356 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:22:01.151356 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:22:01.152356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:22:01.152356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:01.190134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m23:22:01.191133 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:22:01.191133 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:22:01.199132 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.007 seconds
[0m23:22:01.202215 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:22:01.203222 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:22:01.203222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:01.206237 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:22:01.207133 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:22:01.208135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:01.211131 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:22:01.211131 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:22:01.211131 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:22:01.213133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:22:01.215246 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:22:01.216215 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:22:01.216215 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:22:01.219132 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:22:01.220232 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:22:01.221185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24B9E9930>]}
[0m23:22:01.222192 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.08s]
[0m23:22:01.223132 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:22:01.223132 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:22:01.224246 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:22:01.225132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:22:01.226131 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:22:01.228224 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:22:01.230137 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:22:01.234131 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:22:01.235131 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:22:01.236169 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:22:01.236169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:01.275132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:22:01.276211 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:22:01.277168 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:22:01.295130 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.018 seconds
[0m23:22:01.299215 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:22:01.299215 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:22:01.300218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:01.302248 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:22:01.303219 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:22:01.304134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:01.305131 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:22:01.306241 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:22:01.306241 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:22:01.309274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:22:01.311217 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:22:01.312216 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:22:01.312216 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:22:01.315168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:22:01.316219 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:22:01.317211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24F8B7190>]}
[0m23:22:01.318133 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.09s]
[0m23:22:01.319132 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:22:01.320134 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:22:01.320134 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:22:01.321136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:22:01.321136 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:22:01.324216 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:22:01.325219 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:22:01.346131 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:22:01.348131 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:22:01.349132 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:22:01.349132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:01.388131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:22:01.389208 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:22:01.389208 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:22:01.395151 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:22:01.398216 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:22:01.398216 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:22:01.399132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:01.401215 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:22:01.401215 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:22:01.402238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:01.403210 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:22:01.403210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:22:01.404232 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:22:01.407422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:22:01.410573 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:22:01.412563 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:22:01.413567 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:22:01.414484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:22:01.416571 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:22:01.416571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E3504C0>]}
[0m23:22:01.417484 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.10s]
[0m23:22:01.418484 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:22:01.418484 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:22:01.419532 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:22:01.420483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:22:01.420483 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:22:01.423483 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:22:01.424611 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:22:01.424611 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:22:01.424611 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:22:01.424611 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:22:01.424611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:01.473371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:22:01.474366 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:22:01.475373 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.sale_category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:22:01.491364 [debug] [Thread-1 (]: SQL status: SELECT 1567 in 0.015 seconds
[0m23:22:01.494456 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:22:01.495456 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:22:01.496367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:22:01.497452 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m23:22:01.497452 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:22:01.497452 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m23:22:01.499367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:01.501449 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_sales__dbt_backup"
[0m23:22:01.502450 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:22:01.502450 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "dbt_project_db"."dwh"."fact_sales__dbt_backup" cascade
[0m23:22:01.503367 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:22:01.504412 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:22:01.505366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616aab7a-fe9f-483e-941d-d9d1d21643b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E192BC0>]}
[0m23:22:01.506366 [info ] [Thread-1 (]: 11 of 11 OK created sql table model dwh.fact_sales ............................. [[32mSELECT 1567[0m in 0.08s]
[0m23:22:01.507366 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:22:01.509367 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:01.509367 [debug] [MainThread]: On master: BEGIN
[0m23:22:01.510396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:22:01.559409 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m23:22:01.559409 [debug] [MainThread]: On master: COMMIT
[0m23:22:01.559409 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:01.560457 [debug] [MainThread]: On master: COMMIT
[0m23:22:01.560457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:22:01.560457 [debug] [MainThread]: On master: Close
[0m23:22:01.561445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:01.561445 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:22:01.561445 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:22:01.562367 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:22:01.562367 [info ] [MainThread]: 
[0m23:22:01.563368 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m23:22:01.565364 [debug] [MainThread]: Command end result
[0m23:22:01.586365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:22:01.589366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:22:01.599467 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:22:01.600371 [info ] [MainThread]: 
[0m23:22:01.601366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:01.601366 [info ] [MainThread]: 
[0m23:22:01.602367 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m23:22:01.603366 [debug] [MainThread]: Command `dbt run` succeeded at 23:22:01.603366 after 2.63 seconds
[0m23:22:01.603366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24BDA03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24BE219C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24E30E4A0>]}
[0m23:22:01.603366 [debug] [MainThread]: Flushing usage events
[0m23:22:02.478923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:31.900524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119B440340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C2D0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C2D0580>]}


============================== 23:35:31.900524 | 73f153ca-851a-4e43-b41d-2d80f96ace7c ==============================
[0m23:35:31.900524 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:35:31.900524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:32.070350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C3BF610>]}
[0m23:35:32.116351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119BBC25F0>]}
[0m23:35:32.117353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:35:32.341108 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:35:32.502310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:35:32.502310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:35:32.508310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:35:32.541219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C889060>]}
[0m23:35:32.606293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:35:32.606293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:35:32.636888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C840370>]}
[0m23:35:32.636888 [info ] [MainThread]: Found 11 models, 2 sources, 433 macros
[0m23:35:32.636888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C8428C0>]}
[0m23:35:32.652733 [info ] [MainThread]: 
[0m23:35:32.653738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:32.653738 [info ] [MainThread]: 
[0m23:35:32.654855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:32.661705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:35:32.749450 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:35:32.749450 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:35:32.750450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:32.897268 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.147 seconds
[0m23:35:32.898306 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:35:32.901201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:35:32.906200 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:35:32.907201 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:35:32.907201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:32.944841 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m23:35:32.945966 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:35:32.945966 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:35:32.953158 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m23:35:32.954163 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:35:32.955151 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:35:32.962246 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:32.962246 [debug] [MainThread]: On master: BEGIN
[0m23:35:32.963257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:33.000246 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:35:33.001238 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:33.001238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:35:33.009240 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:35:33.011246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021199BC2F80>]}
[0m23:35:33.011246 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:33.012281 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:33.012281 [debug] [MainThread]: On master: BEGIN
[0m23:35:33.013159 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:35:33.013159 [debug] [MainThread]: On master: COMMIT
[0m23:35:33.014162 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:33.014162 [debug] [MainThread]: On master: COMMIT
[0m23:35:33.014162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:33.015253 [debug] [MainThread]: On master: Close
[0m23:35:33.020163 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:35:33.021242 [info ] [Thread-1 (]: 1 of 11 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:35:33.022162 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:35:33.022162 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:35:33.029160 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:35:33.031157 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:35:33.088978 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:35:33.105846 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:35:33.105846 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:35:33.106837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:35:33.144161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m23:35:33.144161 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:35:33.145212 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:35:33.172204 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.027 seconds
[0m23:35:33.181218 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:35:33.181218 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:35:33.183218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:33.186228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:35:33.187228 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:35:33.188173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:33.201206 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:35:33.201206 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:35:33.201206 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:35:33.205128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:35:33.210223 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:35:33.213204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:35:33.214206 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:35:33.219131 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:35:33.222208 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:35:33.225127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CCE1930>]}
[0m23:35:33.226157 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.20s]
[0m23:35:33.227131 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:35:33.227131 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:35:33.228128 [info ] [Thread-1 (]: 2 of 11 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:35:33.229146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:35:33.229146 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:35:33.232233 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:35:33.233217 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:35:33.237143 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:35:33.238219 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:35:33.238219 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:35:33.239127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:33.272042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:35:33.272042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:35:33.272042 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:35:33.289861 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.011 seconds
[0m23:35:33.289861 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:35:33.289861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:35:33.289861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.289861 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:35:33.289861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:35:33.289861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.289861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:35:33.289861 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:35:33.289861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:35:33.303785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:33.305458 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:35:33.305458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:35:33.305458 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:35:33.305458 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:35:33.305458 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:35:33.305458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CCE25F0>]}
[0m23:35:33.305458 [info ] [Thread-1 (]: 2 of 11 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.08s]
[0m23:35:33.305458 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:35:33.305458 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:35:33.305458 [info ] [Thread-1 (]: 3 of 11 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:35:33.305458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:35:33.305458 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:35:33.323343 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:35:33.324657 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:35:33.324657 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:35:33.324657 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:35:33.324657 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:35:33.324657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:33.372607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:35:33.374644 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:35:33.374644 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:35:33.400112 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.025 seconds
[0m23:35:33.405112 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:35:33.406117 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:35:33.407112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.410112 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:35:33.410112 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:35:33.411113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.414132 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:35:33.414132 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:35:33.415128 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:35:33.418127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:33.421329 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:35:33.421928 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:35:33.422526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:35:33.426819 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:35:33.429209 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:35:33.430082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CDEFA90>]}
[0m23:35:33.431183 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.12s]
[0m23:35:33.432269 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:35:33.433520 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:35:33.434071 [info ] [Thread-1 (]: 4 of 11 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:35:33.435166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:35:33.435773 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:35:33.439526 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:35:33.441350 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:35:33.442347 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:35:33.445503 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:35:33.445503 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:35:33.445503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:33.524386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m23:35:33.524386 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:35:33.525385 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:35:33.546388 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.021 seconds
[0m23:35:33.550385 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:35:33.551386 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:35:33.552427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.554385 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:35:33.555385 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:35:33.556385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.557385 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:35:33.558385 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:35:33.558385 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:35:33.560474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:33.562385 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:35:33.563385 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:35:33.563385 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:35:33.566471 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:35:33.567386 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:35:33.567386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CE00280>]}
[0m23:35:33.568385 [info ] [Thread-1 (]: 4 of 11 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.13s]
[0m23:35:33.569385 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:35:33.570394 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:35:33.571388 [info ] [Thread-1 (]: 5 of 11 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:35:33.572387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:35:33.572387 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:35:33.576466 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.578404 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:35:33.583476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.584483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.584483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:35:33.585392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:33.622023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:35:33.622023 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.622023 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:35:33.649141 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.021 seconds
[0m23:35:33.652140 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.652140 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:35:33.653147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.656146 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.657148 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:35:33.658158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:33.659142 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:35:33.660090 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.660090 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:35:33.662139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:35:33.664052 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:35:33.665052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:35:33.665052 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:35:33.668141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:35:33.669051 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:35:33.670052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CD0DED0>]}
[0m23:35:33.671063 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m23:35:33.672053 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:35:33.673065 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:35:33.673065 [info ] [Thread-1 (]: 6 of 11 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:35:33.674055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:35:33.675063 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:35:33.678052 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:35:33.680072 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:35:33.684060 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:35:33.685062 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:35:33.686053 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:35:33.687053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:33.731052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m23:35:33.732052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:35:33.732052 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:35:33.743148 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.011 seconds
[0m23:35:33.749052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:35:33.749052 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:35:33.750051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.754053 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:35:33.754053 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:35:33.755067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:33.758062 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:35:33.758062 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:35:33.758062 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:35:33.760061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:35:33.763051 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:35:33.763051 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:35:33.764052 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:35:33.767062 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:35:33.769052 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:35:33.769052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CE3EE00>]}
[0m23:35:33.770052 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.09s]
[0m23:35:33.771111 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:35:33.772060 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:35:33.772060 [info ] [Thread-1 (]: 7 of 11 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:35:33.773068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:35:33.774061 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:35:33.776061 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:35:33.777061 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:35:33.781061 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:35:33.783092 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:35:33.783092 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:35:33.783092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:33.824486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:35:33.824486 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:35:33.824486 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:35:33.831575 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:35:33.834483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:35:33.835484 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:35:33.835484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:33.839483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:35:33.839483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:35:33.840483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:33.842483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:35:33.842483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:35:33.842483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:35:33.844595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:33.847484 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:35:33.848483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:35:33.848483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:35:33.851610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:35:33.853490 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:35:33.854484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119DEA0700>]}
[0m23:35:33.854484 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:35:33.856485 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:35:33.856485 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:35:33.857509 [info ] [Thread-1 (]: 8 of 11 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:35:33.858484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:35:33.858484 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:35:33.861483 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:35:33.862484 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:35:33.865483 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:35:33.866483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:35:33.867484 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:35:33.868484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:34.016930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m23:35:34.016930 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:35:34.016930 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:35:34.023673 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.006 seconds
[0m23:35:34.026732 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:35:34.027729 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:35:34.028683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:34.030724 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:35:34.030724 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:35:34.031725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:34.032644 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:35:34.033772 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:35:34.033772 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:35:34.036792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:35:34.039723 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:35:34.039723 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:35:34.040731 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:35:34.043678 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:35:34.045645 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:35:34.045645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119DEA0700>]}
[0m23:35:34.046661 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.19s]
[0m23:35:34.047643 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:35:34.048643 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:35:34.049644 [info ] [Thread-1 (]: 9 of 11 START sql table model dwh.dim_status ................................... [RUN]
[0m23:35:34.050645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:35:34.050645 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:35:34.053644 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:35:34.054645 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:35:34.058643 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:35:34.060645 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:35:34.060645 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:35:34.061643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:34.102629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:35:34.103564 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:35:34.103564 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:35:34.125653 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.022 seconds
[0m23:35:34.128641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:35:34.129640 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:35:34.129640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:34.132639 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:35:34.132639 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:35:34.133641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:34.135652 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:35:34.135652 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:35:34.136640 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:35:34.139676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:35:34.141646 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:35:34.142642 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:35:34.142642 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:35:34.145638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:35:34.146638 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:35:34.147656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119935EB30>]}
[0m23:35:34.148562 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.10s]
[0m23:35:34.149565 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:35:34.150563 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:35:34.150563 [info ] [Thread-1 (]: 10 of 11 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:35:34.151565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:35:34.151565 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:35:34.153561 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:35:34.154650 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:35:34.171451 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:35:34.172302 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:35:34.172302 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:35:34.172302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:34.332487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m23:35:34.332487 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:35:34.332487 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:35:34.338649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:35:34.340654 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:35:34.341654 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:35:34.342599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:34.345604 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:35:34.345604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:35:34.346925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:34.348016 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:35:34.348016 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:35:34.349025 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:35:34.351933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:35:34.354026 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:35:34.356015 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:35:34.357024 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:35:34.357932 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:35:34.359025 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:35:34.360172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119DEEE0E0>]}
[0m23:35:34.360172 [info ] [Thread-1 (]: 10 of 11 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.21s]
[0m23:35:34.360172 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:35:34.360172 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:35:34.360172 [info ] [Thread-1 (]: 11 of 11 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:35:34.360172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:35:34.360172 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:35:34.360172 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:35:34.360172 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:35:34.360172 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:35:34.360172 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:35:34.360172 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:35:34.360172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:34.405889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:35:34.405889 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:35:34.405889 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.sale_category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(13,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(13,2) AS expected_value,
    s.actual_value::DECIMAL(13,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:35:34.422527 [debug] [Thread-1 (]: SQL status: SELECT 1567 in 0.014 seconds
[0m23:35:34.422527 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:35:34.422527 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales" rename to "fact_sales__dbt_backup"
[0m23:35:34.422527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:34.439051 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:35:34.440067 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:35:34.440966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:34.441968 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m23:35:34.441968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:35:34.442999 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m23:35:34.445075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:34.447006 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_sales__dbt_backup"
[0m23:35:34.448049 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:35:34.448049 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "dbt_project_db"."dwh"."fact_sales__dbt_backup" cascade
[0m23:35:34.452967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:35:34.455219 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:35:34.456199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f153ca-851a-4e43-b41d-2d80f96ace7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119931A080>]}
[0m23:35:34.457185 [info ] [Thread-1 (]: 11 of 11 OK created sql table model dwh.fact_sales ............................. [[32mSELECT 1567[0m in 0.10s]
[0m23:35:34.458185 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:35:34.459202 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:34.460187 [debug] [MainThread]: On master: BEGIN
[0m23:35:34.460187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:34.501624 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m23:35:34.501624 [debug] [MainThread]: On master: COMMIT
[0m23:35:34.502707 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:34.502707 [debug] [MainThread]: On master: COMMIT
[0m23:35:34.502707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:34.503626 [debug] [MainThread]: On master: Close
[0m23:35:34.504726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:34.504726 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:35:34.505626 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:35:34.505626 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m23:35:34.505626 [info ] [MainThread]: 
[0m23:35:34.506623 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m23:35:34.509626 [debug] [MainThread]: Command end result
[0m23:35:34.532625 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:35:34.534626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:35:34.542636 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:35:34.543629 [info ] [MainThread]: 
[0m23:35:34.544622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:34.544622 [info ] [MainThread]: 
[0m23:35:34.545625 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m23:35:34.546624 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:34.546624 after 2.71 seconds
[0m23:35:34.547622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119B440340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C86A3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021195C149A0>]}
[0m23:35:34.547622 [debug] [MainThread]: Flushing usage events
[0m23:35:35.419631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:10.236746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB64300340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB66133B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB66133FD0>]}


============================== 23:37:10.241783 | 04863ab0-1c93-45b7-90a0-9b84718f1384 ==============================
[0m23:37:10.241783 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:37:10.243669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:37:10.407390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04863ab0-1c93-45b7-90a0-9b84718f1384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB6625ADA0>]}
[0m23:37:10.453342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04863ab0-1c93-45b7-90a0-9b84718f1384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB66166590>]}
[0m23:37:10.455268 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:37:10.671122 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:37:10.829820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:37:10.830818 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\fact_leads.sql
[0m23:37:10.984179 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_leads' (models\marts\fact_leads.sql) depends on a node named 'dim_customer' which was not found
[0m23:37:10.984179 [debug] [MainThread]: Command `dbt run` failed at 23:37:10.984179 after 0.82 seconds
[0m23:37:10.984179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB64300340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB66236440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB66858970>]}
[0m23:37:10.984179 [debug] [MainThread]: Flushing usage events
[0m23:37:11.671521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:38.215004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68CC20340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68EA4BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68EA4BF40>]}


============================== 23:38:38.220005 | c7fcf485-4252-4b56-96fb-c90db970761e ==============================
[0m23:38:38.220005 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:38:38.221004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:38:38.400504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7fcf485-4252-4b56-96fb-c90db970761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68EB73610>]}
[0m23:38:38.449419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7fcf485-4252-4b56-96fb-c90db970761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68E3725F0>]}
[0m23:38:38.450936 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:38:38.695871 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:38:38.865453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:38:38.881015 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\fact_leads.sql
[0m23:38:38.881015 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:38:39.056077 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_leads' (models\marts\fact_leads.sql) depends on a node named 'dim_lead_sources' which was not found
[0m23:38:39.058070 [debug] [MainThread]: Command `dbt run` failed at 23:38:39.058070 after 0.92 seconds
[0m23:38:39.058070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68CC20340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68CCA0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68F177220>]}
[0m23:38:39.059145 [debug] [MainThread]: Flushing usage events
[0m23:38:39.781997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:32.808125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034ECF0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034FB80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034FB80580>]}


============================== 23:42:32.823750 | 1401f6b9-5168-44b6-a89e-272d836baa21 ==============================
[0m23:42:32.823750 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:42:32.823750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:32.988237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034FC4EA40>]}
[0m23:42:33.041391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034F4BDD50>]}
[0m23:42:33.043514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:33.258819 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:42:33.422025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:42:33.422025 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\fact_leads.sql
[0m23:42:33.423020 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_sales.sql
[0m23:42:33.625873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:42:33.638878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203512A5090>]}
[0m23:42:33.711100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:42:33.712119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:42:33.741125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203500F1210>]}
[0m23:42:33.741125 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m23:42:33.741125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203500F0760>]}
[0m23:42:33.741125 [info ] [MainThread]: 
[0m23:42:33.741125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:33.741125 [info ] [MainThread]: 
[0m23:42:33.741125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:33.758784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:42:33.883632 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:42:33.884611 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:42:33.884611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:33.928529 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m23:42:33.929615 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:42:33.932531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:42:33.938531 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:42:33.938531 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:42:33.938531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:33.975528 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:42:33.976609 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:42:33.976609 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:42:33.983528 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m23:42:33.984634 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:42:33.985531 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:42:33.991634 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:33.991634 [debug] [MainThread]: On master: BEGIN
[0m23:42:33.991634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:34.028528 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:42:34.029626 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.029626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:34.038528 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:42:34.039647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BF0A0E0>]}
[0m23:42:34.040613 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:34.040613 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.040613 [debug] [MainThread]: On master: BEGIN
[0m23:42:34.041607 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:34.041607 [debug] [MainThread]: On master: COMMIT
[0m23:42:34.042605 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.042605 [debug] [MainThread]: On master: COMMIT
[0m23:42:34.042605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:34.043566 [debug] [MainThread]: On master: Close
[0m23:42:34.049527 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m23:42:34.049527 [info ] [Thread-1 (]: 1 of 12 START sql table model dwh.dim_campaign ................................. [RUN]
[0m23:42:34.050528 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m23:42:34.050528 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m23:42:34.057620 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m23:42:34.058663 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m23:42:34.092612 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m23:42:34.094532 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:42:34.095611 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m23:42:34.095611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:34.133528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:42:34.133528 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:42:34.134606 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m23:42:34.159720 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.025 seconds
[0m23:42:34.167726 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:42:34.168726 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m23:42:34.169747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.171752 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:42:34.171752 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m23:42:34.172838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.184944 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:42:34.185935 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:42:34.185935 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m23:42:34.187846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:34.193846 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m23:42:34.197846 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m23:42:34.197846 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m23:42:34.203116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:42:34.205203 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m23:42:34.208115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034FB608E0>]}
[0m23:42:34.209182 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.16s]
[0m23:42:34.210117 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m23:42:34.210117 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m23:42:34.211123 [info ] [Thread-1 (]: 2 of 12 START sql table model dwh.dim_date ..................................... [RUN]
[0m23:42:34.212116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m23:42:34.212116 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m23:42:34.215243 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m23:42:34.216200 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m23:42:34.219210 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m23:42:34.221120 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:42:34.221120 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m23:42:34.221120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.263847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:42:34.264807 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:42:34.264807 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m23:42:34.276806 [debug] [Thread-1 (]: SQL status: SELECT 3105 in 0.011 seconds
[0m23:42:34.280803 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:42:34.280803 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m23:42:34.281804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.284803 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:42:34.284803 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:42:34.285848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.286805 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:42:34.287804 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:42:34.287804 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m23:42:34.290807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:34.292803 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m23:42:34.292803 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m23:42:34.293804 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m23:42:34.298805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:42:34.299805 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m23:42:34.300804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034D8EBB50>]}
[0m23:42:34.300804 [info ] [Thread-1 (]: 2 of 12 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3105[0m in 0.09s]
[0m23:42:34.302826 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m23:42:34.302826 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m23:42:34.303806 [info ] [Thread-1 (]: 3 of 12 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m23:42:34.304805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m23:42:34.304805 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m23:42:34.307806 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m23:42:34.308816 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m23:42:34.311806 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m23:42:34.313807 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:42:34.313807 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m23:42:34.313807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.356189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:42:34.356189 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:42:34.357298 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m23:42:34.379288 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.022 seconds
[0m23:42:34.382280 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:42:34.382280 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m23:42:34.383312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.386298 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:42:34.386298 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m23:42:34.387196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.388188 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:42:34.388188 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:42:34.389223 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m23:42:34.390824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:34.393919 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m23:42:34.394849 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m23:42:34.394849 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m23:42:34.397859 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:42:34.398909 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m23:42:34.399914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203518AD690>]}
[0m23:42:34.400830 [info ] [Thread-1 (]: 3 of 12 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m23:42:34.401831 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m23:42:34.402862 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m23:42:34.402862 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m23:42:34.403832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m23:42:34.404830 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m23:42:34.406913 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m23:42:34.407915 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m23:42:34.412216 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m23:42:34.413818 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:42:34.413818 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m23:42:34.413818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.456083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:42:34.456083 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:42:34.456083 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m23:42:34.479187 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.022 seconds
[0m23:42:34.483170 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:42:34.483170 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m23:42:34.484269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.486277 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:42:34.486277 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m23:42:34.487675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.488680 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:42:34.488680 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:42:34.489680 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m23:42:34.492344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:42:34.495165 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m23:42:34.496259 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m23:42:34.496259 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m23:42:34.499163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:42:34.501255 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m23:42:34.501255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034D8EBB50>]}
[0m23:42:34.502192 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.10s]
[0m23:42:34.503165 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m23:42:34.504180 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m23:42:34.505164 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m23:42:34.505164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m23:42:34.506172 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m23:42:34.508201 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.510174 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m23:42:34.516258 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.518252 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.519165 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m23:42:34.519165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.546868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:42:34.546868 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.546868 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m23:42:34.582099 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.022 seconds
[0m23:42:34.585186 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.585186 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m23:42:34.586373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.588381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.588381 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m23:42:34.589572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.591611 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:42:34.591611 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.592700 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m23:42:34.593656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:34.596050 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m23:42:34.597138 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m23:42:34.597138 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m23:42:34.600230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:42:34.602269 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m23:42:34.602269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203518AD690>]}
[0m23:42:34.603194 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m23:42:34.605207 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m23:42:34.605207 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m23:42:34.606207 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh.dim_property_type ............................ [RUN]
[0m23:42:34.607192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m23:42:34.607192 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m23:42:34.611199 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m23:42:34.612223 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m23:42:34.617273 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m23:42:34.618290 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:42:34.619217 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m23:42:34.619217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.647826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:42:34.647826 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:42:34.647826 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m23:42:34.668427 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.008 seconds
[0m23:42:34.671514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:42:34.672518 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m23:42:34.672518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.676514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:42:34.676514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m23:42:34.678429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.679428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:42:34.680429 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:42:34.680429 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m23:42:34.682526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:34.684516 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m23:42:34.685514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m23:42:34.685514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m23:42:34.688428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:42:34.689523 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m23:42:34.689523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034D8EBB50>]}
[0m23:42:34.690429 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m23:42:34.692437 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m23:42:34.692437 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m23:42:34.693428 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m23:42:34.694430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m23:42:34.695433 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m23:42:34.697515 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m23:42:34.699439 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m23:42:34.702514 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m23:42:34.703510 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:42:34.704486 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m23:42:34.704486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.745427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:42:34.746473 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:42:34.746473 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m23:42:34.754466 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:42:34.758513 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:42:34.758513 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m23:42:34.759513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.762429 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:42:34.763492 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m23:42:34.764428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.766427 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:42:34.766427 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:42:34.766427 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m23:42:34.768469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:34.771428 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m23:42:34.771428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m23:42:34.772514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m23:42:34.775428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:42:34.776466 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m23:42:34.777513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203518B88E0>]}
[0m23:42:34.779428 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m23:42:34.780428 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m23:42:34.781436 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m23:42:34.781436 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m23:42:34.782428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m23:42:34.783527 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m23:42:34.787473 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m23:42:34.788512 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m23:42:34.792428 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m23:42:34.794430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:42:34.795437 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m23:42:34.795437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.839428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:42:34.839428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:42:34.839428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m23:42:34.847429 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.007 seconds
[0m23:42:34.851512 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:42:34.852516 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m23:42:34.853430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.855518 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:42:34.855518 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m23:42:34.856521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.857431 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:42:34.858430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:42:34.858430 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m23:42:34.860509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:34.863516 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m23:42:34.863516 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m23:42:34.864520 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m23:42:34.867429 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:42:34.868522 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m23:42:34.869429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034FDB2290>]}
[0m23:42:34.869429 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.09s]
[0m23:42:34.871439 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m23:42:34.871439 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m23:42:34.872444 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh.dim_status ................................... [RUN]
[0m23:42:34.873431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m23:42:34.873431 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m23:42:34.876516 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m23:42:34.877513 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m23:42:34.880518 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m23:42:34.882434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:42:34.882434 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m23:42:34.883523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.922429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:42:34.923519 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:42:34.923519 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m23:42:34.945431 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.021 seconds
[0m23:42:34.949523 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:42:34.950521 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m23:42:34.950521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.953514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:42:34.953514 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m23:42:34.954517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.956427 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:42:34.956427 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:42:34.956427 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m23:42:34.959564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:34.962429 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m23:42:34.963526 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m23:42:34.963526 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m23:42:34.966428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:42:34.967513 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m23:42:34.968429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034FDB2290>]}
[0m23:42:34.968429 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.09s]
[0m23:42:34.969448 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m23:42:34.970428 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m23:42:34.970428 [info ] [Thread-1 (]: 10 of 12 START sql view model dwh.dim_time ..................................... [RUN]
[0m23:42:34.972428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m23:42:34.972428 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m23:42:34.974429 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m23:42:34.975499 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m23:42:34.991511 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m23:42:34.993469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:42:34.993469 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m23:42:34.994450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:35.036429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:42:35.037505 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:42:35.037505 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m23:42:35.043429 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:42:35.046516 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:42:35.047513 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m23:42:35.048428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:35.051430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:42:35.051430 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:42:35.052430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:35.053525 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:42:35.054521 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:42:35.054521 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m23:42:35.056456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:35.058512 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m23:42:35.060518 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m23:42:35.060518 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m23:42:35.062581 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:42:35.062581 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m23:42:35.062581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020350121120>]}
[0m23:42:35.062581 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:42:35.062581 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m23:42:35.062581 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m23:42:35.062581 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh.fact_sales .................................. [RUN]
[0m23:42:35.062581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m23:42:35.062581 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m23:42:35.062581 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m23:42:35.062581 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m23:42:35.062581 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m23:42:35.062581 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:42:35.078209 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m23:42:35.079420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:35.120151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:42:35.120151 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:42:35.121062 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.sale_category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(15,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(15,2) AS expected_value,
    s.actual_value::DECIMAL(15,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m23:42:35.134062 [debug] [Thread-1 (]: SQL status: SELECT 1567 in 0.013 seconds
[0m23:42:35.137061 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:42:35.137061 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales" rename to "fact_sales__dbt_backup"
[0m23:42:35.138061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:35.141061 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:42:35.141061 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:42:35.142061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:35.143062 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m23:42:35.144066 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:42:35.144066 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m23:42:35.147155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:35.150147 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_sales__dbt_backup"
[0m23:42:35.151149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m23:42:35.151149 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "dbt_project_db"."dwh"."fact_sales__dbt_backup" cascade
[0m23:42:35.155060 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:42:35.157148 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m23:42:35.157148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034F4AAC20>]}
[0m23:42:35.158096 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh.fact_sales ............................. [[32mSELECT 1567[0m in 0.09s]
[0m23:42:35.159108 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m23:42:35.160062 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m23:42:35.160062 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh.fact_leads .................................. [RUN]
[0m23:42:35.161069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fact_sales, now model.my_dbt_project.fact_leads)
[0m23:42:35.162061 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m23:42:35.169078 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m23:42:35.171060 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m23:42:35.178059 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m23:42:35.180059 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:42:35.180059 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m23:42:35.181062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:35.225148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m23:42:35.226080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:42:35.226679 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads"  -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_name

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign_name

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type_name

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source_name -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m23:42:35.228526 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "l"
LINE 71:     ON l.status_name = ds.status_name
                ^

[0m23:42:35.228526 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: ROLLBACK
[0m23:42:35.229585 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m23:42:35.234462 [debug] [Thread-1 (]: Database Error in model fact_leads (models\marts\fact_leads.sql)
  missing FROM-clause entry for table "l"
  LINE 71:     ON l.status_name = ds.status_name
                  ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql
[0m23:42:35.235816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1401f6b9-5168-44b6-a89e-272d836baa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020351863A00>]}
[0m23:42:35.236892 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model dwh.fact_leads ......................... [[31mERROR[0m in 0.07s]
[0m23:42:35.238167 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m23:42:35.238808 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_leads' to be skipped because of status 'error'.  Reason: Database Error in model fact_leads (models\marts\fact_leads.sql)
  missing FROM-clause entry for table "l"
  LINE 71:     ON l.status_name = ds.status_name
                  ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql.
[0m23:42:35.241043 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:35.241043 [debug] [MainThread]: On master: BEGIN
[0m23:42:35.241043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:35.388371 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m23:42:35.389455 [debug] [MainThread]: On master: COMMIT
[0m23:42:35.389455 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:35.390461 [debug] [MainThread]: On master: COMMIT
[0m23:42:35.390461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:35.391411 [debug] [MainThread]: On master: Close
[0m23:42:35.391411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:35.391411 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:42:35.392373 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:42:35.392373 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m23:42:35.393374 [info ] [MainThread]: 
[0m23:42:35.393374 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m23:42:35.396425 [debug] [MainThread]: Command end result
[0m23:42:35.417484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:42:35.419457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:42:35.426425 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:42:35.426425 [info ] [MainThread]: 
[0m23:42:35.427685 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:42:35.428696 [info ] [MainThread]: 
[0m23:42:35.429693 [error] [MainThread]:   Database Error in model fact_leads (models\marts\fact_leads.sql)
  missing FROM-clause entry for table "l"
  LINE 71:     ON l.status_name = ds.status_name
                  ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql
[0m23:42:35.430707 [info ] [MainThread]: 
[0m23:42:35.431696 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m23:42:35.433525 [debug] [MainThread]: Command `dbt run` failed at 23:42:35.433525 after 2.69 seconds
[0m23:42:35.433525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034ECF0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034F4BDD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034ED71FC0>]}
[0m23:42:35.434522 [debug] [MainThread]: Flushing usage events
[0m23:42:36.315352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:59.127356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE9764310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEA5C3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEA5C3F40>]}


============================== 23:43:59.131432 | a6e1eea8-e429-4769-aec7-5a1142000715 ==============================
[0m23:43:59.131432 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:43:59.133399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_leads', 'send_anonymous_usage_stats': 'True'}
[0m23:43:59.293418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEA6EB100>]}
[0m23:43:59.349174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE9F2EC50>]}
[0m23:43:59.350217 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:43:59.569695 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:43:59.740414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:59.741420 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_leads.sql
[0m23:43:59.944045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:43:59.960735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEAD40FD0>]}
[0m23:44:00.029820 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:44:00.033736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:44:00.066736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEAB6CD30>]}
[0m23:44:00.067736 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m23:44:00.068788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEAB6E980>]}
[0m23:44:00.069814 [info ] [MainThread]: 
[0m23:44:00.070749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:00.070749 [info ] [MainThread]: 
[0m23:44:00.071768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:44:00.072841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:44:00.198196 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:44:00.199190 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:44:00.199190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:00.248282 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m23:44:00.249268 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:44:00.255188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:44:00.260284 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:44:00.260284 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:44:00.260284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:00.296190 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m23:44:00.297221 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:44:00.297221 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:44:00.303191 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m23:44:00.304268 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:44:00.305295 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:44:00.311188 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:00.312188 [debug] [MainThread]: On master: BEGIN
[0m23:44:00.312188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:00.344914 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:44:00.344914 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:00.344914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:44:00.344914 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:44:00.344914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE6976140>]}
[0m23:44:00.344914 [debug] [MainThread]: On master: ROLLBACK
[0m23:44:00.360542 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:00.360542 [debug] [MainThread]: On master: BEGIN
[0m23:44:00.360542 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:44:00.360542 [debug] [MainThread]: On master: COMMIT
[0m23:44:00.360542 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:00.360542 [debug] [MainThread]: On master: COMMIT
[0m23:44:00.360542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:44:00.360542 [debug] [MainThread]: On master: Close
[0m23:44:00.360542 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m23:44:00.360542 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_leads .................................... [RUN]
[0m23:44:00.360542 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.fact_leads'
[0m23:44:00.360542 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m23:44:00.379123 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m23:44:00.379123 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m23:44:00.416417 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m23:44:00.417495 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:44:00.418463 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m23:44:00.418463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:44:00.457418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:44:00.457418 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:44:00.458498 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads" l -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_name

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign_name

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type_name

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source_name -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m23:44:00.459518 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dmoc.method_name does not exist
LINE 75:     ON l.method_of_contact = dmoc.method_name
                                      ^

[0m23:44:00.459518 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: ROLLBACK
[0m23:44:00.460501 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m23:44:00.465459 [debug] [Thread-1 (]: Database Error in model fact_leads (models\marts\fact_leads.sql)
  column dmoc.method_name does not exist
  LINE 75:     ON l.method_of_contact = dmoc.method_name
                                        ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql
[0m23:44:00.467499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e1eea8-e429-4769-aec7-5a1142000715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE8355330>]}
[0m23:44:00.468417 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.fact_leads ........................... [[31mERROR[0m in 0.10s]
[0m23:44:00.469417 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m23:44:00.469417 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_leads' to be skipped because of status 'error'.  Reason: Database Error in model fact_leads (models\marts\fact_leads.sql)
  column dmoc.method_name does not exist
  LINE 75:     ON l.method_of_contact = dmoc.method_name
                                        ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql.
[0m23:44:00.471420 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:00.472492 [debug] [MainThread]: On master: BEGIN
[0m23:44:00.472492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:44:00.512435 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:44:00.513502 [debug] [MainThread]: On master: COMMIT
[0m23:44:00.513502 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:00.513502 [debug] [MainThread]: On master: COMMIT
[0m23:44:00.514524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:44:00.514524 [debug] [MainThread]: On master: Close
[0m23:44:00.514524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:00.515416 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:44:00.515416 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:44:00.515416 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m23:44:00.516416 [info ] [MainThread]: 
[0m23:44:00.517416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m23:44:00.518460 [debug] [MainThread]: Command end result
[0m23:44:00.537417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:44:00.540528 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:44:00.545496 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:44:00.546531 [info ] [MainThread]: 
[0m23:44:00.547420 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:44:00.548418 [info ] [MainThread]: 
[0m23:44:00.549417 [error] [MainThread]:   Database Error in model fact_leads (models\marts\fact_leads.sql)
  column dmoc.method_name does not exist
  LINE 75:     ON l.method_of_contact = dmoc.method_name
                                        ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql
[0m23:44:00.550416 [info ] [MainThread]: 
[0m23:44:00.550416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:44:00.552451 [debug] [MainThread]: Command `dbt run` failed at 23:44:00.552451 after 1.50 seconds
[0m23:44:00.554416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE9764310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEAD037C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEAD09AB0>]}
[0m23:44:00.554416 [debug] [MainThread]: Flushing usage events
[0m23:44:01.259476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:54.761138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5E304310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F173BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F173F40>]}


============================== 23:45:54.764056 | a1f45bc9-da8f-4910-add7-8f1464ebb371 ==============================
[0m23:45:54.764056 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:45:54.766057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:45:54.954856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F29B100>]}
[0m23:45:54.988278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5EAD2C50>]}
[0m23:45:55.003879 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:55.262386 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:45:55.434926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:55.434926 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_leads.sql
[0m23:45:55.645229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:45:55.661225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F8F4FD0>]}
[0m23:45:55.738935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:45:55.738935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:45:55.772658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F71CD90>]}
[0m23:45:55.772658 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m23:45:55.773658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F71D030>]}
[0m23:45:55.775658 [info ] [MainThread]: 
[0m23:45:55.775658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:55.776658 [info ] [MainThread]: 
[0m23:45:55.777658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:55.779658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:45:55.899661 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:45:55.900661 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:45:55.900661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:55.942658 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m23:45:55.944678 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:45:55.949689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:45:55.954742 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:45:55.954742 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:45:55.954742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:55.991138 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m23:45:55.991138 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:45:55.991138 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:45:55.998137 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m23:45:55.999222 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:45:56.000141 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:45:56.006276 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:56.007276 [debug] [MainThread]: On master: BEGIN
[0m23:45:56.007276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:56.043274 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m23:45:56.044365 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:56.044365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:56.053274 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:45:56.054364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5B51A140>]}
[0m23:45:56.054364 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:56.055361 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:56.055361 [debug] [MainThread]: On master: BEGIN
[0m23:45:56.056360 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:45:56.056360 [debug] [MainThread]: On master: COMMIT
[0m23:45:56.057275 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:56.057275 [debug] [MainThread]: On master: COMMIT
[0m23:45:56.057275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:45:56.058275 [debug] [MainThread]: On master: Close
[0m23:45:56.063279 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m23:45:56.064361 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_leads .................................... [RUN]
[0m23:45:56.065303 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.fact_leads'
[0m23:45:56.065303 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m23:45:56.074275 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m23:45:56.075357 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m23:45:56.114363 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m23:45:56.116276 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:45:56.116276 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m23:45:56.117274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:56.154281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m23:45:56.154281 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:45:56.155362 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads" l -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_of_contact

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source_name -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m23:45:56.156274 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dls.lead_source_name does not exist
LINE 87:     ON l.lead_source = dls.lead_source_name -- Cast to VARCH...
                                ^

[0m23:45:56.156274 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: ROLLBACK
[0m23:45:56.157364 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m23:45:56.161275 [debug] [Thread-1 (]: Database Error in model fact_leads (models\marts\fact_leads.sql)
  column dls.lead_source_name does not exist
  LINE 87:     ON l.lead_source = dls.lead_source_name -- Cast to VARCH...
                                  ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql
[0m23:45:56.164370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1f45bc9-da8f-4910-add7-8f1464ebb371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5CEF5330>]}
[0m23:45:56.164370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.fact_leads ........................... [[31mERROR[0m in 0.10s]
[0m23:45:56.165291 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m23:45:56.166359 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_leads' to be skipped because of status 'error'.  Reason: Database Error in model fact_leads (models\marts\fact_leads.sql)
  column dls.lead_source_name does not exist
  LINE 87:     ON l.lead_source = dls.lead_source_name -- Cast to VARCH...
                                  ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql.
[0m23:45:56.168285 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:56.168285 [debug] [MainThread]: On master: BEGIN
[0m23:45:56.168285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:56.208381 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:45:56.208381 [debug] [MainThread]: On master: COMMIT
[0m23:45:56.209457 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:56.209457 [debug] [MainThread]: On master: COMMIT
[0m23:45:56.209457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:45:56.210422 [debug] [MainThread]: On master: Close
[0m23:45:56.210422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:56.210422 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:45:56.211379 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:45:56.211379 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m23:45:56.211379 [info ] [MainThread]: 
[0m23:45:56.212396 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m23:45:56.213381 [debug] [MainThread]: Command end result
[0m23:45:56.232400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:45:56.234405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:45:56.241422 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:45:56.241422 [info ] [MainThread]: 
[0m23:45:56.241422 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:45:56.241422 [info ] [MainThread]: 
[0m23:45:56.241422 [error] [MainThread]:   Database Error in model fact_leads (models\marts\fact_leads.sql)
  column dls.lead_source_name does not exist
  LINE 87:     ON l.lead_source = dls.lead_source_name -- Cast to VARCH...
                                  ^
  compiled code at target\run\my_dbt_project\models\marts\fact_leads.sql
[0m23:45:56.241422 [info ] [MainThread]: 
[0m23:45:56.241422 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:45:56.241422 [debug] [MainThread]: Command `dbt run` failed at 23:45:56.241422 after 1.56 seconds
[0m23:45:56.241422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5E304310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5E3962F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC5F593130>]}
[0m23:45:56.241422 [debug] [MainThread]: Flushing usage events
[0m23:45:56.961433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:26.320458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269416203A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942483C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942483F70>]}


============================== 23:46:26.325456 | d0097923-522e-4820-972c-8113bc6a4b5a ==============================
[0m23:46:26.325456 [info ] [MainThread]: Running with dbt=1.9.5
[0m23:46:26.326456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_leads', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:46:26.484898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269425AA2C0>]}
[0m23:46:26.540882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269425AA200>]}
[0m23:46:26.542818 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:46:26.759809 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m23:46:26.925004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:26.925004 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\fact_leads.sql
[0m23:46:27.122875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m23:46:27.138679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942C01060>]}
[0m23:46:27.208775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:46:27.212770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:46:27.244414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942C014E0>]}
[0m23:46:27.245412 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m23:46:27.246414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942A056C0>]}
[0m23:46:27.247497 [info ] [MainThread]: 
[0m23:46:27.248449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:27.248449 [info ] [MainThread]: 
[0m23:46:27.249415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:27.251416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m23:46:27.375939 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m23:46:27.376899 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m23:46:27.376899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:27.420861 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m23:46:27.421965 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m23:46:27.426968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m23:46:27.431945 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:46:27.431945 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m23:46:27.432895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:27.468862 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:46:27.469940 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m23:46:27.469940 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m23:46:27.476862 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m23:46:27.477951 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m23:46:27.478944 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m23:46:27.484943 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:27.484943 [debug] [MainThread]: On master: BEGIN
[0m23:46:27.484943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:27.509624 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:46:27.509624 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:27.509624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:27.525261 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:46:27.525261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002693E83A0B0>]}
[0m23:46:27.525261 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:27.525261 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:27.525261 [debug] [MainThread]: On master: BEGIN
[0m23:46:27.525261 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:46:27.525261 [debug] [MainThread]: On master: COMMIT
[0m23:46:27.525261 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:27.525261 [debug] [MainThread]: On master: COMMIT
[0m23:46:27.525261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:27.525261 [debug] [MainThread]: On master: Close
[0m23:46:27.541143 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m23:46:27.542226 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_leads .................................... [RUN]
[0m23:46:27.543142 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.fact_leads'
[0m23:46:27.544225 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m23:46:27.551242 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m23:46:27.552239 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m23:46:27.586219 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m23:46:27.587228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:46:27.588149 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m23:46:27.588149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:46:27.627190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:46:27.627190 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:46:27.627190 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads" l -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_of_contact

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source  -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m23:46:27.925104 [debug] [Thread-1 (]: SQL status: SELECT 55845 in 0.312 seconds
[0m23:46:27.940815 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:46:27.940815 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads__dbt_tmp" rename to "fact_leads"
[0m23:46:27.940815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:27.956451 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m23:46:27.956451 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:46:27.956451 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m23:46:27.956451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:46:27.972085 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_leads__dbt_backup"
[0m23:46:27.972085 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m23:46:27.972085 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
drop table if exists "dbt_project_db"."dwh"."fact_leads__dbt_backup" cascade
[0m23:46:27.972085 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:46:27.972085 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m23:46:27.972085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0097923-522e-4820-972c-8113bc6a4b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942609330>]}
[0m23:46:27.972085 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.fact_leads ............................... [[32mSELECT 55845[0m in 0.43s]
[0m23:46:27.972085 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m23:46:27.972085 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:27.972085 [debug] [MainThread]: On master: BEGIN
[0m23:46:27.972085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:28.030774 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m23:46:28.030774 [debug] [MainThread]: On master: COMMIT
[0m23:46:28.030774 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:28.031774 [debug] [MainThread]: On master: COMMIT
[0m23:46:28.031774 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:28.031774 [debug] [MainThread]: On master: Close
[0m23:46:28.032775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:28.032775 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m23:46:28.032775 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m23:46:28.033776 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m23:46:28.033776 [info ] [MainThread]: 
[0m23:46:28.034775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m23:46:28.035776 [debug] [MainThread]: Command end result
[0m23:46:28.063181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m23:46:28.066093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m23:46:28.073533 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m23:46:28.074448 [info ] [MainThread]: 
[0m23:46:28.075446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:28.076447 [info ] [MainThread]: 
[0m23:46:28.077701 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:46:28.079997 [debug] [MainThread]: Command `dbt run` succeeded at 23:46:28.079997 after 1.83 seconds
[0m23:46:28.080504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269416203A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026942A2D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269416A19C0>]}
[0m23:46:28.080603 [debug] [MainThread]: Flushing usage events
[0m23:46:28.659133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:06:29.921876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF87F8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA85FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA85FDC0>]}


============================== 03:06:29.925877 | 5abbe2bc-c18d-4dc1-8936-566bdce77943 ==============================
[0m03:06:29.925877 [info ] [MainThread]: Running with dbt=1.9.5
[0m03:06:29.926877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:06:30.106308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA8323B0>]}
[0m03:06:30.152296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF9A66890>]}
[0m03:06:30.153300 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:06:30.359966 [debug] [MainThread]: checksum: db598d7c6b39ccab7a34d8f04c2e026def65ebd0afcd55f619bc9c7641fcd640, vars: {}, profile: , target: , version: 1.9.5
[0m03:06:30.602814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:06:30.602814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:06:30.602814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m03:06:30.648611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFAE217B0>]}
[0m03:06:30.719507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m03:06:30.724522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m03:06:30.756508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFADBB3D0>]}
[0m03:06:30.757524 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m03:06:30.758509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFADCD570>]}
[0m03:06:30.759510 [info ] [MainThread]: 
[0m03:06:30.760510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:06:30.761508 [info ] [MainThread]: 
[0m03:06:30.761508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:06:30.767511 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m03:06:32.901040 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m03:06:32.901040 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m03:06:32.902040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:32.967765 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.066 seconds
[0m03:06:32.968845 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m03:06:32.971794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m03:06:32.977849 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m03:06:32.977849 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m03:06:32.978802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:33.004513 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m03:06:33.004513 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m03:06:33.004513 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m03:06:33.035762 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.018 seconds
[0m03:06:33.035762 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m03:06:33.035762 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m03:06:33.035762 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:33.035762 [debug] [MainThread]: On master: BEGIN
[0m03:06:33.035762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:06:33.086072 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m03:06:33.086072 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:33.087072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:06:33.091262 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m03:06:33.138139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF815E680>]}
[0m03:06:33.138139 [debug] [MainThread]: On master: ROLLBACK
[0m03:06:33.138139 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:33.138139 [debug] [MainThread]: On master: BEGIN
[0m03:06:33.138139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:06:33.138139 [debug] [MainThread]: On master: COMMIT
[0m03:06:33.138139 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:33.138139 [debug] [MainThread]: On master: COMMIT
[0m03:06:33.138139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:06:33.138139 [debug] [MainThread]: On master: Close
[0m03:06:33.154855 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m03:06:33.154855 [info ] [Thread-1 (]: 1 of 12 START sql table model dwh.dim_campaign ................................. [RUN]
[0m03:06:33.155846 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m03:06:33.156848 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m03:06:33.163847 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m03:06:33.165849 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m03:06:33.204649 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m03:06:33.206648 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m03:06:33.207649 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m03:06:33.207649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:06:33.238271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m03:06:33.238271 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m03:06:33.238271 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m03:06:33.300929 [debug] [Thread-1 (]: SQL status: SELECT 1481 in 0.059 seconds
[0m03:06:33.300929 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m03:06:33.300929 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m03:06:33.300929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m03:06:33.316545 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m03:06:33.316545 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m03:06:33.316545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:33.316545 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m03:06:33.316545 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m03:06:33.316545 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m03:06:33.332173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:06:33.332173 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m03:06:33.332173 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m03:06:33.332173 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m03:06:33.347776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m03:06:33.347776 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m03:06:33.363391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF6D134C0>]}
[0m03:06:33.363391 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 1481[0m in 0.19s]
[0m03:06:33.363391 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m03:06:33.363391 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m03:06:33.363391 [info ] [Thread-1 (]: 2 of 12 START sql table model dwh.dim_date ..................................... [RUN]
[0m03:06:33.363391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m03:06:33.363391 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m03:06:33.363391 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m03:06:33.363391 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m03:06:33.363391 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m03:06:33.363391 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m03:06:33.363391 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m03:06:33.363391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:33.534544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m03:06:33.534544 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m03:06:33.535520 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m03:06:33.556434 [debug] [Thread-1 (]: SQL status: SELECT 3106 in 0.020 seconds
[0m03:06:33.560439 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m03:06:33.560439 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m03:06:33.561441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:33.565533 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m03:06:33.565533 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m03:06:33.566539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:33.568440 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m03:06:33.568440 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m03:06:33.568440 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m03:06:33.570440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:06:33.573439 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m03:06:33.573439 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m03:06:33.574439 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m03:06:33.579428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m03:06:33.580479 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m03:06:33.581360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFAE3EC80>]}
[0m03:06:33.581360 [info ] [Thread-1 (]: 2 of 12 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3106[0m in 0.22s]
[0m03:06:33.583375 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m03:06:33.583375 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m03:06:33.584400 [info ] [Thread-1 (]: 3 of 12 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m03:06:33.585363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m03:06:33.585363 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m03:06:33.588444 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m03:06:33.590360 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m03:06:33.594361 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m03:06:33.597368 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m03:06:33.598372 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m03:06:33.598372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:33.641954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m03:06:33.641954 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m03:06:33.643048 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m03:06:33.664071 [debug] [Thread-1 (]: SQL status: SELECT 95 in 0.021 seconds
[0m03:06:33.668438 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m03:06:33.668438 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m03:06:33.670204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:33.673323 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m03:06:33.673323 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m03:06:33.674210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:33.675210 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m03:06:33.675210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m03:06:33.676243 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m03:06:33.677255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:33.679294 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m03:06:33.680320 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m03:06:33.680320 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m03:06:33.685243 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:06:33.686288 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m03:06:33.687210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF6D134C0>]}
[0m03:06:33.688247 [info ] [Thread-1 (]: 3 of 12 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 95[0m in 0.10s]
[0m03:06:33.689211 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m03:06:33.689211 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m03:06:33.690210 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m03:06:33.691210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m03:06:33.691210 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m03:06:33.694209 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m03:06:33.695342 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m03:06:33.699347 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m03:06:33.700348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m03:06:33.700348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m03:06:33.701347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:33.750349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m03:06:33.752348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m03:06:33.752348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m03:06:33.776347 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.023 seconds
[0m03:06:33.782347 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m03:06:33.783348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m03:06:33.784348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:33.787346 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m03:06:33.787346 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m03:06:33.788346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:33.790347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m03:06:33.791348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m03:06:33.792348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m03:06:33.793348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:33.795347 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m03:06:33.796346 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m03:06:33.797348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m03:06:33.799348 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:06:33.801348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m03:06:33.801348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA9D9C00>]}
[0m03:06:33.802348 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 10[0m in 0.11s]
[0m03:06:33.803348 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m03:06:33.804348 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m03:06:33.805348 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m03:06:33.805348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m03:06:33.806348 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m03:06:33.809348 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.811348 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m03:06:33.818348 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.820348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.821348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m03:06:33.821348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:33.864348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m03:06:33.864348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.865350 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m03:06:33.888348 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.022 seconds
[0m03:06:33.891347 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.892348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m03:06:33.893350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:33.895347 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.896347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m03:06:33.897347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:33.898347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m03:06:33.899348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.899348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m03:06:33.900347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:33.904348 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m03:06:33.905347 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m03:06:33.905347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m03:06:33.908347 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m03:06:33.909348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m03:06:33.910347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFB4733D0>]}
[0m03:06:33.911366 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 77[0m in 0.10s]
[0m03:06:33.912348 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m03:06:33.912348 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m03:06:33.913347 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh.dim_property_type ............................ [RUN]
[0m03:06:33.914347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m03:06:33.914347 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m03:06:33.917347 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m03:06:33.919608 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m03:06:33.923606 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m03:06:33.925606 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m03:06:33.926610 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m03:06:33.926610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:33.963603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m03:06:33.964619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m03:06:33.964619 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m03:06:33.973617 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.009 seconds
[0m03:06:33.976604 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m03:06:33.977604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m03:06:33.977604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:33.980603 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m03:06:33.980603 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m03:06:33.981603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:33.982604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m03:06:33.983604 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m03:06:33.983604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m03:06:33.985604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:33.987606 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m03:06:33.988606 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m03:06:33.988606 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m03:06:33.991617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:06:33.992604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m03:06:33.993603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFB4733D0>]}
[0m03:06:33.994604 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 14[0m in 0.08s]
[0m03:06:33.995604 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m03:06:33.995604 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m03:06:33.996612 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m03:06:33.996612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m03:06:33.997633 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m03:06:34.000604 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m03:06:34.002604 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m03:06:34.006603 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m03:06:34.008604 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m03:06:34.008604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m03:06:34.008604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:34.047604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m03:06:34.047604 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m03:06:34.047604 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m03:06:34.056780 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m03:06:34.056780 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m03:06:34.056780 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m03:06:34.056780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.056780 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m03:06:34.056780 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m03:06:34.056780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.066763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m03:06:34.067788 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m03:06:34.067788 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m03:06:34.069779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:34.071762 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m03:06:34.072762 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m03:06:34.072762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m03:06:34.075776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m03:06:34.076763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m03:06:34.076763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA9D9C00>]}
[0m03:06:34.077762 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 6[0m in 0.08s]
[0m03:06:34.078787 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m03:06:34.079765 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m03:06:34.079765 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m03:06:34.080768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m03:06:34.080768 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m03:06:34.084762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m03:06:34.085765 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m03:06:34.089762 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m03:06:34.090779 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m03:06:34.090779 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m03:06:34.091762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:34.129785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m03:06:34.130763 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m03:06:34.130763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m03:06:34.141776 [debug] [Thread-1 (]: SQL status: SELECT 31 in 0.010 seconds
[0m03:06:34.145763 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m03:06:34.145763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m03:06:34.146762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.149764 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m03:06:34.150762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m03:06:34.151762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.152762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m03:06:34.152762 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m03:06:34.153762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m03:06:34.154787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:34.156762 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m03:06:34.157762 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m03:06:34.157762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m03:06:34.160776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m03:06:34.161763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m03:06:34.162762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA9D9C00>]}
[0m03:06:34.163768 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 31[0m in 0.08s]
[0m03:06:34.163768 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m03:06:34.164768 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m03:06:34.165764 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh.dim_status ................................... [RUN]
[0m03:06:34.166774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m03:06:34.166774 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m03:06:34.169762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m03:06:34.170763 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m03:06:34.174763 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m03:06:34.175769 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m03:06:34.175769 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m03:06:34.176762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:34.215767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m03:06:34.215767 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m03:06:34.216775 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m03:06:34.239851 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.022 seconds
[0m03:06:34.242853 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m03:06:34.243841 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m03:06:34.243841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.246764 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m03:06:34.247763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m03:06:34.248762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:34.250762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m03:06:34.250762 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m03:06:34.250762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m03:06:34.252762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:34.254762 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m03:06:34.255762 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m03:06:34.255762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m03:06:34.258849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:06:34.259763 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m03:06:34.260763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFB48ABF0>]}
[0m03:06:34.260763 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh.dim_status .............................. [[32mSELECT 48[0m in 0.09s]
[0m03:06:34.262765 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m03:06:34.262765 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m03:06:34.263767 [info ] [Thread-1 (]: 10 of 12 START sql view model dwh.dim_time ..................................... [RUN]
[0m03:06:34.263767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m03:06:34.264763 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m03:06:34.267762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m03:06:34.269767 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m03:06:34.290762 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m03:06:34.292762 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m03:06:34.293764 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m03:06:34.293764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:34.337389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m03:06:34.338020 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m03:06:34.338527 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m03:06:34.350623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m03:06:34.356804 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m03:06:34.358062 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m03:06:34.358948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:34.362460 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m03:06:34.363461 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m03:06:34.364459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:34.366460 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m03:06:34.366460 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m03:06:34.367460 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m03:06:34.368486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:34.371459 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m03:06:34.373459 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m03:06:34.374460 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m03:06:34.376460 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:06:34.377459 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m03:06:34.378459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFA9D9C00>]}
[0m03:06:34.379460 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.11s]
[0m03:06:34.380460 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m03:06:34.380460 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m03:06:34.381459 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh.fact_sales .................................. [RUN]
[0m03:06:34.382459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m03:06:34.382459 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m03:06:34.386459 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m03:06:34.388459 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m03:06:34.392472 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m03:06:34.393466 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m03:06:34.393466 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m03:06:34.394459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:34.431459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m03:06:34.433493 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m03:06:34.433493 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.sale_category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(15,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(15,2) AS expected_value,
    s.actual_value::DECIMAL(15,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m03:06:34.452578 [debug] [Thread-1 (]: SQL status: SELECT 1567 in 0.018 seconds
[0m03:06:34.456558 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m03:06:34.456558 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales" rename to "fact_sales__dbt_backup"
[0m03:06:34.457545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.460458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m03:06:34.461468 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m03:06:34.462461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:34.465459 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m03:06:34.466459 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m03:06:34.466459 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m03:06:34.469459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:06:34.471459 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_sales__dbt_backup"
[0m03:06:34.472459 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m03:06:34.472459 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "dbt_project_db"."dwh"."fact_sales__dbt_backup" cascade
[0m03:06:34.479464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m03:06:34.480460 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m03:06:34.481460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFAE0BEB0>]}
[0m03:06:34.481460 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh.fact_sales ............................. [[32mSELECT 1567[0m in 0.10s]
[0m03:06:34.482459 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m03:06:34.483459 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m03:06:34.484460 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh.fact_leads .................................. [RUN]
[0m03:06:34.485494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fact_sales, now model.my_dbt_project.fact_leads)
[0m03:06:34.485494 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m03:06:34.489461 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m03:06:34.490464 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m03:06:34.493461 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m03:06:34.495462 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m03:06:34.495462 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m03:06:34.496461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:34.540617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m03:06:34.541617 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m03:06:34.542616 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads" l -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_of_contact

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source  -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m03:06:34.823390 [debug] [Thread-1 (]: SQL status: SELECT 55845 in 0.280 seconds
[0m03:06:34.827389 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m03:06:34.827389 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads" rename to "fact_leads__dbt_backup"
[0m03:06:34.828389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.830389 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m03:06:34.831389 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads__dbt_tmp" rename to "fact_leads"
[0m03:06:34.832391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:34.835479 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m03:06:34.835479 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m03:06:34.835479 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m03:06:34.841390 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m03:06:34.843389 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_leads__dbt_backup"
[0m03:06:34.843389 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m03:06:34.844389 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
drop table if exists "dbt_project_db"."dwh"."fact_leads__dbt_backup" cascade
[0m03:06:34.849391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m03:06:34.850389 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m03:06:34.851389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abbe2bc-c18d-4dc1-8936-566bdce77943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFB4C64A0>]}
[0m03:06:34.852406 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dwh.fact_leads ............................. [[32mSELECT 55845[0m in 0.37s]
[0m03:06:34.853391 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m03:06:34.855390 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:34.855390 [debug] [MainThread]: On master: BEGIN
[0m03:06:34.856476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:06:34.989664 [debug] [MainThread]: SQL status: BEGIN in 0.134 seconds
[0m03:06:34.990663 [debug] [MainThread]: On master: COMMIT
[0m03:06:34.990663 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:34.991663 [debug] [MainThread]: On master: COMMIT
[0m03:06:34.991663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:06:34.991663 [debug] [MainThread]: On master: Close
[0m03:06:34.992663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:34.992663 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m03:06:34.993669 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m03:06:34.993669 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m03:06:34.994663 [info ] [MainThread]: 
[0m03:06:34.994663 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m03:06:34.997663 [debug] [MainThread]: Command end result
[0m03:06:35.020665 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m03:06:35.023663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m03:06:35.034666 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m03:06:35.034666 [info ] [MainThread]: 
[0m03:06:35.035664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:06:35.035664 [info ] [MainThread]: 
[0m03:06:35.036662 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m03:06:35.037664 [debug] [MainThread]: Command `dbt run` succeeded at 03:06:35.037664 after 5.19 seconds
[0m03:06:35.037664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF87F8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF9A66890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFAE47730>]}
[0m03:06:35.038663 [debug] [MainThread]: Flushing usage events
[0m03:06:35.901744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:12.803891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE8BF0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAA19210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAA19030>]}


============================== 16:24:12.808891 | 4728a4ad-7034-4707-bc9a-7770fc87cbad ==============================
[0m16:24:12.808891 [info ] [MainThread]: Running with dbt=1.9.6
[0m16:24:12.809891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\my_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:24:12.963563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE6F269B0>]}
[0m16:24:13.008533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAB44310>]}
[0m16:24:13.010469 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:13.220895 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m16:24:13.316544 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:24:13.317544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEA37EA10>]}
[0m16:24:14.324494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m16:24:14.332741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC20C670>]}
[0m16:24:14.399941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\my_dbt_project\target\manifest.json
[0m16:24:14.403943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m16:24:14.425896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC2070A0>]}
[0m16:24:14.426869 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m16:24:14.426869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC207010>]}
[0m16:24:14.428870 [info ] [MainThread]: 
[0m16:24:14.428870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:14.429866 [info ] [MainThread]: 
[0m16:24:14.430865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:14.435865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m16:24:16.189318 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m16:24:16.190332 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m16:24:16.190332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:16.230329 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.040 seconds
[0m16:24:16.231329 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m16:24:16.233337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m16:24:16.238330 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m16:24:16.238330 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m16:24:16.239350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:16.272589 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m16:24:16.272589 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m16:24:16.272589 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m16:24:16.286588 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.013 seconds
[0m16:24:16.287681 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m16:24:16.288682 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m16:24:16.294592 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:16.295592 [debug] [MainThread]: On master: BEGIN
[0m16:24:16.295592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:16.328467 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m16:24:16.329547 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:16.329547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:16.343258 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m16:24:16.344280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC27D7B0>]}
[0m16:24:16.345273 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:16.346258 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:16.346258 [debug] [MainThread]: On master: BEGIN
[0m16:24:16.346258 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:24:16.347258 [debug] [MainThread]: On master: COMMIT
[0m16:24:16.347258 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:16.347258 [debug] [MainThread]: On master: COMMIT
[0m16:24:16.348258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:24:16.348258 [debug] [MainThread]: On master: Close
[0m16:24:16.353577 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m16:24:16.354587 [info ] [Thread-1 (]: 1 of 12 START sql table model dwh.dim_campaign ................................. [RUN]
[0m16:24:16.355584 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m16:24:16.355584 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m16:24:16.362586 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m16:24:16.363591 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m16:24:16.394585 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m16:24:16.395587 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:24:16.396588 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m16:24:16.396588 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:16.430678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m16:24:16.430678 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:24:16.431679 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m16:24:16.445675 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.014 seconds
[0m16:24:16.454678 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:24:16.455678 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m16:24:16.457232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:16.460238 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:24:16.460238 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m16:24:16.461238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.473237 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m16:24:16.474238 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:24:16.474238 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m16:24:16.475949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:24:16.481042 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m16:24:16.484080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:24:16.485048 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m16:24:16.494602 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:24:16.497688 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m16:24:16.499602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC659660>]}
[0m16:24:16.500601 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 0[0m in 0.14s]
[0m16:24:16.501609 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m16:24:16.501609 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m16:24:16.502636 [info ] [Thread-1 (]: 2 of 12 START sql table model dwh.dim_date ..................................... [RUN]
[0m16:24:16.502636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m16:24:16.503602 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m16:24:16.505690 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m16:24:16.506711 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m16:24:16.509686 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m16:24:16.511609 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:24:16.511609 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m16:24:16.512602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.552602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:24:16.552602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:24:16.552602 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m16:24:16.567638 [debug] [Thread-1 (]: SQL status: SELECT 3106 in 0.014 seconds
[0m16:24:16.570684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:24:16.570684 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m16:24:16.572684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:16.575709 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:24:16.575709 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:24:16.576681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.578602 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m16:24:16.578602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:24:16.578602 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m16:24:16.580606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:24:16.616245 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m16:24:16.616245 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:24:16.616245 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m16:24:16.616245 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:24:16.616245 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m16:24:16.632062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC85B9D0>]}
[0m16:24:16.633071 [info ] [Thread-1 (]: 2 of 12 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3106[0m in 0.13s]
[0m16:24:16.634062 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m16:24:16.635067 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m16:24:16.635067 [info ] [Thread-1 (]: 3 of 12 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m16:24:16.636063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m16:24:16.636063 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m16:24:16.639146 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m16:24:16.640157 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m16:24:16.644178 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m16:24:16.645065 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:24:16.645065 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m16:24:16.645065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.667165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:24:16.667165 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:24:16.682776 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m16:24:16.683488 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:24:16.683488 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:24:16.683488 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m16:24:16.683488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:16.683488 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:24:16.683488 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m16:24:16.683488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.683488 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m16:24:16.683488 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:24:16.683488 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m16:24:16.700240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:16.703236 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m16:24:16.704236 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:24:16.704236 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m16:24:16.708237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:24:16.709325 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m16:24:16.709325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC875480>]}
[0m16:24:16.710237 [info ] [Thread-1 (]: 3 of 12 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 0[0m in 0.07s]
[0m16:24:16.711252 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m16:24:16.712238 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m16:24:16.712238 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m16:24:16.713236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m16:24:16.713236 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m16:24:16.716240 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m16:24:16.718261 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m16:24:16.722324 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m16:24:16.723338 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:24:16.723338 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m16:24:16.724292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.759868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:24:16.760968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:24:16.760968 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m16:24:16.766882 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:24:16.770950 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:24:16.771981 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m16:24:16.772911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:16.774951 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:24:16.775959 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m16:24:16.775959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.777868 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m16:24:16.777868 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:24:16.777868 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m16:24:16.780038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:16.782044 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m16:24:16.783045 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:24:16.783045 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m16:24:16.788044 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:24:16.789045 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m16:24:16.789045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEA3367D0>]}
[0m16:24:16.790045 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 0[0m in 0.08s]
[0m16:24:16.791044 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m16:24:16.792044 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m16:24:16.792044 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m16:24:16.793051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m16:24:16.793051 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m16:24:16.796047 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.797047 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m16:24:16.801046 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.802047 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.803050 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m16:24:16.803050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.840933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:24:16.840933 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.840933 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m16:24:16.846931 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:24:16.849932 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.850936 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m16:24:16.852903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:24:16.856909 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.856909 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m16:24:16.858318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.859328 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m16:24:16.859328 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.860327 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m16:24:16.861709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:16.863788 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m16:24:16.863788 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:24:16.864820 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m16:24:16.867738 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:24:16.868788 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m16:24:16.869820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEB07DE70>]}
[0m16:24:16.870707 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 0[0m in 0.08s]
[0m16:24:16.871705 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m16:24:16.871705 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m16:24:16.872706 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh.dim_property_type ............................ [RUN]
[0m16:24:16.873720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m16:24:16.873720 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m16:24:16.875797 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m16:24:16.877706 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m16:24:16.880796 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m16:24:16.881784 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:24:16.882752 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m16:24:16.882752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.918706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:24:16.919706 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:24:16.919706 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m16:24:16.926706 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:24:16.929791 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:24:16.929791 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m16:24:16.930706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.932803 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:24:16.933760 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m16:24:16.934708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:16.936799 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m16:24:16.936799 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:24:16.936799 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m16:24:16.938705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:16.940827 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m16:24:16.942821 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:24:16.942821 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m16:24:16.945706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:24:16.946792 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m16:24:16.946792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEC2583D0>]}
[0m16:24:16.947711 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 0[0m in 0.07s]
[0m16:24:16.948705 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m16:24:16.949706 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m16:24:16.949706 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m16:24:16.950706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m16:24:16.951706 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m16:24:16.953705 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m16:24:16.954705 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m16:24:16.958705 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m16:24:16.959705 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:24:16.960705 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m16:24:16.960705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.995982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m16:24:16.995982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:24:16.996942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m16:24:17.002944 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:24:17.006942 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:24:17.006942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m16:24:17.007942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.009943 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:24:17.010942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m16:24:17.011664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.012670 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m16:24:17.012670 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:24:17.012670 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m16:24:17.014669 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:17.017673 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m16:24:17.019671 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:24:17.019671 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m16:24:17.023237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:24:17.024234 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m16:24:17.024234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAEF93F0>]}
[0m16:24:17.025234 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 0[0m in 0.07s]
[0m16:24:17.026187 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m16:24:17.027193 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m16:24:17.027193 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m16:24:17.028150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m16:24:17.028150 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m16:24:17.031231 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m16:24:17.032240 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m16:24:17.037232 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m16:24:17.038233 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:24:17.039165 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m16:24:17.039165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.077234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:24:17.077234 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:24:17.078171 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m16:24:17.083190 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:24:17.088164 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:24:17.088164 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m16:24:17.089163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.091243 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:24:17.091243 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m16:24:17.092228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.093225 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m16:24:17.094229 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:24:17.094229 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m16:24:17.095241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:17.097233 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m16:24:17.098234 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:24:17.098234 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m16:24:17.101253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:24:17.102254 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m16:24:17.103234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE87C1A80>]}
[0m16:24:17.104151 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 0[0m in 0.08s]
[0m16:24:17.105150 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m16:24:17.105150 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m16:24:17.106150 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh.dim_status ................................... [RUN]
[0m16:24:17.107161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m16:24:17.107161 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m16:24:17.110231 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m16:24:17.111179 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m16:24:17.114234 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m16:24:17.116152 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:24:17.116152 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m16:24:17.116152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.154258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m16:24:17.154258 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:24:17.155262 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m16:24:17.160240 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:24:17.163226 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:24:17.164236 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m16:24:17.164236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.169228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:24:17.169228 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m16:24:17.170266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.172235 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m16:24:17.172235 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:24:17.172235 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m16:24:17.174152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:17.176150 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m16:24:17.177149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:24:17.177149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m16:24:17.180233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:24:17.181234 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m16:24:17.182242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEB07DE70>]}
[0m16:24:17.183152 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh.dim_status .............................. [[32mSELECT 0[0m in 0.08s]
[0m16:24:17.184151 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m16:24:17.184151 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m16:24:17.185150 [info ] [Thread-1 (]: 10 of 12 START sql view model dwh.dim_time ..................................... [RUN]
[0m16:24:17.185150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m16:24:17.186233 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m16:24:17.187181 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m16:24:17.188255 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m16:24:17.205150 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m16:24:17.207159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:24:17.208151 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m16:24:17.208151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.234453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m16:24:17.234453 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:24:17.234453 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m16:24:17.257863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:24:17.260964 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:24:17.261950 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m16:24:17.261950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.264949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:24:17.264949 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m16:24:17.266576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.267629 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m16:24:17.268578 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:24:17.268578 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m16:24:17.270578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:17.272663 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m16:24:17.274667 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:24:17.275669 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m16:24:17.277578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:24:17.278661 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m16:24:17.278661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAA19090>]}
[0m16:24:17.279688 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m16:24:17.280581 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m16:24:17.281577 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m16:24:17.281577 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh.fact_sales .................................. [RUN]
[0m16:24:17.282577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m16:24:17.283600 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m16:24:17.283600 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m16:24:17.283600 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m16:24:17.283600 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m16:24:17.283600 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:24:17.283600 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m16:24:17.283600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.336469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m16:24:17.336469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:24:17.336469 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.sale_category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(15,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(15,2) AS expected_value,
    s.actual_value::DECIMAL(15,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m16:24:17.344412 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m16:24:17.348476 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:24:17.348476 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales" rename to "fact_sales__dbt_backup"
[0m16:24:17.349463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:17.352458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:24:17.353460 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m16:24:17.354376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.355458 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m16:24:17.355458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:24:17.356458 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m16:24:17.357374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:17.360375 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_sales__dbt_backup"
[0m16:24:17.361374 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:24:17.361374 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "dbt_project_db"."dwh"."fact_sales__dbt_backup" cascade
[0m16:24:17.366379 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:24:17.367379 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m16:24:17.368454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEB07DE70>]}
[0m16:24:17.369375 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh.fact_sales ............................. [[32mSELECT 0[0m in 0.09s]
[0m16:24:17.370375 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m16:24:17.370375 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m16:24:17.371375 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh.fact_leads .................................. [RUN]
[0m16:24:17.372428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fact_sales, now model.my_dbt_project.fact_leads)
[0m16:24:17.372428 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m16:24:17.376464 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m16:24:17.377463 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m16:24:17.381460 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m16:24:17.382468 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:24:17.383379 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m16:24:17.383379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.421483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:24:17.421483 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:24:17.422456 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads" l -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_of_contact

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source  -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m16:24:17.427714 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m16:24:17.434085 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:24:17.434085 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads" rename to "fact_leads__dbt_backup"
[0m16:24:17.435124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.437134 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:24:17.438155 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads__dbt_tmp" rename to "fact_leads"
[0m16:24:17.438155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:24:17.439133 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m16:24:17.440154 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:24:17.440154 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m16:24:17.442085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:17.444137 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_leads__dbt_backup"
[0m16:24:17.444137 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:24:17.445128 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
drop table if exists "dbt_project_db"."dwh"."fact_leads__dbt_backup" cascade
[0m16:24:17.453090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:24:17.454110 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m16:24:17.455101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4728a4ad-7034-4707-bc9a-7770fc87cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEB07DE70>]}
[0m16:24:17.456088 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dwh.fact_leads ............................. [[32mSELECT 0[0m in 0.08s]
[0m16:24:17.457102 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m16:24:17.458089 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:17.459129 [debug] [MainThread]: On master: BEGIN
[0m16:24:17.459129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:17.494094 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m16:24:17.494094 [debug] [MainThread]: On master: COMMIT
[0m16:24:17.494094 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:17.495005 [debug] [MainThread]: On master: COMMIT
[0m16:24:17.495005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:24:17.495005 [debug] [MainThread]: On master: Close
[0m16:24:17.496125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:17.496125 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m16:24:17.496125 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m16:24:17.497007 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m16:24:17.497007 [info ] [MainThread]: 
[0m16:24:17.498004 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m16:24:17.501065 [debug] [MainThread]: Command end result
[0m16:24:17.519627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\my_dbt_project\target\manifest.json
[0m16:24:17.519627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m16:24:17.519627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\my_dbt_project\target\run_results.json
[0m16:24:17.519627 [info ] [MainThread]: 
[0m16:24:17.519627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:17.519627 [info ] [MainThread]: 
[0m16:24:17.532977 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m16:24:17.534972 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:17.533974 after 4.79 seconds
[0m16:24:17.534972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE8BF0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE9C70280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE8C6DF90>]}
[0m16:24:17.534972 [debug] [MainThread]: Flushing usage events
[0m16:24:18.391075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:53.195605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F93D44760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F94B9D1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F94B9D000>]}


============================== 16:28:53.200617 | a6672803-4a31-4745-98df-4adb4eb23ee7 ==============================
[0m16:28:53.200617 [info ] [MainThread]: Running with dbt=1.9.6
[0m16:28:53.200617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khale\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khale\\my_dbt_project\\my_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:53.341406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F93DE7670>]}
[0m16:28:53.403212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F94876890>]}
[0m16:28:53.405164 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:28:53.616531 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m16:28:53.775448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:53.776448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:53.781448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m16:28:53.811564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9519DAE0>]}
[0m16:28:53.881588 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m16:28:53.882181 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m16:28:53.912069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F951CE800>]}
[0m16:28:53.912069 [info ] [MainThread]: Found 12 models, 2 sources, 433 macros
[0m16:28:53.913067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F951CE8C0>]}
[0m16:28:53.915068 [info ] [MainThread]: 
[0m16:28:53.915068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:53.915068 [info ] [MainThread]: 
[0m16:28:53.916068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:53.921142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db'
[0m16:28:54.004021 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db"
[0m16:28:54.005028 [debug] [ThreadPool]: On list_dbt_project_db: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db"} */

    select distinct nspname from pg_namespace
  
[0m16:28:54.005028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:54.046196 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m16:28:54.047209 [debug] [ThreadPool]: On list_dbt_project_db: Close
[0m16:28:54.049293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_project_db_dwh'
[0m16:28:54.054230 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m16:28:54.054230 [debug] [ThreadPool]: On list_dbt_project_db_dwh: BEGIN
[0m16:28:54.055197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:54.088085 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m16:28:54.089045 [debug] [ThreadPool]: Using postgres connection "list_dbt_project_db_dwh"
[0m16:28:54.089045 [debug] [ThreadPool]: On list_dbt_project_db_dwh: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_dbt_project_db_dwh"} */
select
      'dbt_project_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh'
    union all
    select
      'dbt_project_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh'
  
[0m16:28:54.095076 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m16:28:54.096045 [debug] [ThreadPool]: On list_dbt_project_db_dwh: ROLLBACK
[0m16:28:54.097212 [debug] [ThreadPool]: On list_dbt_project_db_dwh: Close
[0m16:28:54.102326 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:54.103305 [debug] [MainThread]: On master: BEGIN
[0m16:28:54.103305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:54.124040 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m16:28:54.124040 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:54.124040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:54.139659 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:28:54.139659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9511FF70>]}
[0m16:28:54.139659 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:54.139659 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:54.139659 [debug] [MainThread]: On master: BEGIN
[0m16:28:54.139659 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:28:54.139659 [debug] [MainThread]: On master: COMMIT
[0m16:28:54.139659 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:54.139659 [debug] [MainThread]: On master: COMMIT
[0m16:28:54.139659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:28:54.139659 [debug] [MainThread]: On master: Close
[0m16:28:54.155289 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_campaign
[0m16:28:54.155289 [info ] [Thread-1 (]: 1 of 12 START sql table model dwh.dim_campaign ................................. [RUN]
[0m16:28:54.155289 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_campaign'
[0m16:28:54.155289 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_campaign
[0m16:28:54.155289 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_campaign"
[0m16:28:54.155289 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_campaign
[0m16:28:54.249587 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_campaign"
[0m16:28:54.251600 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:28:54.251600 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: BEGIN
[0m16:28:54.252588 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:28:54.289240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m16:28:54.290229 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:28:54.290229 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by campaign) as campaign_id,
    campaign 
from(
    select distinct campaign
    from "dbt_project_db"."data_source"."leads"
    WHERE campaign is not NULL
) as distinct_campaign
  );
  
[0m16:28:54.296316 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:54.304311 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:28:54.304311 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign" rename to "dim_campaign__dbt_backup"
[0m16:28:54.305321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.308323 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:28:54.308323 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
alter table "dbt_project_db"."dwh"."dim_campaign__dbt_tmp" rename to "dim_campaign"
[0m16:28:54.309229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.321323 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m16:28:54.321323 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:28:54.322329 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: COMMIT
[0m16:28:54.323727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:28:54.329734 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_campaign__dbt_backup"
[0m16:28:54.332817 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_campaign"
[0m16:28:54.333821 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_campaign"} */
drop table if exists "dbt_project_db"."dwh"."dim_campaign__dbt_backup" cascade
[0m16:28:54.335843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:54.337822 [debug] [Thread-1 (]: On model.my_dbt_project.dim_campaign: Close
[0m16:28:54.340747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F918A73A0>]}
[0m16:28:54.341778 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dwh.dim_campaign ............................ [[32mSELECT 0[0m in 0.18s]
[0m16:28:54.342739 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_campaign
[0m16:28:54.342739 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m16:28:54.342739 [info ] [Thread-1 (]: 2 of 12 START sql table model dwh.dim_date ..................................... [RUN]
[0m16:28:54.343798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_campaign, now model.my_dbt_project.dim_date)
[0m16:28:54.343798 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m16:28:54.346817 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m16:28:54.347741 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m16:28:54.351733 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m16:28:54.352766 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:28:54.353740 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m16:28:54.353740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.391670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m16:28:54.391670 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:28:54.391670 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_series as (
    select generate_series(
        date '2016-12-01',  
        CURRENT_DATE, 
        interval '1 day'
    )::date as full_date
)

select 
    to_char(full_date, 'YYYYMMDD')::int as date_id,
    extract(year from full_date)::int as year,
    extract(quarter from full_date)::int as quarter,
    extract(month from full_date)::int as month,
    extract(week from full_date)::int as week,
    extract(day from full_date)::int as day
from date_series
order by full_date
  );
  
[0m16:28:54.391670 [debug] [Thread-1 (]: SQL status: SELECT 3106 in 0.010 seconds
[0m16:28:54.408254 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:28:54.408254 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date" rename to "dim_date__dbt_backup"
[0m16:28:54.409272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:28:54.412249 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:28:54.412249 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter table "dbt_project_db"."dwh"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:28:54.413252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.414182 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m16:28:54.415244 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:28:54.415244 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m16:28:54.417166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:28:54.419252 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_date__dbt_backup"
[0m16:28:54.420248 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_date"
[0m16:28:54.420248 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop table if exists "dbt_project_db"."dwh"."dim_date__dbt_backup" cascade
[0m16:28:54.425166 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:28:54.426248 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m16:28:54.426248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F918A73A0>]}
[0m16:28:54.427251 [info ] [Thread-1 (]: 2 of 12 OK created sql table model dwh.dim_date ................................ [[32mSELECT 3106[0m in 0.08s]
[0m16:28:54.428231 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m16:28:54.429166 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_source
[0m16:28:54.429166 [info ] [Thread-1 (]: 3 of 12 START sql table model dwh.dim_lead_source .............................. [RUN]
[0m16:28:54.430166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_lead_source)
[0m16:28:54.430166 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_source
[0m16:28:54.433257 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_source"
[0m16:28:54.434170 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_source
[0m16:28:54.437289 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_source"
[0m16:28:54.438251 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:28:54.439166 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: BEGIN
[0m16:28:54.439166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.479245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m16:28:54.479245 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:28:54.480245 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_source) as lead_source_id,
    lead_source 
from(
    select distinct lead_source
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_source is not NULL
)
  );
  
[0m16:28:54.485246 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:54.487371 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:28:54.487371 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source" rename to "dim_lead_source__dbt_backup"
[0m16:28:54.490215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.492321 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:28:54.492321 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
alter table "dbt_project_db"."dwh"."dim_lead_source__dbt_tmp" rename to "dim_lead_source"
[0m16:28:54.493302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.495316 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m16:28:54.496305 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:28:54.496305 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: COMMIT
[0m16:28:54.498246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:54.499306 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_source__dbt_backup"
[0m16:28:54.500301 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_source"
[0m16:28:54.500301 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_source"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_source__dbt_backup" cascade
[0m16:28:54.502307 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:54.504306 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_source: Close
[0m16:28:54.504306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F918A73A0>]}
[0m16:28:54.505215 [info ] [Thread-1 (]: 3 of 12 OK created sql table model dwh.dim_lead_source ......................... [[32mSELECT 0[0m in 0.07s]
[0m16:28:54.506213 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_source
[0m16:28:54.507053 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_lead_type
[0m16:28:54.507053 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh.dim_lead_type ................................ [RUN]
[0m16:28:54.508055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_source, now model.my_dbt_project.dim_lead_type)
[0m16:28:54.508055 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_lead_type
[0m16:28:54.511054 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_lead_type"
[0m16:28:54.512054 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_lead_type
[0m16:28:54.515053 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_lead_type"
[0m16:28:54.516054 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:28:54.517053 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: BEGIN
[0m16:28:54.517053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.557265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:28:54.558265 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:28:54.558265 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(order by lead_type) as lead_type_id,
    lead_type 
from(
    select distinct lead_type
    from "dbt_project_db"."data_source"."leads"
    WHERE lead_type is not NULL
)
  );
  
[0m16:28:54.566265 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m16:28:54.569351 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:28:54.569351 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type" rename to "dim_lead_type__dbt_backup"
[0m16:28:54.570356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.572360 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:28:54.573357 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
alter table "dbt_project_db"."dwh"."dim_lead_type__dbt_tmp" rename to "dim_lead_type"
[0m16:28:54.574299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.575361 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m16:28:54.575361 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:28:54.576354 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: COMMIT
[0m16:28:54.577357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:54.579350 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_lead_type__dbt_backup"
[0m16:28:54.580357 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_lead_type"
[0m16:28:54.580357 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_lead_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_lead_type__dbt_backup" cascade
[0m16:28:54.582370 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:28:54.583348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_lead_type: Close
[0m16:28:54.584348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9571D840>]}
[0m16:28:54.584348 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh.dim_lead_type ........................... [[32mSELECT 0[0m in 0.08s]
[0m16:28:54.585303 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_lead_type
[0m16:28:54.586265 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_method_of_contact
[0m16:28:54.586265 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh.dim_method_of_contact ........................ [RUN]
[0m16:28:54.587302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_lead_type, now model.my_dbt_project.dim_method_of_contact)
[0m16:28:54.587302 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_method_of_contact
[0m16:28:54.591347 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.593267 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_method_of_contact
[0m16:28:54.596353 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.597357 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.598276 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: BEGIN
[0m16:28:54.598276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.634375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:28:54.634375 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.635352 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp"
  
  
    as
  
  (
    

select ROW_NUMBER() OVER(order by method_of_contact) as method_id,
method_of_contact 
from(
    select distinct method_of_contact
    from "dbt_project_db"."data_source"."leads"
    WHERE method_of_contact is not NULL
)
  );
  
[0m16:28:54.640267 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:54.644367 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.645280 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact" rename to "dim_method_of_contact__dbt_backup"
[0m16:28:54.645280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.648352 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.648352 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
alter table "dbt_project_db"."dwh"."dim_method_of_contact__dbt_tmp" rename to "dim_method_of_contact"
[0m16:28:54.649350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.650374 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m16:28:54.650374 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.651363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: COMMIT
[0m16:28:54.652356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:54.654375 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup"
[0m16:28:54.655356 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_method_of_contact"
[0m16:28:54.655356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_method_of_contact"} */
drop table if exists "dbt_project_db"."dwh"."dim_method_of_contact__dbt_backup" cascade
[0m16:28:54.658265 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:54.660344 [debug] [Thread-1 (]: On model.my_dbt_project.dim_method_of_contact: Close
[0m16:28:54.660344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F918A73A0>]}
[0m16:28:54.661274 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh.dim_method_of_contact ................... [[32mSELECT 0[0m in 0.07s]
[0m16:28:54.662266 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_method_of_contact
[0m16:28:54.662266 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_property_type
[0m16:28:54.663350 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh.dim_property_type ............................ [RUN]
[0m16:28:54.664266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_method_of_contact, now model.my_dbt_project.dim_property_type)
[0m16:28:54.664266 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_property_type
[0m16:28:54.666350 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_property_type"
[0m16:28:54.668274 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_property_type
[0m16:28:54.671351 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_property_type"
[0m16:28:54.673268 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:28:54.673268 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: BEGIN
[0m16:28:54.674266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.712286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m16:28:54.713279 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:28:54.713279 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp"
  
  
    as
  
  (
    


SELECT DISTINCT property_type_id,
                property_type
FROM "dbt_project_db"."data_source"."sales"
WHERE property_type_id IS NOT NULL
  );
  
[0m16:28:54.718265 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:28:54.722348 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:28:54.722348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type" rename to "dim_property_type__dbt_backup"
[0m16:28:54.723367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.726349 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:28:54.726349 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
alter table "dbt_project_db"."dwh"."dim_property_type__dbt_tmp" rename to "dim_property_type"
[0m16:28:54.727353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.728387 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m16:28:54.728387 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:28:54.728387 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: COMMIT
[0m16:28:54.730305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:54.732357 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_property_type__dbt_backup"
[0m16:28:54.733354 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_property_type"
[0m16:28:54.733354 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_property_type"} */
drop table if exists "dbt_project_db"."dwh"."dim_property_type__dbt_backup" cascade
[0m16:28:54.735276 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:54.737346 [debug] [Thread-1 (]: On model.my_dbt_project.dim_property_type: Close
[0m16:28:54.737346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9573D9C0>]}
[0m16:28:54.738280 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh.dim_property_type ....................... [[32mSELECT 0[0m in 0.07s]
[0m16:28:54.739270 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_property_type
[0m16:28:54.740264 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sale_category
[0m16:28:54.740264 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh.dim_sale_category ............................ [RUN]
[0m16:28:54.741265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_property_type, now model.my_dbt_project.dim_sale_category)
[0m16:28:54.741265 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sale_category
[0m16:28:54.744266 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sale_category"
[0m16:28:54.745264 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sale_category
[0m16:28:54.748264 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sale_category"
[0m16:28:54.749264 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:28:54.750264 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: BEGIN
[0m16:28:54.751267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.899197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m16:28:54.900204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:28:54.901179 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY sale_category) AS sale_category_id,
    sale_category
FROM (
    SELECT DISTINCT sale_category
    FROM "dbt_project_db"."data_source"."sales"
    WHERE sale_category IS NOT NULL
)
  );
  
[0m16:28:54.905680 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:54.908680 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:28:54.909700 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category" rename to "dim_sale_category__dbt_backup"
[0m16:28:54.910681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.913702 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:28:54.913702 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
alter table "dbt_project_db"."dwh"."dim_sale_category__dbt_tmp" rename to "dim_sale_category"
[0m16:28:54.914357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.915402 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m16:28:54.915402 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:28:54.916396 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: COMMIT
[0m16:28:54.918399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:28:54.921445 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sale_category__dbt_backup"
[0m16:28:54.922421 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sale_category"
[0m16:28:54.922421 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sale_category"} */
drop table if exists "dbt_project_db"."dwh"."dim_sale_category__dbt_backup" cascade
[0m16:28:54.925364 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:54.926427 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sale_category: Close
[0m16:28:54.927364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F918A73A0>]}
[0m16:28:54.928365 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh.dim_sale_category ....................... [[32mSELECT 0[0m in 0.19s]
[0m16:28:54.929363 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sale_category
[0m16:28:54.929363 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_location
[0m16:28:54.930363 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh.dim_sales_location ........................... [RUN]
[0m16:28:54.930363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sale_category, now model.my_dbt_project.dim_sales_location)
[0m16:28:54.931363 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_location
[0m16:28:54.934382 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_location"
[0m16:28:54.935395 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_location
[0m16:28:54.939370 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_location"
[0m16:28:54.940370 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:28:54.941368 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: BEGIN
[0m16:28:54.941368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.981597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:28:54.982603 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:28:54.982603 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp"
  
  
    as
  
  (
    


SELECT 
    ROW_NUMBER() OVER (ORDER BY unit_location) AS unit_location_id,
    unit_location
FROM (
    SELECT DISTINCT unit_location
    FROM "dbt_project_db"."data_source"."sales"
    WHERE unit_location IS NOT NULL
)
  );
  
[0m16:28:54.987644 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:54.991602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:28:54.992602 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location" rename to "dim_sales_location__dbt_backup"
[0m16:28:54.993603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:28:54.997602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:28:54.997602 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
alter table "dbt_project_db"."dwh"."dim_sales_location__dbt_tmp" rename to "dim_sales_location"
[0m16:28:54.998900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:54.999908 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m16:28:54.999908 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:28:55.000908 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: COMMIT
[0m16:28:55.001787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:55.004828 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_sales_location__dbt_backup"
[0m16:28:55.004828 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sales_location"
[0m16:28:55.005911 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_location"} */
drop table if exists "dbt_project_db"."dwh"."dim_sales_location__dbt_backup" cascade
[0m16:28:55.007793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:55.008906 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_location: Close
[0m16:28:55.009874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9685D840>]}
[0m16:28:55.010797 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh.dim_sales_location ...................... [[32mSELECT 0[0m in 0.08s]
[0m16:28:55.011793 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_location
[0m16:28:55.012794 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_status
[0m16:28:55.012794 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh.dim_status ................................... [RUN]
[0m16:28:55.013792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_location, now model.my_dbt_project.dim_status)
[0m16:28:55.014792 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_status
[0m16:28:55.016791 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_status"
[0m16:28:55.018813 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_status
[0m16:28:55.022792 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_status"
[0m16:28:55.024797 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:28:55.024797 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: BEGIN
[0m16:28:55.025792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.165241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m16:28:55.165241 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:28:55.165241 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */

  
    

  create  table "dbt_project_db"."dwh"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

select 
    ROW_NUMBER() OVER(ORDER by status_name) as status_id,
    status_name
from (
    select DISTINCT status_name 
    from "dbt_project_db"."data_source"."leads"
    WHERE status_name is not NULL
) as distinct_status
  );
  
[0m16:28:55.171280 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:55.175342 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:28:55.175342 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status" rename to "dim_status__dbt_backup"
[0m16:28:55.176492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.178507 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:28:55.179506 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
alter table "dbt_project_db"."dwh"."dim_status__dbt_tmp" rename to "dim_status"
[0m16:28:55.180210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.181214 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m16:28:55.181214 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:28:55.181214 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: COMMIT
[0m16:28:55.184370 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:28:55.187214 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_status__dbt_backup"
[0m16:28:55.188214 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_status"
[0m16:28:55.188214 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_status"} */
drop table if exists "dbt_project_db"."dwh"."dim_status__dbt_backup" cascade
[0m16:28:55.190217 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:55.191215 [debug] [Thread-1 (]: On model.my_dbt_project.dim_status: Close
[0m16:28:55.192215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F95601ED0>]}
[0m16:28:55.192215 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh.dim_status .............................. [[32mSELECT 0[0m in 0.18s]
[0m16:28:55.193219 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_status
[0m16:28:55.194217 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_time
[0m16:28:55.194217 [info ] [Thread-1 (]: 10 of 12 START sql view model dwh.dim_time ..................................... [RUN]
[0m16:28:55.195218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_status, now model.my_dbt_project.dim_time)
[0m16:28:55.196218 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_time
[0m16:28:55.197217 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_time"
[0m16:28:55.198217 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_time
[0m16:28:55.216218 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_time"
[0m16:28:55.217228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:28:55.218218 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: BEGIN
[0m16:28:55.218218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.254895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m16:28:55.254895 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:28:55.255967 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */

  create view "dbt_project_db"."dwh"."dim_time__dbt_tmp"
    
    
  as (
    WITH time_series AS (
  SELECT generate_series(
    '2023-01-01 00:00:00'::timestamp,
    '2023-01-01 23:59:00'::timestamp,
    interval '1 minute'
  ) AS ts
)

SELECT
  ROW_NUMBER() OVER () AS time_id,
  EXTRACT(hour FROM ts) AS hour,
  EXTRACT(minute FROM ts) AS minute,
  CAST(ts AS time) AS time_val
FROM time_series
  );
[0m16:28:55.261893 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:28:55.264975 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:28:55.264975 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time" rename to "dim_time__dbt_backup"
[0m16:28:55.265894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.269000 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:28:55.269000 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
alter table "dbt_project_db"."dwh"."dim_time__dbt_tmp" rename to "dim_time"
[0m16:28:55.269970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.270967 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m16:28:55.271995 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:28:55.271995 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: COMMIT
[0m16:28:55.273899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:55.275999 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."dim_time__dbt_backup"
[0m16:28:55.277895 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_time"
[0m16:28:55.278893 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_time"} */
drop view if exists "dbt_project_db"."dwh"."dim_time__dbt_backup" cascade
[0m16:28:55.279892 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:28:55.280987 [debug] [Thread-1 (]: On model.my_dbt_project.dim_time: Close
[0m16:28:55.281984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F96852020>]}
[0m16:28:55.282896 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dwh.dim_time ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m16:28:55.283893 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_time
[0m16:28:55.283893 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m16:28:55.284894 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh.fact_sales .................................. [RUN]
[0m16:28:55.285892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_time, now model.my_dbt_project.fact_sales)
[0m16:28:55.285892 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m16:28:55.289892 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m16:28:55.290892 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m16:28:55.293976 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m16:28:55.295982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:28:55.295982 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m16:28:55.296948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.443278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m16:28:55.443278 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:28:55.444396 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    s.id AS sale_id,

    -- Foreign Key to fact_leads (Degenerate Dimension)
    -- Assuming lead_id is an integer in your source sales table and acts as a direct link to fact_leads PK
    s.lead_id,

    -- Foreign Keys to Dimension Tables
    -- dim_property_type (from your dim_property_type model)
    dpt.property_type_id AS property_type_id, 

    -- Date Keys (using TO_CHAR for direct lookup as discussed)
    TO_CHAR(s.date_of_reservation, 'YYYYMMDD')::INT AS date_of_reservation_id,
    TO_CHAR(s.date_of_reservation::TIME, 'HH24MI')::INT AS time_of_reservation_id, -- Assuming HHMM for time_id
    TO_CHAR(s.reservation_update_date, 'YYYYMMDD')::INT AS reservation_update_id,
    TO_CHAR(s.reservation_update_date::TIME, 'HH24MI')::INT AS time_of_reservation_update_id,
    TO_CHAR(s.date_of_contraction, 'YYYYMMDD')::INT AS date_of_contraction_id,
    TO_CHAR(s.date_of_contraction::TIME, 'HH24MI')::INT AS time_of_contraction_id,

    -- dim_sale_category (from your dim_sale_category model)
    dsc.sale_category_id AS sale_category_id, -- Note: This is now category_id from your dim_sale_category model

    -- dim_sales_location (from your dim_sales_location model)
    dsl.unit_location_id AS location_id, -- Note: This is now unit_location_id from your dim_sales_location model

    -- Degenerate Dimensions (Attributes directly on Fact table, as per your schema)
    s.area_id,
    s.compound_id,

    -- Measures
    s.unit_value::DECIMAL(15,2) AS unit_value, -- Cast to DECIMAL(13,2)
    s.expected_value::DECIMAL(15,2) AS expected_value,
    s.actual_value::DECIMAL(15,2) AS actual_value,
    s.years_of_payment

FROM "dbt_project_db"."data_source"."sales" s -- Reference to your raw sales data

-- Joins to Dimension Tables to get Surrogate Keys

-- Join to dim_property_type
LEFT JOIN "dbt_project_db"."dwh"."dim_property_type" dpt
    ON s.property_type = dpt.property_type -- Join on the natural key 'property_type'

-- Join to dim_sale_category
LEFT JOIN "dbt_project_db"."dwh"."dim_sale_category" dsc
    ON s.sale_category = dsc.sale_category
-- Join to dim_sales_location
LEFT JOIN "dbt_project_db"."dwh"."dim_sales_location" dsl
    ON s.unit_location = dsl.unit_location -- Join on the natural key 'unit_location'

WHERE s.id IS NOT NULL -- Ensure valid sales records
  );
  
[0m16:28:55.450521 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m16:28:55.453807 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:28:55.453807 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales" rename to "fact_sales__dbt_backup"
[0m16:28:55.454836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.457684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:28:55.457684 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "dbt_project_db"."dwh"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m16:28:55.458745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.459794 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m16:28:55.460685 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:28:55.461118 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m16:28:55.462128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:28:55.464206 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_sales__dbt_backup"
[0m16:28:55.465238 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_sales"
[0m16:28:55.465238 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "dbt_project_db"."dwh"."fact_sales__dbt_backup" cascade
[0m16:28:55.467825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:55.468929 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m16:28:55.469911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9689EAA0>]}
[0m16:28:55.469911 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh.fact_sales ............................. [[32mSELECT 0[0m in 0.18s]
[0m16:28:55.470826 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m16:28:55.471827 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_leads
[0m16:28:55.471827 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh.fact_leads .................................. [RUN]
[0m16:28:55.473490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fact_sales, now model.my_dbt_project.fact_leads)
[0m16:28:55.473587 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_leads
[0m16:28:55.478673 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_leads"
[0m16:28:55.479669 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_leads
[0m16:28:55.483677 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_leads"
[0m16:28:55.484669 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:28:55.485646 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: BEGIN
[0m16:28:55.485646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.508239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:28:55.508239 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:28:55.508239 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */

  
    

  create  table "dbt_project_db"."dwh"."fact_leads__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Degenerate Dimension / Primary Key for Fact Table
    l.id AS lead_id,

    -- Foreign Keys to Dimensions
    -- dim_customer
    l.customer_id, -- This is the surrogate key from dim_customer

    -- Date and Time Keys for various lead dates
    TO_CHAR(l.date_of_last_request, 'YYYYMMDD')::INT AS last_request_date_id,
    TO_CHAR(l.date_of_last_request::TIME, 'HH24MI')::INT AS last_request_time_id,
    TO_CHAR(l.created_at, 'YYYYMMDD')::INT AS created_at_date_id,
    TO_CHAR(l.created_at::TIME, 'HH24MI')::INT AS created_at_time_id,
    TO_CHAR(l.updated_at, 'YYYYMMDD')::INT AS updated_at_date_id,
    TO_CHAR(l.updated_at::TIME, 'HH24MI')::INT AS updated_at_time_id,
    -- TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id, -- Column name in source is 'date_of_last_contact'
    -- TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id, -- Column name in source is 'date_of_last_contact'
    -- Corrected column names based on source for date_of_last_contact
    TO_CHAR(l.date_of_last_contact, 'YYYYMMDD')::INT AS last_contact_date_id,
    TO_CHAR(l.date_of_last_contact::TIME, 'HH24MI')::INT AS last_contact_time_id,

    -- dim_user (assuming user_id from source is directly used as FK to dim_user's PK)
    l.user_id AS user_id, -- As per your schema, user_id is directly on fact_leads

    -- dim_status
    ds.status_id AS status_id,
    -- dim_method_of_contact
    dmoc.method_id AS method_of_contact_id,
    -- dim_campaign
    dcmp.campaign_id AS campaign_id,
    -- dim_lead_type
    dlt.lead_type_id AS lead_type_id,
    -- dim_lead_sources
    dls.lead_source_id AS lead_source_id,

    -- Measures
    l.budget::DECIMAL(15,2) AS budget,
    -- Degenerate Dimensions (Attributes directly on Fact table)
    l.location AS location, -- As per your schema, location is directly on fact_leads
    l.area_id AS area_id,
    l.compound_id AS compound_id,
    l.developer_id AS developer_id,
    l.meeting_flag AS meeting_flag,
    l.commercial AS commercial,
    l.merged AS merged,
    l.do_not_call AS do_not_call,
    -- Add lead_count measure
    1 AS lead_count

FROM "dbt_project_db"."data_source"."leads" l -- Reference to your raw leads data

-- Joins to Dimension Tables to get Surrogate Keys

-- dim_customer (assuming customer_id from source is directly used as FK to dim_customer's PK)

-- dim_status
LEFT JOIN "dbt_project_db"."dwh"."dim_status" ds
    ON l.status_name = ds.status_name

-- dim_method_of_contact
LEFT JOIN "dbt_project_db"."dwh"."dim_method_of_contact" dmoc
    ON l.method_of_contact = dmoc.method_of_contact

-- dim_campaign
LEFT JOIN "dbt_project_db"."dwh"."dim_campaign" dcmp
    ON l.campaign = dcmp.campaign

-- dim_lead_type
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_type" dlt
    ON l.lead_type = dlt.lead_type

-- dim_lead_sources (careful with the mixed data types in source.lead_source)
LEFT JOIN "dbt_project_db"."dwh"."dim_lead_source" dls
    ON l.lead_source = dls.lead_source  -- Cast to VARCHAR for join if source has mixed types

WHERE l.id IS NOT NULL -- Ensure valid lead records
  );
  
[0m16:28:55.530635 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m16:28:55.533743 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:28:55.534726 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads" rename to "fact_leads__dbt_backup"
[0m16:28:55.535643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.537728 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:28:55.537728 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
alter table "dbt_project_db"."dwh"."fact_leads__dbt_tmp" rename to "fact_leads"
[0m16:28:55.538643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:28:55.540641 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m16:28:55.540641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:28:55.541657 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: COMMIT
[0m16:28:55.544646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:28:55.546727 [debug] [Thread-1 (]: Applying DROP to: "dbt_project_db"."dwh"."fact_leads__dbt_backup"
[0m16:28:55.547732 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fact_leads"
[0m16:28:55.547732 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fact_leads"} */
drop table if exists "dbt_project_db"."dwh"."fact_leads__dbt_backup" cascade
[0m16:28:55.549747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:28:55.550854 [debug] [Thread-1 (]: On model.my_dbt_project.fact_leads: Close
[0m16:28:55.551864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6672803-4a31-4745-98df-4adb4eb23ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F90F5A290>]}
[0m16:28:55.552762 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dwh.fact_leads ............................. [[32mSELECT 0[0m in 0.08s]
[0m16:28:55.553765 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_leads
[0m16:28:55.554758 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:55.554758 [debug] [MainThread]: On master: BEGIN
[0m16:28:55.555752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:55.592755 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m16:28:55.593792 [debug] [MainThread]: On master: COMMIT
[0m16:28:55.593792 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:55.593792 [debug] [MainThread]: On master: COMMIT
[0m16:28:55.594861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:28:55.594861 [debug] [MainThread]: On master: Close
[0m16:28:55.595843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:55.595843 [debug] [MainThread]: Connection 'list_dbt_project_db' was properly closed.
[0m16:28:55.595843 [debug] [MainThread]: Connection 'list_dbt_project_db_dwh' was properly closed.
[0m16:28:55.596759 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_leads' was properly closed.
[0m16:28:55.596759 [info ] [MainThread]: 
[0m16:28:55.597753 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m16:28:55.599853 [debug] [MainThread]: Command end result
[0m16:28:55.620858 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\manifest.json
[0m16:28:55.623768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\khale\my_dbt_project\my_dbt_project\target\semantic_manifest.json
[0m16:28:55.630847 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\khale\my_dbt_project\my_dbt_project\target\run_results.json
[0m16:28:55.631762 [info ] [MainThread]: 
[0m16:28:55.632620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:55.632620 [info ] [MainThread]: 
[0m16:28:55.633672 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m16:28:55.634663 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:55.634663 after 2.51 seconds
[0m16:28:55.635626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F93D44760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F94D5E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F94D5C940>]}
[0m16:28:55.635626 [debug] [MainThread]: Flushing usage events
[0m16:28:56.503403 [debug] [MainThread]: An error was encountered while trying to flush usage events
